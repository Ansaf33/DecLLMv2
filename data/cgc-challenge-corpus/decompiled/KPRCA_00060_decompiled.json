{
    "file": "KPRCA_00060",
    "decompiled_code": {
        "main.c": [
            {
                "func_name": "find_printer",
                "func_c_signature": "int find_printer(char *param_1)",
                "decompiled_code": "int find_printer(char *param_1) {\n  int iVar1;\n  int local_10;\n  \n  local_10 = 0;\n  while( true ) {\n    if (9 < local_10) {\n      return 0;\n    }\n    iVar1 = strcmp((char *)(local_10 * 0x7d10c + printers + 4),param_1);\n    if (iVar1 == 0) break;\n    local_10 = local_10 + 1;\n  }\n  return local_10 * 0x7d10c + printers;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "find_printer",
                        "strcmp"
                    ],
                    "calling_functions": [
                        "find_printer",
                        "main"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "set_name",
                "func_c_signature": "void set_name(int param_1,int param_2)",
                "decompiled_code": "void set_name(int param_1,int param_2) {\n  uint local_c;\n  \n  for (local_c = 0; local_c < name_len_0; local_c = local_c + 1) {\n    *(byte *)(local_c + param_1 + 4) =\n         (*(byte *)(local_c + name_len_0 * param_2 + secrets_1) & 0x3f) + 0x41;\n  }\n  *(undefined *)(param_1 + 4 + name_len_0) = 0;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "set_name"
                    ],
                    "calling_functions": [
                        "set_name",
                        "main"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  size_t sVar1;\n  int iVar2;\n  char *local_83c;\n  undefined local_838;\n  char acStack_837 [2047];\n  char *local_38;\n  char *local_34;\n  ulong local_30;\n  int local_2c;\n  int local_28;\n  int local_24;\n  undefined *local_14;\n  \n  local_14 = &stack0x00000004;\n  local_28 = 0;\n  local_2c = 0;\n  printers = malloc(0x4e2a78);\n  memset(printers,0,0x4e2a78);\n  for (local_24 = 0; local_24 < 10; local_24 = local_24 + 1) {\n    if (local_24 == 0) {\n      strcpy((char *)((int)printers + 4),\"DEFAULT\");\n    }\n    else {\n      set_name((void *)(local_24 * 0x7d10c + (int)printers),local_24);\n    }\n    *(undefined4 *)(local_24 * 0x7d10c + (int)printers) = 0;\n    *(code **)((int)printers + local_24 * 0x7d10c + 0x7d104) = printer_tick;\n    *(void **)((int)printers + local_24 * 0x7d10c + 0x7d108) =\n         (void *)(local_24 * 0x7d10c + (int)printers);\n  }\n  do {\n    iVar2 = read_until(0,&local_838,0x800,10);\n    if (iVar2 < 1) {\n      return 0;\n    }\n    switch(local_838) {\n    case 0:\n      if (local_28 != 0) {\n        local_28 = 0;\n      }\n      transmit(1,&DAT_00016008,1,0);\n      break;\n    case 1:\n      if (local_28 == 0) {\n        local_2c = find_printer(acStack_837);\n        if ((local_2c == 0) || (iVar2 = cmd_print_jobs(local_2c), iVar2 != 0)) {\n          transmit(1,&DAT_0001600a,1,0);\n        }\n        else {\n          transmit(1,&DAT_00016008,1,0);\n        }\n      }\n      else {\n        iVar2 = cmd_abort_job(local_2c);\n        if (iVar2 == 0) {\n          transmit(1,&DAT_00016008,1,0);\n        }\n        else {\n          transmit(1,&DAT_0001600a,1,0);\n        }\n      }\n      break;\n    case 2:\n      if (local_28 == 0) {\n        local_2c = find_printer(acStack_837);\n        if ((local_2c == 0) || (iVar2 = cmd_recv_job(local_2c), iVar2 != 0)) {\n          transmit(1,&DAT_0001600a,1,0);\n        }\n        else {\n          local_28 = 1;\n          transmit(1,&DAT_00016008,1,0);\n        }\n      }\n      else {\n        iVar2 = cmd_recv_control_file(local_2c,acStack_837);\n        if (iVar2 == 0) {\n          transmit(1,&DAT_00016008,1,0);\n        }\n        else {\n          transmit(1,&DAT_0001600a,1,0);\n        }\n      }\n      break;\n    case 3:\n      if (local_28 == 0) goto _L19;\n      iVar2 = cmd_recv_data_file(local_2c,acStack_837);\n      if (iVar2 == 0) {\n        transmit(1,&DAT_00016008,1,0);\n      }\n      else {\n        transmit(1,&DAT_0001600a,1,0);\n      }\n      break;\n    case 4:\n_L19:\n      if (local_28 == 0) {\n        local_83c = acStack_837;\n        local_34 = strsep(&local_83c,\" \");\n        local_2c = find_printer(local_34);\n        if ((local_2c == 0) || (iVar2 = cmd_send_queue_state(local_2c), iVar2 != 0)) {\n          transmit(1,&DAT_0001600a,1,0);\n        }\n        else {\n          transmit(1,&DAT_00016008,1,0);\n        }\n      }\n      else {\n        transmit(1,&DAT_0001600a,1,0);\n      }\n      break;\n    case 5:\n      if (local_28 == 0) {\n        local_83c = acStack_837;\n        local_34 = strsep(&local_83c,\" \");\n        local_2c = find_printer(local_34);\n        if (local_2c != 0) {\n          local_38 = strsep(&local_83c,\" \");\n          local_30 = 0;\n          sVar1 = strlen(local_83c);\n          if (sVar1 != 0) {\n            local_30 = strtoul(local_83c,(char **)0x0,10);\n          }\n          iVar2 = cmd_remove_jobs(local_2c,local_38,local_30);\n          if (iVar2 == 0) {\n            transmit(1,&DAT_00016008,1,0);\n            break;\n          }\n        }\n        transmit(1,&DAT_0001600a,1,0);\n      }\n      else {\n        transmit(1,&DAT_0001600a,1,0);\n      }\n      break;\n    default:\n      transmit(1,&DAT_0001600a,1,0);\n      break;\n    case 7:\n                    /* WARNING: Subroutine does not return */\n      exit(0);\n    }\n    for (local_24 = 0; local_24 < 10; local_24 = local_24 + 1) {\n      (**(code **)((int)printers + local_24 * 0x7d10c + 0x7d104))\n                (*(undefined4 *)((int)printers + local_24 * 0x7d10c + 0x7d108));\n    }\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "malloc",
                        "memset",
                        "strcpy",
                        "set_name",
                        "read_until",
                        "transmit",
                        "find_printer",
                        "cmd_print_jobs",
                        "cmd_abort_job",
                        "cmd_recv_job",
                        "cmd_recv_control_file",
                        "cmd_recv_data_file",
                        "strsep",
                        "cmd_send_queue_state",
                        "strlen",
                        "strtoul",
                        "cmd_remove_jobs",
                        "exit"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            }
        ],
        "printer.c": [
            {
                "func_name": "cmd_print_jobs",
                "func_c_signature": "undefined4 cmd_print_jobs(int *param_1)",
                "decompiled_code": "undefined4 cmd_print_jobs(int *param_1) {\n  int local_8;\n  \n  for (local_8 = 0; local_8 < 1000; local_8 = local_8 + 1) {\n    if ((param_1[local_8 * 0x80 + 0x41] == 2) && (param_1[local_8 * 0x80 + 0x41] = 3, *param_1 != 3)\n       ) {\n      *param_1 = 3;\n    }\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_print_jobs"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_print_jobs"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "cmd_recv_job",
                "func_c_signature": "undefined4 cmd_recv_job(int *param_1)",
                "decompiled_code": "undefined4 cmd_recv_job(int *param_1) {\n  undefined4 uVar1;\n  \n  if (*param_1 == 3) {\n    uVar1 = 0xffffffff;\n  }\n  else {\n    *param_1 = 2;\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_recv_job"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_recv_job"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "cmd_abort_job",
                "func_c_signature": "undefined4 cmd_abort_job(undefined4 *param_1)",
                "decompiled_code": "undefined4 cmd_abort_job(undefined4 *param_1) {\n  bool bVar1;\n  int local_10;\n  \n  bVar1 = false;\n  for (local_10 = 0; local_10 < 1000; local_10 = local_10 + 1) {\n    if ((param_1[local_10 * 0x80 + 0x41] == 1) || (param_1[local_10 * 0x80 + 0x41] == 2)) {\n      if (param_1[local_10 * 0x80 + 0x42] != 0) {\n        free((void *)param_1[local_10 * 0x80 + 0x42]);\n      }\n      memset(param_1 + local_10 * 0x80 + 0x41,0,0x200);\n      param_1[local_10 * 0x80 + 0x41] = 0;\n    }\n    else if (param_1[local_10 * 0x80 + 0x41] == 3) {\n      bVar1 = true;\n    }\n  }\n  if (!bVar1) {\n    *param_1 = 0;\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_abort_job",
                        "free",
                        "memset"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_abort_job"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "cmd_recv_control_file",
                "func_c_signature": "undefined4 cmd_recv_control_file(int param_1,char *param_2)",
                "decompiled_code": "undefined4 cmd_recv_control_file(int param_1,char *param_2) {\n  undefined4 uVar1;\n  int iVar2;\n  ulong uVar3;\n  size_t sVar4;\n  uint uVar5;\n  char *local_438;\n  char *local_434;\n  char local_430 [1024];\n  char local_30 [3];\n  undefined local_2d;\n  char *local_2c;\n  int *local_28;\n  ulong local_24;\n  ulong local_20;\n  char *local_1c;\n  char *local_18;\n  char *local_14;\n  char *local_10;\n  \n  local_10 = (char *)0x0;\n  local_14 = (char *)0x0;\n  local_18 = (char *)0x0;\n  local_1c = (char *)0x0;\n  local_10 = strsep(&param_2,\" \");\n  local_14 = param_2;\n  if ((local_10 == (char *)0x0) || (param_2 == (char *)0x0)) {\n    uVar1 = 0xffffffff;\n  }\n  else {\n    local_20 = strtoul(local_10,(char **)0x0,10);\n    if (local_20 < 0x401) {\n      iVar2 = strncmp(local_14,\"cfA\",3);\n      if (iVar2 == 0) {\n        strncpy(local_30,local_14 + 3,3);\n        local_2d = 0;\n        local_24 = strtoul(local_30,(char **)0x0,10);\n        if (local_24 < 1000) {\n          local_18 = param_2 + 6;\n          param_1 = param_1 + local_24 * 0x200;\n          local_28 = (int *)(param_1 + 0x104);\n          *(undefined4 *)(param_1 + 0x2fc) = 0x84;\n          *(undefined4 *)(param_1 + 0x110) = 10;\n          iVar2 = read_n(0,local_430,local_20);\n          if (iVar2 < 1) {\n            uVar1 = 0xffffffff;\n          }\n          else {\n            local_438 = local_430;\n            while ((local_1c = strsep(&local_438,\"\\n\"), local_1c != (char *)0x0 &&\n                   (local_438 != (char *)0x0))) {\n              iVar2 = (int)*local_1c;\n              if (iVar2 < 0x55) {\n                if (0x42 < iVar2) {\n                  switch(iVar2) {\n                  case 0x43:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 0x20) {\n                      strcpy((char *)(local_28 + 4),local_1c + 1);\n                    }\n                    break;\n                  case 0x48:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 0x20) {\n                      strcpy((char *)(local_28 + 0xc),local_1c + 1);\n                    }\n                    break;\n                  case 0x49:\n                    uVar3 = strtoul(local_1c + 1,(char **)0x0,10);\n                    local_28[0x14] = uVar3;\n                    if ((uint)local_28[0x7e] <= (uint)local_28[0x14]) {\n                      local_28[0x14] = 0;\n                    }\n                    break;\n                  case 0x4a:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 100) {\n                      strcpy((char *)(local_28 + 0x15),local_1c + 1);\n                    }\n                    break;\n                  case 0x4c:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 0x20) {\n                      strcpy((char *)((int)local_28 + 0xb9),local_1c + 1);\n                    }\n                    *(undefined *)(local_28 + 0x2e) = 1;\n                    break;\n                  case 0x4d:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 0x20) {\n                      strcpy((char *)((int)local_28 + 0xfa),local_1c + 1);\n                    }\n                    *(undefined *)((int)local_28 + 0xf9) = 1;\n                    break;\n                  case 0x4e:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 0x83) {\n                      strcpy((char *)((int)local_28 + 0x11a),local_1c + 1);\n                    }\n                    break;\n                  case 0x50:\n                    sVar4 = strlen(local_1c);\n                    if (sVar4 - 1 < 0x20) {\n                      strcpy((char *)((int)local_28 + 0xd9),local_1c + 1);\n                    }\n                    break;\n                  case 0x53:\n                    local_434 = local_1c;\n                    local_2c = strsep(&local_434,\" \");\n                    if ((((local_2c != (char *)0x0) && (local_434 != (char *)0x0)) &&\n                        (sVar4 = strlen(local_2c), 1 < sVar4)) &&\n                       (sVar4 = strlen(local_434), 1 < sVar4)) {\n                      uVar3 = strtoul(local_2c + 1,(char **)0x0,10);\n                      local_28[0x68] = uVar3;\n                      uVar3 = strtoul(local_434,(char **)0x0,10);\n                      local_28[0x69] = uVar3;\n                    }\n                    break;\n                  case 0x54:\n                    strcpy((char *)(local_28 + 0x6a),local_1c + 1);\n                  }\n                }\n              }\n              else if ((iVar2 < 0x73) && (0x54 < iVar2)) {\n                uVar5 = 1 << (*local_1c + 0xabU & 0x1f);\n                if ((uVar5 & 0x2e86c000) == 0) {\n                  if ((uVar5 & 4) != 0) {\n                    uVar3 = strtoul(local_1c + 1,(char **)0x0,10);\n                    local_28[0x7e] = uVar3;\n                  }\n                }\n                else {\n                  *(char *)(local_28 + 0x7f) = *local_1c;\n                }\n              }\n            }\n            sVar4 = strlen((char *)(local_28 + 0xc));\n            if ((sVar4 == 0) || (sVar4 = strlen((char *)((int)local_28 + 0xd9)), sVar4 == 0)) {\n              uVar1 = 0xffffffff;\n            }\n            else {\n              if (*local_28 == 0) {\n                *local_28 = 1;\n              }\n              else {\n                if (*local_28 != 1) {\n                  return 0xffffffff;\n                }\n                *local_28 = 2;\n              }\n              uVar1 = 0;\n            }\n          }\n        }\n        else {\n          uVar1 = 0xffffffff;\n        }\n      }\n      else {\n        uVar1 = 0xffffffff;\n      }\n    }\n    else {\n      uVar1 = 0xffffffff;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_recv_control_file",
                        "strsep",
                        "strtoul",
                        "strncmp",
                        "strncpy",
                        "read_n",
                        "strlen",
                        "strcpy"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_recv_control_file"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "cmd_recv_data_file",
                "func_c_signature": "undefined4 cmd_recv_data_file(int param_1,char *param_2)",
                "decompiled_code": "undefined4 cmd_recv_data_file(int param_1,char *param_2) {\n  undefined4 uVar1;\n  int iVar2;\n  char local_2c [3];\n  undefined local_29;\n  int *local_28;\n  char *local_24;\n  ulong local_20;\n  void *local_1c;\n  char *local_18;\n  char *local_14;\n  ulong local_10;\n  \n  local_10 = 0;\n  local_14 = (char *)0x0;\n  local_18 = (char *)0x0;\n  local_1c = (void *)0x0;\n  local_14 = strsep(&param_2,\" \");\n  local_18 = param_2;\n  if ((local_14 == (char *)0x0) || (param_2 == (char *)0x0)) {\n    uVar1 = 0xffffffff;\n  }\n  else {\n    local_10 = strtoul(local_14,(char **)0x0,10);\n    iVar2 = strncmp(local_18,\"dfA\",3);\n    if (iVar2 == 0) {\n      strncpy(local_2c,local_18 + 3,3);\n      local_29 = 0;\n      local_20 = strtoul(local_2c,(char **)0x0,10);\n      if (local_20 < 1000) {\n        local_24 = param_2 + 6;\n        local_1c = malloc(local_10 + 1);\n        memset(local_1c,0,local_10 + 1);\n        iVar2 = read_n(0,local_1c,local_10 + 1);\n        if ((iVar2 < 1) || (*(char *)(local_10 + (int)local_1c) != '\\0')) {\n          free(local_1c);\n          uVar1 = 0xffffffff;\n        }\n        else {\n          param_1 = param_1 + local_20 * 0x200;\n          local_28 = (int *)(param_1 + 0x104);\n          if (*(int *)(param_1 + 0x108) != 0) {\n            free(*(void **)(param_1 + 0x108));\n          }\n          local_28[1] = (int)local_1c;\n          local_28[2] = local_10;\n          if (*local_28 == 0) {\n            *local_28 = 1;\n          }\n          else {\n            if (*local_28 != 1) {\n              return 0xffffffff;\n            }\n            *local_28 = 2;\n          }\n          uVar1 = 0;\n        }\n      }\n      else {\n        uVar1 = 0xffffffff;\n      }\n    }\n    else {\n      uVar1 = 0xffffffff;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_recv_data_file",
                        "strsep",
                        "strtoul",
                        "strncmp",
                        "strncpy",
                        "malloc",
                        "memset",
                        "read_n",
                        "free"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_recv_data_file"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "cmd_send_queue_state",
                "func_c_signature": "undefined4 cmd_send_queue_state(int param_1)",
                "decompiled_code": "undefined4 cmd_send_queue_state(int param_1) {\n  size_t sVar1;\n  undefined4 uVar2;\n  char *__s;\n  char local_418 [10];\n  undefined local_40e;\n  undefined local_406;\n  char local_18 [4];\n  int local_14;\n  int local_10;\n  \n  local_14 = param_1 + 0x104;\n  param_1 = param_1 + 4;\n  printf(\"Queue State for %s\\n\\n\",param_1);\n  printf(\"Owner       Status      Jobname             Job-ID      Size  \\n\");\n  printf(\"==============================================================\\n\");\n  for (local_10 = 0; local_10 < 1000; local_10 = local_10 + 1) {\n    if (*(int *)(local_14 + local_10 * 0x200) != 0) {\n      strcpy(local_418,(char *)(local_14 + local_10 * 0x200 + 0xd9));\n      local_40e = 0;\n      printf(\"%s\",local_418);\n      sVar1 = strlen(local_418);\n      print_ws(0xc - sVar1);\n      uVar2 = jstate_str(*(undefined4 *)(local_14 + local_10 * 0x200));\n      printf(\"%s\",uVar2);\n      __s = (char *)jstate_str(*(undefined4 *)(local_14 + local_10 * 0x200));\n      sVar1 = strlen(__s);\n      print_ws(0xc - sVar1);\n      strcpy(local_418,(char *)(local_14 + local_10 * 0x200 + 0x11a));\n      local_406 = 0;\n      printf(\"%s\",local_418);\n      sVar1 = strlen(local_418);\n      print_ws(0x14 - sVar1);\n      sprintf(local_18,\"%03d\",local_10);\n      printf(\"%s\",local_18);\n      sVar1 = strlen(local_18);\n      print_ws(0xc - sVar1);\n      param_1 = *(int *)(local_14 + local_10 * 0x200 + 8);\n      printf(\"%d\\n\",param_1);\n    }\n  }\n  printf(\"\\n\\n\",param_1);\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_send_queue_state",
                        "printf",
                        "strcpy",
                        "strlen",
                        "print_ws",
                        "jstate_str",
                        "sprintf"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_send_queue_state"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "cmd_remove_jobs",
                "func_c_signature": "undefined4 cmd_remove_jobs(int param_1,char *param_2,int param_3)",
                "decompiled_code": "undefined4 cmd_remove_jobs(int param_1,char *param_2,int param_3) {\n  int iVar1;\n  undefined4 uVar2;\n  \n  param_1 = param_1 + 0x104;\n  if (*(int *)(param_1 + param_3 * 0x200) == 0) {\nLAB_000125be:\n    uVar2 = 0xffffffff;\n  }\n  else {\n    iVar1 = strcmp((char *)(param_1 + param_3 * 0x200 + 0xd9),param_2);\n    if (iVar1 != 0) {\n      iVar1 = strcmp(param_2,\"root\");\n      if (iVar1 != 0) goto LAB_000125be;\n    }\n    if (*(int *)(param_1 + param_3 * 0x200 + 4) != 0) {\n      free(*(void **)(param_1 + param_3 * 0x200 + 4));\n    }\n    memset((void *)(param_1 + param_3 * 0x200),0,0x200);\n    *(undefined4 *)(param_1 + param_3 * 0x200) = 0;\n    uVar2 = 0;\n  }\n  return uVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cmd_remove_jobs",
                        "strcmp",
                        "free",
                        "memset"
                    ],
                    "calling_functions": [
                        "main",
                        "cmd_remove_jobs"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "printer_tick",
                "func_c_signature": "void printer_tick(int *param_1)",
                "decompiled_code": "void printer_tick(int *param_1) {\n  int local_14;\n  int local_10;\n  \n  local_14 = 0;\n  if (*param_1 != 0) {\n    for (local_10 = 0; local_10 < 1000; local_10 = local_10 + 1) {\n      if (param_1[local_10 * 0x80 + 0x41] == 3) {\n        param_1[local_10 * 0x80 + 0x44] = param_1[local_10 * 0x80 + 0x44] + -1;\n        local_14 = local_14 + param_1[local_10 * 0x80 + 0x44];\n        if (param_1[local_10 * 0x80 + 0x44] == 0) {\n          if (param_1[local_10 * 0x80 + 0x42] != 0) {\n            free((void *)param_1[local_10 * 0x80 + 0x42]);\n          }\n          memset(param_1 + local_10 * 0x80 + 0x41,0,0x200);\n          param_1[local_10 * 0x80 + 0x41] = 0;\n        }\n      }\n    }\n    if (local_14 == 0) {\n      *param_1 = 0;\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "printer_tick",
                        "free",
                        "memset"
                    ],
                    "calling_functions": [
                        "printer_tick"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "print_ws",
                "func_c_signature": "void print_ws(int param_1)",
                "decompiled_code": "void print_ws(int param_1) {\n  int iVar1;\n  uint uVar2;\n  undefined *puVar3;\n  undefined auStack_1c [8];\n  undefined *local_14;\n  int local_10;\n  \n  local_10 = param_1;\n  uVar2 = ((param_1 + 0x10U) / 0x10) * 0x10;\n  for (puVar3 = auStack_1c; puVar3 != auStack_1c + -(uVar2 & 0xfffff000); puVar3 = puVar3 + -0x1000)\n  {\n    *(undefined4 *)(puVar3 + -4) = *(undefined4 *)(puVar3 + -4);\n  }\n  iVar1 = -(uVar2 & 0xfff);\n  if ((uVar2 & 0xfff) != 0) {\n    *(undefined4 *)(puVar3 + ((uVar2 & 0xfff) - 4) + iVar1) =\n         *(undefined4 *)(puVar3 + ((uVar2 & 0xfff) - 4) + iVar1);\n  }\n  local_14 = puVar3 + iVar1;\n  *(int *)(puVar3 + iVar1 + -8) = param_1;\n  *(undefined4 *)(puVar3 + iVar1 + -0xc) = 0x20;\n  *(undefined **)(puVar3 + iVar1 + -0x10) = local_14;\n  *(undefined4 *)(puVar3 + iVar1 + -0x14) = 0x12782;\n  memset(*(void **)(puVar3 + iVar1 + -0x10),*(int *)(puVar3 + iVar1 + -0xc),\n         *(size_t *)(puVar3 + iVar1 + -8));\n  local_14[param_1] = 0;\n  *(undefined **)(puVar3 + iVar1 + -0x10) = local_14;\n  *(undefined4 *)(puVar3 + iVar1 + -0x14) = 0x1279b;\n  printf(*(char **)(puVar3 + iVar1 + -0x10));\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "print_ws",
                        "memset",
                        "printf"
                    ],
                    "calling_functions": [
                        "cmd_send_queue_state",
                        "print_ws"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "jstate_str",
                "func_c_signature": "char * jstate_str(uint param_1)",
                "decompiled_code": "char * jstate_str(uint param_1) {\n  if (param_1 == 3) {\n    return \"Printing\";\n  }\n  if (param_1 < 4) {\n    if (param_1 == 2) {\n      return \"Queued\";\n    }\n    if (param_1 < 3) {\n      if (param_1 == 0) {\n        return \"Invalid\";\n      }\n      if (param_1 == 1) {\n        return \"Waiting\";\n      }\n    }\n  }\n  return \"Unknown\";\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "jstate_str"
                    ],
                    "calling_functions": [
                        "cmd_send_queue_state",
                        "jstate_str"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            }
        ],
        "readuntil.c": [
            {
                "func_name": "next_byte",
                "func_c_signature": "uint next_byte(void)",
                "decompiled_code": "uint next_byte(void) {\n  uint uVar1;\n  int iVar2;\n  int local_10 [2];\n  \n  if (rxidx < rxcnt) {\n    uVar1 = (uint)(&rxbuf)[rxidx];\n    rxidx = rxidx + 1;\n  }\n  else {\n    iVar2 = receive(0,&rxbuf,0x80,local_10);\n    if ((iVar2 == 0) && (local_10[0] != 0)) {\n      rxcnt = local_10[0];\n      rxidx = 1;\n      uVar1 = (uint)rxbuf;\n    }\n    else {\n      uVar1 = 0xffffffff;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "next_byte",
                        "receive"
                    ],
                    "calling_functions": [
                        "next_byte",
                        "read_until",
                        "read_n"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "read_until",
                "func_c_signature": "int read_until(undefined4 param_1,char *param_2,uint param_3,char param_4)",
                "decompiled_code": "int read_until(undefined4 param_1,char *param_2,uint param_3,char param_4) {\n  int iVar1;\n  char *local_14;\n  uint local_10;\n  \n  local_14 = param_2;\n  local_10 = 0;\n  do {\n    if (param_3 <= local_10) {\nLAB_00012904:\n      local_14[-1] = '\\0';\n      return (int)local_14 - (int)param_2;\n    }\n    iVar1 = next_byte();\n    if (iVar1 == -1) {\n      return -1;\n    }\n    *local_14 = (char)iVar1;\n    if (param_4 == *local_14) {\n      local_14 = local_14 + 1;\n      goto LAB_00012904;\n    }\n    local_14 = local_14 + 1;\n    local_10 = local_10 + 1;\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "read_until",
                        "next_byte"
                    ],
                    "calling_functions": [
                        "main",
                        "read_until"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            },
            {
                "func_name": "read_n",
                "func_c_signature": "int read_n(undefined4 param_1,undefined *param_2,uint param_3)",
                "decompiled_code": "int read_n(undefined4 param_1,undefined *param_2,uint param_3) {\n  int iVar1;\n  undefined *local_14;\n  uint local_10;\n  \n  local_14 = param_2;\n  local_10 = 0;\n  while( true ) {\n    if (param_3 <= local_10) {\n      return (int)local_14 - (int)param_2;\n    }\n    iVar1 = next_byte();\n    if (iVar1 == -1) break;\n    *local_14 = (char)iVar1;\n    local_14 = local_14 + 1;\n    local_10 = local_10 + 1;\n  }\n  return -1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "read_n",
                        "next_byte"
                    ],
                    "calling_functions": [
                        "cmd_recv_control_file",
                        "cmd_recv_data_file",
                        "read_n"
                    ],
                    "defined_in_file": "KPRCA_00060_decompiled.c"
                }
            }
        ]
    }
}