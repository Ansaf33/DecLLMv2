{
    "file": "realpath",
    "decompiled_code": {
        "realpath.c": [
            {
                "func_name": "usage",
                "func_c_signature": "void usage(int param_1)",
                "decompiled_code": "void usage(int param_1) {\n  FILE *pFVar1;\n  undefined8 uVar2;\n  char *pcVar3;\n  \n  uVar2 = _program_name;\n  if (param_1 == 0) {\n    pcVar3 = (char *)gettext(\"Usage: %s [OPTION]... FILE...\\n\");\n    printf(pcVar3,uVar2);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"Print the resolved absolute file name.\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\n                            \"  -E, --canonicalize           all but the last component must exist (default)\\n  -e, --canonicalize-existing  all components of the path must exist\\n  -m, --canonicalize-missing   no path components need exist or be a directory\\n  -L, --logical                resolve \\'..\\' components before symlinks\\n  -P, --physical               resolve symlinks as encountered (default)\\n  -q, --quiet                  suppress most error messages\\n      --relative-to=DIR        print the resolved path relative to DIR\\n      --relative-base=DIR      print absolute paths unless paths below DIR\\n  -s, --strip, --no-symlinks   don\\'t expand symlinks\\n  -z, --zero                   end each output line with NUL, not newline\\n\"\n                            );\n    fputs_unlocked(pcVar3,pFVar1);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --help        display this help and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --version     output version information and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    emit_ancillary_info(\"realpath\");\n  }\n  else {\n    pcVar3 = (char *)gettext(\"Try \\'%s --help\\' for more information.\\n\");\n    fprintf(_stderr,pcVar3,uVar2);\n  }\n                    /* WARNING: Subroutine does not return */\n  exit(param_1);\n}",
                "globals": [],
                "externs": [
                    "exist",
                    "encountered"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "usage",
                        "gettext",
                        "printf",
                        "fputs_unlocked",
                        "exist",
                        "encountered",
                        "emit_ancillary_info",
                        "fprintf",
                        "exit"
                    ],
                    "calling_functions": [
                        "usage",
                        "main"
                    ],
                    "defined_in_file": "realpath_decompiled.c"
                }
            },
            {
                "func_name": "realpath_canon",
                "func_c_signature": "void * realpath_canon(undefined8 param_1,uint param_2)",
                "decompiled_code": "void * realpath_canon(undefined8 param_1,uint param_2) {\n  void *__ptr;\n  void *pvVar1;\n  \n  __ptr = (void *)canonicalize_filename_mode(param_1,param_2);\n  if ((logical != '\\0') && (__ptr != (void *)0x0)) {\n    pvVar1 = (void *)canonicalize_filename_mode(__ptr,param_2 & 0xfffffffb);\n    free(__ptr);\n    __ptr = pvVar1;\n  }\n  return __ptr;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "realpath_canon",
                        "canonicalize_filename_mode",
                        "free"
                    ],
                    "calling_functions": [
                        "realpath_canon",
                        "process_path",
                        "main"
                    ],
                    "defined_in_file": "realpath_decompiled.c"
                }
            },
            {
                "func_name": "path_prefix",
                "func_c_signature": "bool path_prefix(long param_1,long param_2)",
                "decompiled_code": "bool path_prefix(long param_1,long param_2) {\n  bool bVar1;\n  char *local_18;\n  char *local_10;\n  \n  local_10 = (char *)(param_1 + 1);\n  local_18 = (char *)(param_2 + 1);\n  if (*local_10 == '\\0') {\n    bVar1 = *local_18 != '/';\n  }\n  else if ((*local_10 == '/') && (*(char *)(param_1 + 2) == '\\0')) {\n    bVar1 = *local_18 == '/';\n  }\n  else {\n    for (; (*local_10 != '\\0' && ((*local_18 != '\\0' && (*local_10 == *local_18))));\n        local_10 = local_10 + 1) {\n      local_18 = local_18 + 1;\n    }\n    if ((*local_10 == '\\0') && ((*local_18 == '/' || (*local_18 == '\\0')))) {\n      bVar1 = true;\n    }\n    else {\n      bVar1 = false;\n    }\n  }\n  return bVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "path_prefix"
                    ],
                    "calling_functions": [
                        "path_prefix",
                        "process_path",
                        "main"
                    ],
                    "defined_in_file": "realpath_decompiled.c"
                }
            },
            {
                "func_name": "isdir",
                "func_c_signature": "undefined4 isdir(char *param_1)",
                "decompiled_code": "undefined4 isdir(char *param_1) {\n  int iVar1;\n  undefined8 uVar2;\n  undefined8 uVar3;\n  int *piVar4;\n  long in_FS_OFFSET;\n  stat local_b8;\n  long local_20;\n  \n  local_20 = *(long *)(in_FS_OFFSET + 0x28);\n  iVar1 = stat(param_1,&local_b8);\n  if (iVar1 != 0) {\n    uVar2 = quotearg_style(4,param_1);\n    uVar3 = gettext(\"cannot stat %s\");\n    piVar4 = __errno_location();\n    error(1,*piVar4,uVar3,uVar2);\n  }\n  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return CONCAT31((int3)((local_b8.st_mode & 0xf000) >> 8),(local_b8.st_mode & 0xf000) == 0x4000);\n}",
                "globals": [],
                "externs": [
                    "CONCAT31"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "isdir",
                        "stat",
                        "quotearg_style",
                        "gettext",
                        "__errno_location",
                        "error",
                        "__stack_chk_fail",
                        "CONCAT31"
                    ],
                    "calling_functions": [
                        "isdir",
                        "main"
                    ],
                    "defined_in_file": "realpath_decompiled.c"
                }
            },
            {
                "func_name": "process_path",
                "func_c_signature": "undefined8 process_path(undefined8 param_1,undefined4 param_2)",
                "decompiled_code": "undefined8 process_path(undefined8 param_1,undefined4 param_2) {\n  char cVar1;\n  int __c;\n  char *__s;\n  undefined8 uVar2;\n  int *piVar3;\n  \n  __s = (char *)realpath_canon(param_1,param_2);\n  if (__s != (char *)0x0) {\n    if (((can_relative_to == 0) ||\n        ((can_relative_base != 0 && (cVar1 = path_prefix(can_relative_base,__s), cVar1 != '\\x01'))))\n       || ((can_relative_to != 0 && (cVar1 = relpath(__s,can_relative_to,0,0), cVar1 != '\\x01')))) {\n      fputs_unlocked(__s,_stdout);\n    }\n    if (use_nuls == '\\0') {\n      __c = 10;\n    }\n    else {\n      __c = 0;\n    }\n    putchar_unlocked(__c);\n    free(__s);\n    return 1;\n  }\n  if (verbose != '\\0') {\n    uVar2 = quotearg_n_style_colon(0,3,param_1);\n    piVar3 = __errno_location();\n    error(0,*piVar3,&DAT_001011b9,uVar2);\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "process_path",
                        "realpath_canon",
                        "path_prefix",
                        "relpath",
                        "fputs_unlocked",
                        "putchar_unlocked",
                        "free",
                        "quotearg_n_style_colon",
                        "__errno_location",
                        "error"
                    ],
                    "calling_functions": [
                        "process_path",
                        "main"
                    ],
                    "defined_in_file": "realpath_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "byte main(int param_1,undefined8 *param_2)",
                "decompiled_code": "byte main(int param_1,undefined8 *param_2) {\n  char cVar1;\n  byte bVar2;\n  int iVar3;\n  undefined8 uVar4;\n  int *piVar5;\n  void *__ptr;\n  bool bVar6;\n  bool local_8a;\n  uint local_88;\n  long local_58;\n  long local_50;\n  \n  local_8a = true;\n  local_88 = 1;\n  local_58 = 0;\n  local_50 = 0;\n  set_program_name(*param_2);\n  setlocale(6,\"\");\n  bindtextdomain(\"coreutils\",\"/usr/local/share/locale\");\n  textdomain(\"coreutils\");\n  atexit((__func *)&close_stdout);\n  do {\n    while( true ) {\n      iVar3 = getopt_long(param_1,param_2,\"EeLmPqsz\",longopts,0);\n      if (iVar3 == -1) {\n        if (param_1 <= _optind) {\n          uVar4 = gettext(\"missing operand\");\n          error(0,0,uVar4);\n          usage(1);\n        }\n        if ((local_50 != 0) && (local_58 == 0)) {\n          local_58 = local_50;\n        }\n        bVar6 = (local_88 & 3) == 0;\n        if (local_58 != 0) {\n          can_relative_to = (void *)realpath_canon(local_58,local_88);\n          if (can_relative_to == (void *)0x0) {\n            uVar4 = quotearg_n_style_colon(0,3,local_58);\n            piVar5 = __errno_location();\n            error(1,*piVar5,&DAT_001011b9,uVar4);\n          }\n          if ((bVar6) && (cVar1 = isdir(can_relative_to), cVar1 != '\\x01')) {\n            uVar4 = quotearg_n_style_colon(0,3,local_58);\n            error(1,0x14,&DAT_001011b9,uVar4);\n          }\n        }\n        if (local_50 == local_58) {\n          can_relative_base = can_relative_to;\n          __ptr = can_relative_base;\n        }\n        else {\n          __ptr = can_relative_base;\n          if (local_50 != 0) {\n            __ptr = (void *)realpath_canon(local_50,local_88);\n            if (__ptr == (void *)0x0) {\n              uVar4 = quotearg_n_style_colon(0,3,local_50);\n              piVar5 = __errno_location();\n              error(1,*piVar5,&DAT_001011b9,uVar4);\n            }\n            if ((bVar6) && (cVar1 = isdir(__ptr), cVar1 != '\\x01')) {\n              uVar4 = quotearg_n_style_colon(0,3,local_50);\n              error(1,0x14,&DAT_001011b9,uVar4);\n            }\n            cVar1 = path_prefix(__ptr,can_relative_to);\n            if (cVar1 == '\\0') {\n              free(__ptr);\n              can_relative_base = can_relative_to;\n              can_relative_to = (void *)0x0;\n              __ptr = can_relative_base;\n            }\n          }\n        }\n        for (; can_relative_base = __ptr, _optind < param_1; _optind = _optind + 1) {\n          bVar2 = process_path(param_2[_optind],local_88);\n          local_8a = (bVar2 & local_8a) != 0;\n          __ptr = can_relative_base;\n        }\n        return local_8a ^ 1;\n      }\n      if (iVar3 < 0x82) break;\nswitchD_00100804_caseD_46:\n      usage(1);\n    }\n    if (iVar3 < 0x45) {\n      if (iVar3 == -0x83) {\nLAB_00100896:\n        uVar4 = proper_name_lite(\"Padraig Brady\",&DAT_001011dd);\n        version_etc(_stdout,\"realpath\",\"GNU coreutils\",_Version,uVar4,0);\n                    /* WARNING: Subroutine does not return */\n        exit(0);\n      }\n      if (iVar3 == -0x82) {\n        usage(0);\n        goto LAB_00100896;\n      }\n      goto switchD_00100804_caseD_46;\n    }\n    switch(iVar3) {\n    case 0x45:\n      local_88 = local_88 & 0xfffffffc | 1;\n      break;\n    default:\n      goto switchD_00100804_caseD_46;\n    case 0x4c:\n      local_88 = local_88 | 4;\n      logical = 1;\n      break;\n    case 0x50:\n      local_88 = local_88 & 0xfffffffb;\n      logical = 0;\n      break;\n    case 0x65:\n      local_88 = local_88 & 0xfffffffc;\n      break;\n    case 0x6d:\n      local_88 = local_88 & 0xfffffffc | 2;\n      break;\n    case 0x71:\n      verbose = 0;\n      break;\n    case 0x73:\n      local_88 = local_88 | 4;\n      logical = 0;\n      break;\n    case 0x7a:\n      use_nuls = 1;\n      break;\n    case 0x80:\n      local_58 = _optarg;\n      break;\n    case 0x81:\n      local_50 = _optarg;\n    }\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "set_program_name",
                        "setlocale",
                        "bindtextdomain",
                        "textdomain",
                        "atexit",
                        "getopt_long",
                        "gettext",
                        "error",
                        "usage",
                        "realpath_canon",
                        "quotearg_n_style_colon",
                        "__errno_location",
                        "isdir",
                        "path_prefix",
                        "free",
                        "process_path",
                        "proper_name_lite",
                        "version_etc",
                        "exit"
                    ],
                    "calling_functions": [
                        "main"
                    ],
                    "defined_in_file": "realpath_decompiled.c"
                }
            }
        ]
    }
}