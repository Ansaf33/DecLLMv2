{
    "file": "NRFIN_00073",
    "decompiled_code": {
        "cttp.c": [
            {
                "func_name": "logreq",
                "func_c_signature": "void logreq(void *param_1,undefined4 param_2)",
                "decompiled_code": "void logreq(void *param_1,undefined4 param_2) {\n  void *pvVar1;\n  size_t sVar2;\n  void *pvVar3;\n  undefined4 *puVar4;\n  size_t in_stack_ffffffd8;\n  \n  pvVar1 = calloc(0x1c,in_stack_ffffffd8);\n  if (param_1 == (void *)0x0) {\n    sVar2 = strlen(\"Passed null req\\n\");\n    sendall(2,\"Passed null req\\n\",sVar2);\n  }\n  else if (pvVar1 == (void *)0x0) {\n    sVar2 = strlen(\"Failed to allocate log\\n\");\n    sendall(2,\"Failed to allocate log\\n\",sVar2);\n  }\n  else {\n    pvVar3 = param_1;\n    memcpy(pvVar1,param_1,0x1c);\n    if ((*(int *)((int)pvVar1 + 0x14) != 0) && (*(int *)((int)pvVar1 + 0xc) != 0)) {\n      pvVar3 = calloc(*(size_t *)((int)pvVar1 + 0xc),(size_t)pvVar3);\n      *(void **)((int)pvVar1 + 0x14) = pvVar3;\n      if (*(int *)((int)pvVar1 + 0x14) == 0) {\n        sVar2 = strlen(\"Failed to allocate path\\n\");\n        sendall(2,\"Failed to allocate path\\n\",sVar2);\n        return;\n      }\n      pvVar3 = *(void **)((int)param_1 + 0x14);\n      memcpy(*(void **)((int)pvVar1 + 0x14),pvVar3,*(size_t *)((int)pvVar1 + 0xc));\n    }\n    if ((*(int *)((int)pvVar1 + 0x18) != 0) && (*(int *)((int)pvVar1 + 0x10) != 0)) {\n      pvVar3 = calloc(*(size_t *)((int)pvVar1 + 0x10),(size_t)pvVar3);\n      *(void **)((int)pvVar1 + 0x18) = pvVar3;\n      if (*(int *)((int)pvVar1 + 0x18) == 0) {\n        sVar2 = strlen(\"Failed to allocate body\\n\");\n        sendall(2,\"Failed to allocate body\\n\",sVar2);\n        return;\n      }\n      pvVar3 = *(void **)((int)param_1 + 0x18);\n      memcpy(*(void **)((int)pvVar1 + 0x18),pvVar3,*(size_t *)((int)pvVar1 + 0x10));\n    }\n    puVar4 = (undefined4 *)calloc(8,(size_t)pvVar3);\n    if (puVar4 == (undefined4 *)0x0) {\n      sVar2 = strlen(\"Failed to allocate log entry\\n\");\n      sendall(2,\"Failed to allocate log entry\\n\",sVar2);\n    }\n    else {\n      puVar4[1] = pvVar1;\n      *puVar4 = param_2;\n      pvVar1 = calloc(0xc,(size_t)pvVar3);\n      if (pvVar1 == (void *)0x0) {\n        sVar2 = strlen(\"Failed to allocate node\\n\");\n        sendall(2,\"Failed to allocate node\\n\",sVar2);\n      }\n      else {\n        *(undefined4 **)((int)pvVar1 + 8) = puVar4;\n        list_push_back(&loglist,pvVar1);\n      }\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "logreq",
                        "calloc",
                        "strlen",
                        "sendall",
                        "memcpy",
                        "list_push_back"
                    ],
                    "calling_functions": [
                        "logreq",
                        "handle_retrieve",
                        "handle_submit",
                        "handle_check",
                        "handle_delete",
                        "handle_auth",
                        "handle_v1",
                        "handle_v2",
                        "handle_v3",
                        "handle_v4",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "get_file",
                "func_c_signature": "uint * get_file(void *param_1,uint param_2)",
                "decompiled_code": "uint * get_file(void *param_1,uint param_2) {\n  int iVar1;\n  uint __n;\n  uint *local_18;\n  undefined4 *local_14;\n  undefined4 *local_10;\n  \n  local_18 = (uint *)0x0;\n  if (param_1 != (void *)0x0) {\n    local_10 = files;\n    if (files == (undefined4 *)0x0) {\n      local_14 = (undefined4 *)0x0;\n    }\n    else {\n      local_14 = (undefined4 *)*files;\n    }\n    while (local_10 != (undefined4 *)0x0) {\n      local_18 = (uint *)local_10[2];\n      __n = *local_18;\n      if (param_2 < *local_18) {\n        __n = param_2;\n      }\n      iVar1 = memcmp(param_1,(void *)local_18[2],__n);\n      if (iVar1 == 0) break;\n      local_10 = local_14;\n      if (local_14 == (undefined4 *)0x0) {\n        local_14 = (undefined4 *)0x0;\n      }\n      else {\n        local_14 = (undefined4 *)*local_14;\n      }\n    }\n    if (local_10 == (undefined4 *)0x0) {\n      local_18 = (uint *)0x0;\n    }\n  }\n  return local_18;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_file",
                        "memcmp"
                    ],
                    "calling_functions": [
                        "get_file",
                        "add_file",
                        "handle_retrieve",
                        "handle_check",
                        "handle_auth"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "add_file",
                "func_c_signature": "undefined4 add_file(undefined4 *param_1)",
                "decompiled_code": "undefined4 add_file(undefined4 *param_1) {\n  void *pvVar1;\n  undefined4 uVar2;\n  int iVar3;\n  size_t in_stack_ffffffd8;\n  \n  pvVar1 = calloc(0xc,in_stack_ffffffd8);\n  if (pvVar1 == (void *)0x0) {\n    uVar2 = 0;\n  }\n  else {\n    iVar3 = get_file(param_1[2],*param_1);\n    if (iVar3 == 0) {\n      *(undefined4 **)((int)pvVar1 + 8) = param_1;\n      list_push_back(&files,pvVar1);\n      uVar2 = 1;\n    }\n    else {\n      uVar2 = 0;\n    }\n  }\n  return uVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_file",
                        "calloc",
                        "get_file",
                        "list_push_back"
                    ],
                    "calling_functions": [
                        "add_file",
                        "handle_submit"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "delete_file",
                "func_c_signature": "undefined4 delete_file(void *param_1,uint param_2)",
                "decompiled_code": "undefined4 delete_file(void *param_1,uint param_2) {\n  undefined4 uVar1;\n  int iVar2;\n  uint __n;\n  undefined4 *local_14;\n  undefined4 *local_10;\n  \n  if (param_1 == (void *)0x0) {\n    uVar1 = 0;\n  }\n  else {\n    local_10 = files;\n    if (files == (undefined4 *)0x0) {\n      local_14 = (undefined4 *)0x0;\n    }\n    else {\n      local_14 = (undefined4 *)*files;\n    }\n    while (local_10 != (undefined4 *)0x0) {\n      __n = *(uint *)local_10[2];\n      if (param_2 < __n) {\n        __n = param_2;\n      }\n      iVar2 = memcmp(param_1,(void *)((uint *)local_10[2])[2],__n);\n      if (iVar2 == 0) break;\n      local_10 = local_14;\n      if (local_14 == (undefined4 *)0x0) {\n        local_14 = (undefined4 *)0x0;\n      }\n      else {\n        local_14 = (undefined4 *)*local_14;\n      }\n    }\n    if (local_10 == (undefined4 *)0x0) {\n      uVar1 = 0;\n    }\n    else {\n      list_remove(&files,local_10);\n      uVar1 = 1;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "delete_file",
                        "memcmp",
                        "list_remove"
                    ],
                    "calling_functions": [
                        "delete_file",
                        "handle_delete"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "genericmsg",
                "func_c_signature": "void * genericmsg(undefined4 param_1,char *param_2,size_t param_3)",
                "decompiled_code": "void * genericmsg(undefined4 param_1,char *param_2,size_t param_3) {\n  void *pvVar1;\n  size_t sVar2;\n  void *pvVar3;\n  size_t in_stack_ffffffd8;\n  \n  pvVar1 = calloc(0x10,in_stack_ffffffd8);\n  if (pvVar1 == (void *)0x0) {\n    sVar2 = strlen(\"Failed to allocate resp\");\n    sendall(2,\"Failed to allocate resp\",sVar2);\n    pvVar1 = (void *)internalerror();\n  }\n  else {\n    pvVar3 = calloc(param_3,in_stack_ffffffd8);\n    *(void **)((int)pvVar1 + 0xc) = pvVar3;\n    if (*(int *)((int)pvVar1 + 0xc) == 0) {\n      sVar2 = strlen(\"Failed to allocate resp data\");\n      sendall(2,\"Failed to allocate resp data\",sVar2);\n      pvVar1 = (void *)internalerror();\n    }\n    else {\n      strcpy(*(char **)((int)pvVar1 + 0xc),param_2);\n      sVar2 = strlen(*(char **)((int)pvVar1 + 0xc));\n      *(size_t *)((int)pvVar1 + 8) = sVar2 + 1;\n      *(undefined4 *)((int)pvVar1 + 4) = param_1;\n    }\n  }\n  return pvVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "genericmsg",
                        "calloc",
                        "strlen",
                        "sendall",
                        "internalerror",
                        "strcpy"
                    ],
                    "calling_functions": [
                        "genericmsg",
                        "internalerror",
                        "notimplemented",
                        "handle_submit",
                        "handle_delete"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "internalerror",
                "func_c_signature": "void internalerror(void)",
                "decompiled_code": "void internalerror(void) {\n  genericmsg(0xbaaaaaab,\"If anyone asks, you\\'re my debugger.\",0x24);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "internalerror",
                        "genericmsg"
                    ],
                    "calling_functions": [
                        "genericmsg",
                        "internalerror",
                        "handle_retrieve",
                        "handle_submit",
                        "handle_check",
                        "handle_delete",
                        "handle_auth",
                        "handle_v1",
                        "handle_v2",
                        "handle_v3"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "notimplemented",
                "func_c_signature": "void notimplemented(void)",
                "decompiled_code": "void notimplemented(void) {\n  genericmsg(0xbaaaaaad,\"You want me to do *two* things?!\",0x21);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "notimplemented",
                        "genericmsg"
                    ],
                    "calling_functions": [
                        "notimplemented",
                        "handle_v1",
                        "handle_v2",
                        "handle_v3",
                        "handle_v4",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_retrieve",
                "func_c_signature": "void * handle_retrieve(int param_1)",
                "decompiled_code": "void * handle_retrieve(int param_1) {\n  void *pvVar1;\n  size_t sVar2;\n  int iVar3;\n  void *pvVar4;\n  size_t in_stack_ffffffd8;\n  \n  pvVar1 = calloc(0x10,in_stack_ffffffd8);\n  if (pvVar1 == (void *)0x0) {\n    sVar2 = strlen(\"Failed to allocate resp.\\n\");\n    sendall(2,\"Failed to allocate resp.\\n\",sVar2);\n  }\n  else {\n    if (param_1 == 0) {\n      sVar2 = strlen(\"Passed null req\\n\");\n      sendall(2,\"Passed null req\\n\",sVar2);\n    }\n    else {\n      sVar2 = *(size_t *)(param_1 + 0xc);\n      iVar3 = get_file(*(undefined4 *)(param_1 + 0x14));\n      if (iVar3 == 0) {\n        sVar2 = strlen(\"Failed to find file.\\n\");\n        sendall(2,\"Failed to find file.\\n\",sVar2);\n      }\n      else {\n        pvVar4 = calloc(*(size_t *)(iVar3 + 4),sVar2);\n        *(void **)((int)pvVar1 + 0xc) = pvVar4;\n        if (*(int *)((int)pvVar1 + 0xc) != 0) {\n          memcpy(*(void **)((int)pvVar1 + 0xc),*(void **)(iVar3 + 0xc),*(size_t *)(iVar3 + 4));\n          *(undefined4 *)((int)pvVar1 + 8) = *(undefined4 *)(iVar3 + 4);\n          *(undefined4 *)((int)pvVar1 + 4) = 0xbaaaaaaa;\n          if (dolog == '\\0') {\n            return pvVar1;\n          }\n          logreq(param_1,&DAT_4347c000);\n          return pvVar1;\n        }\n        sVar2 = strlen(\"Failed to allocate resp data\");\n        sendall(2,\"Failed to allocate resp data\",sVar2);\n      }\n    }\n    free(pvVar1);\n  }\n  if ((param_1 != 0) && (dolog != '\\0')) {\n    logreq(param_1,0x4347c002);\n  }\n  pvVar1 = (void *)internalerror();\n  return pvVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_retrieve",
                        "calloc",
                        "strlen",
                        "sendall",
                        "get_file",
                        "memcpy",
                        "logreq",
                        "free",
                        "internalerror"
                    ],
                    "calling_functions": [
                        "handle_retrieve",
                        "handle_v1",
                        "handle_v2",
                        "handle_v3"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_submit",
                "func_c_signature": "void handle_submit(int param_1)",
                "decompiled_code": "void handle_submit(int param_1) {\n  char cVar1;\n  size_t sVar2;\n  undefined4 *__ptr;\n  void *pvVar3;\n  size_t in_stack_ffffffd8;\n  \n  if (param_1 == 0) {\n    sVar2 = strlen(\"Passed null req\\n\");\n    sendall(2,\"Passed null req\\n\",sVar2);\n  }\n  else {\n    __ptr = (undefined4 *)calloc(0x10,in_stack_ffffffd8);\n    if (__ptr == (undefined4 *)0x0) {\n      sVar2 = strlen(\"Failed to alloc file.\\n\");\n      sendall(2,\"Failed to alloc file.\\n\",sVar2);\n    }\n    else {\n      pvVar3 = calloc(*(size_t *)(param_1 + 0xc),in_stack_ffffffd8);\n      __ptr[2] = pvVar3;\n      if (__ptr[2] == 0) {\n        sVar2 = strlen(\"Failed too alloc path.\\n\");\n        sendall(2,\"Failed too alloc path.\\n\",sVar2);\n      }\n      else {\n        pvVar3 = calloc(*(size_t *)(param_1 + 0x10),in_stack_ffffffd8);\n        __ptr[3] = pvVar3;\n        if (__ptr[3] == 0) {\n          sVar2 = strlen(\"Failed to alloc body.\\n\");\n          sendall(2,\"Failed to alloc body.\\n\",sVar2);\n        }\n        else {\n          *__ptr = *(undefined4 *)(param_1 + 0xc);\n          __ptr[1] = *(undefined4 *)(param_1 + 0x10);\n          memcpy((void *)__ptr[2],*(void **)(param_1 + 0x14),*(size_t *)(param_1 + 0xc));\n          memcpy((void *)__ptr[3],*(void **)(param_1 + 0x18),*(size_t *)(param_1 + 0x10));\n          cVar1 = add_file(__ptr);\n          if (cVar1 != '\\0') {\n            if (dolog != '\\0') {\n              logreq(param_1,&DAT_4347c000);\n            }\n            genericmsg(0xbaaaaaaa,\"Oh, sure. Let the robot do all the work.\",0x29);\n            return;\n          }\n          free((void *)__ptr[3]);\n        }\n        free((void *)__ptr[2]);\n      }\n      free(__ptr);\n    }\n  }\n  if ((param_1 != 0) && (dolog != '\\0')) {\n    logreq(param_1,0x4347c002);\n  }\n  internalerror();\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_submit",
                        "strlen",
                        "sendall",
                        "calloc",
                        "memcpy",
                        "add_file",
                        "logreq",
                        "genericmsg",
                        "free",
                        "internalerror"
                    ],
                    "calling_functions": [
                        "handle_submit",
                        "handle_v1",
                        "handle_v2",
                        "handle_v3"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_check",
                "func_c_signature": "void * handle_check(int param_1)",
                "decompiled_code": "void * handle_check(int param_1) {\n  void *pvVar1;\n  size_t sVar2;\n  int iVar3;\n  void *pvVar4;\n  size_t in_stack_ffffffd8;\n  \n  pvVar1 = calloc(0x10,in_stack_ffffffd8);\n  if (pvVar1 == (void *)0x0) {\n    sVar2 = strlen(\"Failed to allocate resp.\\n\");\n    sendall(2,\"Failed to allocate resp.\\n\",sVar2);\n  }\n  else {\n    if (param_1 == 0) {\n      sVar2 = strlen(\"Passed null req\\n\");\n      sendall(2,\"Passed null req\\n\",sVar2);\n    }\n    else {\n      sVar2 = strlen(\"in handle check\\n\");\n      sendall(2,\"in handle check\\n\",sVar2);\n      sVar2 = *(size_t *)(param_1 + 0xc);\n      iVar3 = get_file(*(undefined4 *)(param_1 + 0x14));\n      if (iVar3 == 0) {\n        sVar2 = strlen(\"Failed to find file.\\n\");\n        sendall(2,\"Failed to find file.\\n\",sVar2);\n      }\n      else {\n        pvVar4 = calloc(4,sVar2);\n        *(void **)((int)pvVar1 + 0xc) = pvVar4;\n        if (*(int *)((int)pvVar1 + 0xc) != 0) {\n          sVar2 = strlen(\"found file\\n\");\n          sendall(2,\"found file\\n\",sVar2);\n          memcpy(*(void **)((int)pvVar1 + 0xc),(void *)(iVar3 + 4),4);\n          *(undefined4 *)((int)pvVar1 + 8) = 4;\n          *(undefined4 *)((int)pvVar1 + 4) = 0xbaaaaaaa;\n          if (dolog == '\\0') {\n            return pvVar1;\n          }\n          logreq(param_1,&DAT_4347c000);\n          return pvVar1;\n        }\n        sVar2 = strlen(\"Failed to allocate resp data\");\n        sendall(2,\"Failed to allocate resp data\",sVar2);\n      }\n    }\n    free(pvVar1);\n  }\n  if ((param_1 != 0) && (dolog != '\\0')) {\n    logreq(param_1,0x4347c002);\n  }\n  pvVar1 = (void *)internalerror();\n  return pvVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_check",
                        "calloc",
                        "strlen",
                        "sendall",
                        "get_file",
                        "memcpy",
                        "logreq",
                        "free",
                        "internalerror"
                    ],
                    "calling_functions": [
                        "handle_check",
                        "handle_v2",
                        "handle_v3"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_delete",
                "func_c_signature": "void handle_delete(int param_1)",
                "decompiled_code": "void handle_delete(int param_1) {\n  char cVar1;\n  size_t sVar2;\n  \n  if (param_1 == 0) {\n    sVar2 = strlen(\"Passed null req\\n\");\n    sendall(2,\"Passed null req\\n\",sVar2);\n  }\n  else {\n    cVar1 = delete_file(*(undefined4 *)(param_1 + 0x14),*(undefined4 *)(param_1 + 0xc));\n    if (cVar1 != '\\0') {\n      if (dolog != '\\0') {\n        logreq(param_1,&DAT_4347c000);\n      }\n      genericmsg(0xbaaaaaaa,\"Hopes: deleted.\",0x10);\n      return;\n    }\n  }\n  if ((param_1 != 0) && (dolog != '\\0')) {\n    logreq(param_1,0x4347c002);\n  }\n  internalerror();\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_delete",
                        "strlen",
                        "sendall",
                        "delete_file",
                        "logreq",
                        "genericmsg",
                        "internalerror"
                    ],
                    "calling_functions": [
                        "handle_delete",
                        "handle_v2",
                        "handle_v3"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_auth",
                "func_c_signature": "void * handle_auth(int param_1)",
                "decompiled_code": "void * handle_auth(int param_1) {\n  char cVar1;\n  size_t sVar2;\n  void *pvVar3;\n  size_t in_stack_ffffefc8;\n  byte local_1021 [4096];\n  byte local_21;\n  size_t local_20;\n  int local_1c;\n  void *local_18;\n  uint local_14;\n  uint local_10;\n  \n  local_14 = __cookie;\n  local_18 = calloc(0x10,in_stack_ffffefc8);\n  cVar1 = do_challenge();\n  if (cVar1 == '\\0') {\n    sVar2 = strlen(\"Failed to auth!\\n\");\n    sendall(2,\"Failed to auth!\\n\",sVar2);\n  }\n  else if (local_18 == (void *)0x0) {\n    sVar2 = strlen(\"Failed to allocate resp.\\n\");\n    sendall(2,\"Failed to allocate resp.\\n\",sVar2);\n  }\n  else {\n    if (param_1 == 0) {\n      sVar2 = strlen(\"Passed null req\\n\");\n      sendall(2,\"Passed null req\\n\",sVar2);\n    }\n    else {\n      sVar2 = *(size_t *)(param_1 + 0xc);\n      local_1c = get_file(*(undefined4 *)(param_1 + 0x14));\n      if (local_1c == 0) {\n        sVar2 = strlen(\"Failed to find file.\\n\");\n        sendall(2,\"Failed to find file.\\n\",sVar2);\n      }\n      else {\n        local_20 = *(size_t *)(local_1c + 4);\n        pvVar3 = calloc(local_20,sVar2);\n        *(void **)((int)local_18 + 0xc) = pvVar3;\n        if (*(int *)((int)local_18 + 0xc) != 0) {\n          memcpy(local_1021,*(void **)(local_1c + 0xc),local_20);\n          local_21 = randint();\n          for (local_10 = 0; local_10 < local_20; local_10 = local_10 + 1) {\n            *(byte *)(local_10 + *(int *)((int)local_18 + 0xc)) = local_1021[local_10] ^ local_21;\n          }\n          *(size_t *)((int)local_18 + 8) = local_20;\n          *(undefined4 *)((int)local_18 + 4) = 0xbaaaaaaa;\n          if (dolog != '\\0') {\n            logreq(param_1,&DAT_4347c000);\n          }\n          local_14 = local_14 ^ __cookie;\n          if (local_14 == 0) {\n            return local_18;\n          }\n          __stack_cookie_fail();\n          return local_18;\n        }\n        sVar2 = strlen(\"Failed to allocate resp data\");\n        sendall(2,\"Failed to allocate resp data\",sVar2);\n      }\n    }\n    free(local_18);\n  }\n  if ((param_1 != 0) && (dolog != '\\0')) {\n    logreq(param_1,0x4347c002);\n  }\n  local_14 = local_14 ^ __cookie;\n  if (local_14 != 0) {\n    __stack_cookie_fail();\n  }\n  pvVar3 = (void *)internalerror();\n  return pvVar3;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_auth",
                        "calloc",
                        "do_challenge",
                        "strlen",
                        "sendall",
                        "get_file",
                        "memcpy",
                        "randint",
                        "logreq",
                        "__stack_cookie_fail",
                        "free",
                        "internalerror"
                    ],
                    "calling_functions": [
                        "handle_auth",
                        "handle_v3"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_v1",
                "func_c_signature": "void handle_v1(int param_1)",
                "decompiled_code": "void handle_v1(int param_1) {\n  size_t sVar1;\n  \n  sVar1 = strlen(\"Got v1 req\\n\");\n  sendall(2,\"Got v1 req\\n\",sVar1);\n  if (param_1 == 0) {\n    sVar1 = strlen(\"Passed null request\\n\");\n    sendall(2,\"Passed null request\\n\",sVar1);\n    internalerror();\n  }\n  else if (*(int *)(param_1 + 8) == 0x41414141) {\n    handle_retrieve(param_1);\n  }\n  else if (*(int *)(param_1 + 8) == 0x41414142) {\n    handle_submit(param_1);\n  }\n  else {\n    if (dolog != '\\0') {\n      logreq(param_1,0x4347c002);\n    }\n    notimplemented();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_v1",
                        "strlen",
                        "sendall",
                        "internalerror",
                        "handle_retrieve",
                        "handle_submit",
                        "logreq",
                        "notimplemented"
                    ],
                    "calling_functions": [
                        "handle_v1",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_v2",
                "func_c_signature": "void handle_v2(int param_1)",
                "decompiled_code": "void handle_v2(int param_1) {\n  uint uVar1;\n  size_t sVar2;\n  \n  sVar2 = strlen(\"Got v2 req\\n\");\n  sendall(2,\"Got v2 req\\n\",sVar2);\n  if (param_1 == 0) {\n    sVar2 = strlen(\"Passed null request\\n\");\n    sendall(2,\"Passed null request\\n\",sVar2);\n    internalerror();\n  }\n  else {\n    uVar1 = *(uint *)(param_1 + 8);\n    if (uVar1 == 0x41414145) {\n      handle_delete(param_1);\n    }\n    else {\n      if (uVar1 < 0x41414146) {\n        if (uVar1 == 0x41414143) {\n          handle_check(param_1);\n          return;\n        }\n        if (uVar1 < 0x41414144) {\n          if (uVar1 == 0x41414141) {\n            handle_retrieve(param_1);\n            return;\n          }\n          if (uVar1 == 0x41414142) {\n            handle_submit(param_1);\n            return;\n          }\n        }\n      }\n      if (dolog != '\\0') {\n        logreq(param_1,0x4347c002);\n      }\n      notimplemented();\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_v2",
                        "strlen",
                        "sendall",
                        "internalerror",
                        "handle_delete",
                        "handle_check",
                        "handle_retrieve",
                        "handle_submit",
                        "logreq",
                        "notimplemented"
                    ],
                    "calling_functions": [
                        "handle_v2",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_v3",
                "func_c_signature": "void handle_v3(int param_1)",
                "decompiled_code": "void handle_v3(int param_1) {\n  size_t sVar1;\n  \n  sVar1 = strlen(\"Got v3 req\\n\");\n  sendall(2,\"Got v3 req\\n\",sVar1);\n  if (param_1 == 0) {\n    sVar1 = strlen(\"Passed null request\\n\");\n    sendall(2,\"Passed null request\\n\",sVar1);\n    internalerror();\n  }\n  else {\n    switch(*(undefined4 *)(param_1 + 8)) {\n    case 0x41414141:\n      handle_retrieve(param_1);\n      break;\n    case 0x41414142:\n      handle_submit(param_1);\n      break;\n    case 0x41414143:\n      handle_check(param_1);\n      break;\n    case 0x41414144:\n      handle_auth(param_1);\n      break;\n    case 0x41414145:\n      handle_delete(param_1);\n      break;\n    default:\n      if (dolog != '\\0') {\n        logreq(param_1,0x4347c002);\n      }\n      notimplemented();\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_v3",
                        "strlen",
                        "sendall",
                        "internalerror",
                        "handle_retrieve",
                        "handle_submit",
                        "handle_check",
                        "handle_auth",
                        "handle_delete",
                        "logreq",
                        "notimplemented"
                    ],
                    "calling_functions": [
                        "handle_v3",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_v4",
                "func_c_signature": "void handle_v4(undefined4 param_1)",
                "decompiled_code": "void handle_v4(undefined4 param_1) {\n  size_t sVar1;\n  \n  sVar1 = strlen(\"Got v4 req\\n\");\n  sendall(2,\"Got v4 req\\n\",sVar1);\n  if (dolog != '\\0') {\n    logreq(param_1,0x4347c002);\n  }\n  notimplemented();\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_v4",
                        "strlen",
                        "sendall",
                        "logreq",
                        "notimplemented"
                    ],
                    "calling_functions": [
                        "handle_v4",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "do_challenge",
                "func_c_signature": "undefined do_challenge(void)",
                "decompiled_code": "undefined do_challenge(void) {\n  byte bVar1;\n  uint uVar2;\n  int iVar3;\n  size_t sVar4;\n  ssize_t sVar5;\n  undefined *puVar6;\n  undefined *puVar7;\n  char *apcStackY_e0 [3];\n  size_t asStackY_d4 [6];\n  char *apcStackY_bc [2];\n  size_t asStackY_b4 [6];\n  char *apcStackY_9c [2];\n  size_t asStackY_94 [3];\n  uint *apuStackY_88 [4];\n  void *pvStackY_78;\n  uint auStackY_74 [6];\n  size_t in_stack_ffffffa8;\n  undefined auStack_4c [15];\n  byte local_3d;\n  uint local_34;\n  uint local_30;\n  byte local_29;\n  size_t local_28;\n  undefined local_21;\n  void *local_20;\n  void *local_1c;\n  uint local_18;\n  char *local_14;\n  uint local_10;\n  \n  uVar2 = randint();\n  local_14 = *(char **)(challenges + (uVar2 & 3) * 4);\n  bVar1 = randint();\n  local_29 = randint();\n  local_29 = local_29 ^ bVar1;\n  local_30 = randint();\n  local_18 = local_30;\n  local_28 = strlen(local_14);\n  local_1c = calloc(local_28 + 1,in_stack_ffffffa8);\n  local_20 = calloc(local_28 + 1,in_stack_ffffffa8);\n  if ((local_1c == (void *)0x0) || (local_20 == (void *)0x0)) {\n    strlen(\"Failed to allocate encode/decode buffers.\\n\");\n    sendall();\n    local_21 = 0;\n  }\n  else {\n    for (local_10 = 0; local_10 < local_28; local_10 = local_10 + 1) {\n      local_3d = local_14[local_10];\n      *(byte *)((int)local_1c + local_10) = local_3d ^ local_29;\n    }\n    for (local_10 = 0; local_10 < 4; local_10 = local_10 + 1) {\n      local_3d = *(byte *)((int)&local_30 + local_10);\n      *(byte *)((int)&local_30 + local_10) = local_3d ^ local_29;\n    }\n    iVar3 = sendall();\n    puVar6 = auStack_4c;\n    if (iVar3 < 0) {\n      _terminate();\n      puVar6 = &stack0xffffffa4;\n    }\n    *(undefined4 *)(puVar6 + -8) = 4;\n    *(size_t **)(puVar6 + -0xc) = &local_28;\n    *(undefined4 *)(puVar6 + -0x10) = 1;\n    *(undefined4 *)(puVar6 + -0x14) = 0x124c0;\n    iVar3 = sendall();\n    puVar7 = puVar6;\n    if (iVar3 < 0) {\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 3;\n      *(undefined4 *)(puVar6 + -0x14) = 0x124d1;\n      _terminate();\n    }\n    *(size_t *)(puVar7 + -8) = local_28;\n    *(void **)(puVar7 + -0xc) = local_1c;\n    *(undefined4 *)(puVar7 + -0x10) = 1;\n    *(undefined4 *)(puVar7 + -0x14) = 0x124e2;\n    iVar3 = sendall();\n    puVar6 = puVar7;\n    if (iVar3 < 0) {\n      puVar6 = puVar7 + -0x10;\n      *(undefined4 *)(puVar7 + -0x10) = 3;\n      *(undefined4 *)(puVar7 + -0x14) = 0x124f3;\n      _terminate();\n    }\n    *(undefined4 *)(puVar6 + -8) = 4;\n    *(uint **)(puVar6 + -0xc) = &local_30;\n    *(undefined4 *)(puVar6 + -0x10) = 1;\n    *(undefined4 *)(puVar6 + -0x14) = 0x12503;\n    iVar3 = sendall();\n    puVar7 = puVar6;\n    if (iVar3 < 0) {\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 3;\n      *(undefined4 *)(puVar6 + -0x14) = 0x12514;\n      _terminate();\n    }\n    *(char **)(puVar7 + -0x10) = \"grab decoded\\n\";\n    *(undefined4 *)(puVar7 + -0x14) = 0x12523;\n    sVar4 = strlen(*(char **)(puVar7 + -0x10));\n    *(size_t *)(puVar7 + -8) = sVar4;\n    *(char **)(puVar7 + -0xc) = \"grab decoded\\n\";\n    *(undefined4 *)(puVar7 + -0x10) = 2;\n    *(undefined4 *)(puVar7 + -0x14) = 0x12538;\n    sendall();\n    *(size_t *)(puVar7 + -8) = local_28;\n    *(void **)(puVar7 + -0xc) = local_20;\n    *(undefined4 *)(puVar7 + -0x10) = 0;\n    *(undefined4 *)(puVar7 + -0x14) = 0x1254c;\n    sVar5 = recv(*(int *)(puVar7 + -0x10),*(void **)(puVar7 + -0xc),*(size_t *)(puVar7 + -8),\n                 *(int *)(puVar7 + -4));\n    if (sVar5 < 0) {\n      *(undefined4 *)(puVar7 + -8) = 0x16;\n      *(char **)(puVar7 + -0xc) = \"Please? Thanks? Sorry?\";\n      *(undefined4 *)(puVar7 + -0x10) = 1;\n      *(undefined4 *)(puVar7 + -0x14) = 0x12566;\n      iVar3 = sendline();\n      puVar6 = puVar7;\n      if (iVar3 < 0) {\n        *(undefined4 *)(puVar7 + -0x10) = 6;\n        *(undefined4 *)(puVar7 + -0x14) = 0x12577;\n        _terminate();\n        puVar6 = puVar7 + -0x10;\n      }\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 4;\n      *(undefined4 *)(puVar6 + -0x14) = 0x12581;\n      _terminate();\n    }\n    *(char **)(puVar7 + -0x10) = \"grabbed,now dtok\\n\";\n    *(undefined4 *)(puVar7 + -0x14) = 0x12590;\n    sVar4 = strlen(*(char **)(puVar7 + -0x10));\n    *(size_t *)(puVar7 + -8) = sVar4;\n    *(char **)(puVar7 + -0xc) = \"grabbed,now dtok\\n\";\n    *(undefined4 *)(puVar7 + -0x10) = 2;\n    *(undefined4 *)(puVar7 + -0x14) = 0x125a5;\n    sendall();\n    *(undefined4 *)(puVar7 + -8) = 4;\n    *(uint **)(puVar7 + -0xc) = &local_34;\n    *(undefined4 *)(puVar7 + -0x10) = 0;\n    *(undefined4 *)(puVar7 + -0x14) = 0x125b8;\n    sVar5 = recv(*(int *)(puVar7 + -0x10),*(void **)(puVar7 + -0xc),*(size_t *)(puVar7 + -8),\n                 *(int *)(puVar7 + -4));\n    if (sVar5 < 0) {\n      *(undefined4 *)(puVar7 + -8) = 0x16;\n      *(char **)(puVar7 + -0xc) = \"Please? Thanks? Sorry?\";\n      *(undefined4 *)(puVar7 + -0x10) = 1;\n      *(undefined4 *)(puVar7 + -0x14) = 0x125d2;\n      iVar3 = sendline();\n      puVar6 = puVar7;\n      if (iVar3 < 0) {\n        *(undefined4 *)(puVar7 + -0x10) = 6;\n        *(undefined4 *)(puVar7 + -0x14) = 0x125e3;\n        _terminate();\n        puVar6 = puVar7 + -0x10;\n      }\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 4;\n      *(undefined4 *)(puVar6 + -0x14) = 0x125ed;\n      _terminate();\n    }\n    *(char **)(puVar7 + -0x10) = \"grabbed all\\n\";\n    *(undefined4 *)(puVar7 + -0x14) = 0x125fc;\n    sVar4 = strlen(*(char **)(puVar7 + -0x10));\n    *(size_t *)(puVar7 + -8) = sVar4;\n    *(char **)(puVar7 + -0xc) = \"grabbed all\\n\";\n    *(undefined4 *)(puVar7 + -0x10) = 2;\n    *(undefined4 *)(puVar7 + -0x14) = 0x12611;\n    sendall();\n    *(size_t *)(puVar7 + -8) = local_28;\n    *(void **)(puVar7 + -0xc) = local_20;\n    *(char **)(puVar7 + -0x10) = local_14;\n    *(undefined4 *)(puVar7 + -0x14) = 0x12626;\n    iVar3 = memcmp(*(void **)(puVar7 + -0x10),*(void **)(puVar7 + -0xc),*(size_t *)(puVar7 + -8));\n    if ((iVar3 == 0) && (local_18 == (local_34 ^ 0x127a1b76))) {\n      local_21 = 1;\n    }\n    else {\n      local_21 = 0;\n    }\n    *(void **)(puVar7 + -0x10) = local_1c;\n    *(undefined4 *)(puVar7 + -0x14) = 0x12654;\n    free(*(void **)(puVar7 + -0x10));\n    *(void **)(puVar7 + -0x10) = local_20;\n    *(undefined4 *)(puVar7 + -0x14) = 0x12662;\n    free(*(void **)(puVar7 + -0x10));\n  }\n  return local_21;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_challenge",
                        "randint",
                        "strlen",
                        "calloc",
                        "sendall",
                        "_terminate",
                        "recv",
                        "sendline",
                        "memcmp",
                        "free"
                    ],
                    "calling_functions": [
                        "handle_auth",
                        "do_challenge",
                        "handle_request"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "handle_request",
                "func_c_signature": "undefined4 handle_request(void)",
                "decompiled_code": "undefined4 handle_request(void) {\n  char cVar1;\n  uint uVar2;\n  ssize_t sVar3;\n  int iVar4;\n  size_t sVar5;\n  void *pvVar6;\n  undefined4 uVar7;\n  undefined *puVar8;\n  undefined *puVar9;\n  char *apcStackY_e0 [3];\n  size_t asStackY_d4 [6];\n  uint *puStackY_bc;\n  void *pvStackY_b8;\n  size_t asStackY_b4 [7];\n  char *pcStackY_98;\n  size_t asStackY_94 [2];\n  char *apcStackY_8c [2];\n  size_t asStackY_84 [2];\n  uint *apuStackY_7c [6];\n  size_t asStackY_64 [6];\n  undefined auStack_3c [8];\n  uint local_34 [5];\n  void *local_20;\n  void *local_1c;\n  undefined4 local_18;\n  undefined4 local_14;\n  void *local_10;\n  \n  puVar9 = auStack_3c;\n  uVar2 = 0;\n  do {\n    *(undefined4 *)((int)local_34 + uVar2) = 0;\n    uVar2 = uVar2 + 4;\n  } while (uVar2 < 0x1c);\n  dolog = '\\x01';\n  sVar3 = recv(0,local_34,0x1c,0x1267c);\n  if (sVar3 != 0x1c) {\n    puVar9 = &stack0xffffffb4;\n    strlen(\"Failed to recv request.\\n\");\n    sendall();\n    _terminate();\n  }\n  *(undefined4 *)(puVar9 + -8) = 4;\n  *(undefined **)(puVar9 + -0xc) = &DAT_00083cb0;\n  *(uint **)(puVar9 + -0x10) = local_34;\n  *(undefined4 *)(puVar9 + -0x14) = 0x12706;\n  iVar4 = memcmp(*(void **)(puVar9 + -0x10),*(void **)(puVar9 + -0xc),*(size_t *)(puVar9 + -8));\n  if (iVar4 != 0) {\n    local_34[1] = local_34[1] >> 0x18 |\n                  local_34[1] << 0x18 | (local_34[1] & 0xff00) << 8 | local_34[1] >> 8 & 0xff00;\n    local_34[2] = local_34[2] >> 0x18 |\n                  local_34[2] << 0x18 | (local_34[2] & 0xff00) << 8 | local_34[2] >> 8 & 0xff00;\n    local_34[3] = local_34[3] >> 0x18 |\n                  local_34[3] << 0x18 | (local_34[3] & 0xff00) << 8 | local_34[3] >> 8 & 0xff00;\n    local_34[4] = local_34[4] >> 0x18 |\n                  local_34[4] << 0x18 | (local_34[4] & 0xff00) << 8 | local_34[4] >> 8 & 0xff00;\n  }\n  if (local_34[2] == 0x41414146) {\n    *(undefined4 *)(puVar9 + -8) = 4;\n    *(undefined **)(puVar9 + -0xc) = &DAT_00083cb5;\n    *(undefined4 *)(puVar9 + -0x10) = 1;\n    *(undefined4 *)(puVar9 + -0x14) = 0x127e2;\n    iVar4 = sendall();\n    if (iVar4 < 0) {\n      *(undefined4 *)(puVar9 + -0x10) = 3;\n      *(undefined4 *)(puVar9 + -0x14) = 0x127f3;\n      _terminate();\n    }\n    return 0;\n  }\n  if ((local_34[3] < 0x101) && (local_34[4] < 0x200001)) {\n    if (verified == '\\0') {\n      *(undefined4 *)(puVar9 + -4) = 0x12920;\n      cVar1 = do_challenge();\n      if (cVar1 == '\\0') {\n        if (dolog != '\\0') {\n          *(undefined4 *)(puVar9 + -0xc) = 0x4347c002;\n          *(uint **)(puVar9 + -0x10) = local_34;\n          *(undefined4 *)(puVar9 + -0x14) = 0x12940;\n          logreq();\n        }\n        return 0;\n      }\n    }\n    verified = '\\x01';\n    if (local_34[3] != 0) {\n      local_14 = 0;\n      *(uint *)(puVar9 + -0x10) = local_34[3];\n      *(undefined4 *)(puVar9 + -0x14) = 0x12972;\n      local_20 = calloc(*(size_t *)(puVar9 + -0x10),*(size_t *)(puVar9 + -0xc));\n      if (local_20 == (void *)0x0) {\n        *(char **)(puVar9 + -0x10) = \"Failed to allocate path.\\n\";\n        *(undefined4 *)(puVar9 + -0x14) = 0x1298e;\n        sVar5 = strlen(*(char **)(puVar9 + -0x10));\n        *(size_t *)(puVar9 + -8) = sVar5;\n        *(char **)(puVar9 + -0xc) = \"Failed to allocate path.\\n\";\n        *(undefined4 *)(puVar9 + -0x10) = 2;\n        *(undefined4 *)(puVar9 + -0x14) = 0x129a3;\n        sendall();\n        *(undefined4 *)(puVar9 + -0x10) = 4;\n        *(undefined4 *)(puVar9 + -0x14) = 0x129b0;\n        _terminate();\n        puVar9 = puVar9 + -0x10;\n      }\n      *(uint *)(puVar9 + -8) = local_34[3];\n      *(void **)(puVar9 + -0xc) = local_20;\n      *(undefined4 *)(puVar9 + -0x10) = 0;\n      *(undefined4 *)(puVar9 + -0x14) = 0x129c2;\n      sVar3 = recv(*(int *)(puVar9 + -0x10),*(void **)(puVar9 + -0xc),*(size_t *)(puVar9 + -8),\n                   *(int *)(puVar9 + -4));\n      if (sVar3 < 0) {\n        *(undefined4 *)(puVar9 + -8) = 0x16;\n        *(char **)(puVar9 + -0xc) = \"Please? Thanks? Sorry?\";\n        *(undefined4 *)(puVar9 + -0x10) = 1;\n        *(undefined4 *)(puVar9 + -0x14) = 0x129dc;\n        iVar4 = sendline();\n        puVar8 = puVar9;\n        if (iVar4 < 0) {\n          puVar8 = puVar9 + -0x10;\n          *(undefined4 *)(puVar9 + -0x10) = 6;\n          *(undefined4 *)(puVar9 + -0x14) = 0x129ed;\n          _terminate();\n        }\n        puVar9 = puVar8 + -0x10;\n        *(undefined4 *)(puVar8 + -0x10) = 4;\n        *(undefined4 *)(puVar8 + -0x14) = 0x129f7;\n        _terminate();\n      }\n    }\n    if (local_34[4] != 0) {\n      *(uint *)(puVar9 + -0x10) = local_34[4];\n      *(undefined4 *)(puVar9 + -0x14) = 0x12a0e;\n      local_1c = calloc(*(size_t *)(puVar9 + -0x10),*(size_t *)(puVar9 + -0xc));\n      if (local_1c == (void *)0x0) {\n        *(char **)(puVar9 + -0x10) = \"Failed to allocate body.\\n\";\n        *(undefined4 *)(puVar9 + -0x14) = 0x12a2a;\n        sVar5 = strlen(*(char **)(puVar9 + -0x10));\n        *(size_t *)(puVar9 + -8) = sVar5;\n        *(char **)(puVar9 + -0xc) = \"Failed to allocate body.\\n\";\n        *(undefined4 *)(puVar9 + -0x10) = 2;\n        *(undefined4 *)(puVar9 + -0x14) = 0x12a3f;\n        sendall();\n        *(undefined4 *)(puVar9 + -0x10) = 5;\n        *(undefined4 *)(puVar9 + -0x14) = 0x12a4c;\n        _terminate();\n        puVar9 = puVar9 + -0x10;\n      }\n      *(uint *)(puVar9 + -8) = local_34[4];\n      *(void **)(puVar9 + -0xc) = local_1c;\n      *(undefined4 *)(puVar9 + -0x10) = 0;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12a5e;\n      sVar3 = recv(*(int *)(puVar9 + -0x10),*(void **)(puVar9 + -0xc),*(size_t *)(puVar9 + -8),\n                   *(int *)(puVar9 + -4));\n      if (sVar3 < 0) {\n        *(undefined4 *)(puVar9 + -8) = 0x16;\n        *(char **)(puVar9 + -0xc) = \"Please? Thanks? Sorry?\";\n        *(undefined4 *)(puVar9 + -0x10) = 1;\n        *(undefined4 *)(puVar9 + -0x14) = 0x12a78;\n        iVar4 = sendline();\n        puVar8 = puVar9;\n        if (iVar4 < 0) {\n          puVar8 = puVar9 + -0x10;\n          *(undefined4 *)(puVar9 + -0x10) = 6;\n          *(undefined4 *)(puVar9 + -0x14) = 0x12a89;\n          _terminate();\n        }\n        puVar9 = puVar8 + -0x10;\n        *(undefined4 *)(puVar8 + -0x10) = 4;\n        *(undefined4 *)(puVar8 + -0x14) = 0x12a93;\n        _terminate();\n      }\n    }\n    if (local_34[1] == 0x10000003) {\n      *(uint **)(puVar9 + -0x10) = local_34;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12b0a;\n      local_10 = (void *)handle_v4();\n    }\n    else {\n      if (local_34[1] < 0x10000004) {\n        if (local_34[1] == 0x10000002) {\n          *(uint **)(puVar9 + -0x10) = local_34;\n          *(undefined4 *)(puVar9 + -0x14) = 0x12af6;\n          local_10 = (void *)handle_v3();\n          goto LAB_00012b39;\n        }\n        if (local_34[1] < 0x10000003) {\n          if (local_34[1] == 0x10000000) {\n            *(uint **)(puVar9 + -0x10) = local_34;\n            *(undefined4 *)(puVar9 + -0x14) = 0x12ace;\n            local_10 = (void *)handle_v1();\n            goto LAB_00012b39;\n          }\n          if (local_34[1] == 0x10000001) {\n            *(uint **)(puVar9 + -0x10) = local_34;\n            *(undefined4 *)(puVar9 + -0x14) = 0x12ae2;\n            local_10 = (void *)handle_v2();\n            goto LAB_00012b39;\n          }\n        }\n      }\n      if (dolog != '\\0') {\n        *(undefined4 *)(puVar9 + -0xc) = 0x4347c002;\n        *(uint **)(puVar9 + -0x10) = local_34;\n        *(undefined4 *)(puVar9 + -0x14) = 0x12b2e;\n        logreq();\n      }\n      *(undefined4 *)(puVar9 + -4) = 0x12b36;\n      local_10 = (void *)notimplemented();\n    }\n  }\n  else {\n    *(undefined4 *)(puVar9 + -0x10) = 0x10;\n    *(undefined4 *)(puVar9 + -0x14) = 0x1281f;\n    local_10 = calloc(*(size_t *)(puVar9 + -0x10),*(size_t *)(puVar9 + -0xc));\n    puVar8 = puVar9;\n    if (local_10 == (void *)0x0) {\n      puVar8 = puVar9 + -0x10;\n      *(char **)(puVar9 + -0x10) = \"Failed to allocate resp.\\n\";\n      *(undefined4 *)(puVar9 + -0x14) = 0x1283a;\n      sVar5 = strlen(*(char **)(puVar9 + -0x10));\n      *(size_t *)(puVar9 + -8) = sVar5;\n      *(char **)(puVar9 + -0xc) = \"Failed to allocate resp.\\n\";\n      *(undefined4 *)(puVar9 + -0x10) = 2;\n      *(undefined4 *)(puVar9 + -0x14) = 0x1284f;\n      sendall();\n      *(undefined4 *)(puVar9 + -0x10) = 1;\n      *(undefined4 *)(puVar9 + -0x14) = 0x1285c;\n      _terminate();\n    }\n    *(undefined4 *)(puVar8 + -0x10) = 0x1a;\n    *(undefined4 *)(puVar8 + -0x14) = 0x12866;\n    pvVar6 = calloc(*(size_t *)(puVar8 + -0x10),*(size_t *)(puVar8 + -0xc));\n    *(void **)((int)local_10 + 0xc) = pvVar6;\n    puVar9 = puVar8;\n    if (*(int *)((int)local_10 + 0xc) == 0) {\n      puVar9 = puVar8 + -0x10;\n      *(char **)(puVar8 + -0x10) = \"Failed to allocate resp data.\\n\";\n      *(undefined4 *)(puVar8 + -0x14) = 0x12888;\n      sVar5 = strlen(*(char **)(puVar8 + -0x10));\n      *(size_t *)(puVar8 + -8) = sVar5;\n      *(char **)(puVar8 + -0xc) = \"Failed to allocate resp data.\\n\";\n      *(undefined4 *)(puVar8 + -0x10) = 2;\n      *(undefined4 *)(puVar8 + -0x14) = 0x1289d;\n      sendall();\n      *(undefined4 *)(puVar8 + -0x10) = 1;\n      *(undefined4 *)(puVar8 + -0x14) = 0x128aa;\n      _terminate();\n    }\n    uVar7 = *(undefined4 *)((int)local_10 + 0xc);\n    *(char **)(puVar9 + -0xc) = \"Shut up, baby, I know it!\";\n    *(undefined4 *)(puVar9 + -0x10) = uVar7;\n    *(undefined4 *)(puVar9 + -0x14) = 0x128c0;\n    strcpy(*(char **)(puVar9 + -0x10),*(char **)(puVar9 + -0xc));\n    *(undefined4 *)(puVar9 + -0x10) = *(undefined4 *)((int)local_10 + 0xc);\n    *(undefined4 *)(puVar9 + -0x14) = 0x128d2;\n    sVar5 = strlen(*(char **)(puVar9 + -0x10));\n    *(size_t *)((int)local_10 + 8) = sVar5 + 1;\n    *(undefined4 *)((int)local_10 + 4) = 0xbaaaaaab;\n    if (dolog != '\\0') {\n      *(undefined4 *)(puVar9 + -0xc) = 0x4347c002;\n      *(uint **)(puVar9 + -0x10) = local_34;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12908;\n      logreq();\n    }\n  }\nLAB_00012b39:\n  if (local_10 == (void *)0x0) {\n    uVar7 = 0;\n  }\n  else {\n    local_18 = *(undefined4 *)((int)local_10 + 8);\n    *(undefined4 *)(puVar9 + -8) = 4;\n    *(undefined **)(puVar9 + -0xc) = &DAT_00083cb0;\n    *(uint **)(puVar9 + -0x10) = local_34;\n    *(undefined4 *)(puVar9 + -0x14) = 0x12b61;\n    iVar4 = memcmp(*(void **)(puVar9 + -0x10),*(void **)(puVar9 + -0xc),*(size_t *)(puVar9 + -8));\n    if (iVar4 == 0) {\n      *(undefined4 *)(puVar9 + -8) = 4;\n      *(undefined **)(puVar9 + -0xc) = &DAT_00083cb0;\n      *(void **)(puVar9 + -0x10) = local_10;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12b7d;\n      memcpy(*(void **)(puVar9 + -0x10),*(void **)(puVar9 + -0xc),*(size_t *)(puVar9 + -8));\n    }\n    else {\n      *(undefined4 *)(puVar9 + -8) = 4;\n      *(undefined **)(puVar9 + -0xc) = &DAT_00083d29;\n      *(void **)(puVar9 + -0x10) = local_10;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12b9a;\n      memcpy(*(void **)(puVar9 + -0x10),*(void **)(puVar9 + -0xc),*(size_t *)(puVar9 + -8));\n      *(uint *)((int)local_10 + 8) =\n           *(int *)((int)local_10 + 8) << 0x18 | (*(uint *)((int)local_10 + 8) & 0xff00) << 8 |\n           *(uint *)((int)local_10 + 8) >> 8 & 0xff00 | *(uint *)((int)local_10 + 8) >> 0x18;\n      *(uint *)((int)local_10 + 4) =\n           *(int *)((int)local_10 + 4) << 0x18 | (*(uint *)((int)local_10 + 4) & 0xff00) << 8 |\n           *(uint *)((int)local_10 + 4) >> 8 & 0xff00 | *(uint *)((int)local_10 + 4) >> 0x18;\n    }\n    *(undefined4 *)(puVar9 + -8) = 0xc;\n    *(void **)(puVar9 + -0xc) = local_10;\n    *(undefined4 *)(puVar9 + -0x10) = 1;\n    *(undefined4 *)(puVar9 + -0x14) = 0x12c24;\n    iVar4 = sendall();\n    puVar8 = puVar9;\n    if (iVar4 < 0) {\n      puVar8 = puVar9 + -0x10;\n      *(undefined4 *)(puVar9 + -0x10) = 3;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12c35;\n      _terminate();\n    }\n    uVar7 = *(undefined4 *)((int)local_10 + 0xc);\n    *(undefined4 *)(puVar8 + -8) = local_18;\n    *(undefined4 *)(puVar8 + -0xc) = uVar7;\n    *(undefined4 *)(puVar8 + -0x10) = 1;\n    *(undefined4 *)(puVar8 + -0x14) = 0x12c49;\n    iVar4 = sendall();\n    puVar9 = puVar8;\n    if (iVar4 < 0) {\n      puVar9 = puVar8 + -0x10;\n      *(undefined4 *)(puVar8 + -0x10) = 3;\n      *(undefined4 *)(puVar8 + -0x14) = 0x12c5a;\n      _terminate();\n    }\n    if (local_20 != (void *)0x0) {\n      *(char **)(puVar9 + -0x10) = \"freeing path\\n\";\n      *(undefined4 *)(puVar9 + -0x14) = 0x12c70;\n      sVar5 = strlen(*(char **)(puVar9 + -0x10));\n      *(size_t *)(puVar9 + -8) = sVar5;\n      *(char **)(puVar9 + -0xc) = \"freeing path\\n\";\n      *(undefined4 *)(puVar9 + -0x10) = 2;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12c85;\n      sendall();\n      *(void **)(puVar9 + -0x10) = local_20;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12c94;\n      free(*(void **)(puVar9 + -0x10));\n    }\n    if (local_1c != (void *)0x0) {\n      *(char **)(puVar9 + -0x10) = \"freeing body\\n\";\n      *(undefined4 *)(puVar9 + -0x14) = 0x12cad;\n      sVar5 = strlen(*(char **)(puVar9 + -0x10));\n      *(size_t *)(puVar9 + -8) = sVar5;\n      *(char **)(puVar9 + -0xc) = \"freeing body\\n\";\n      *(undefined4 *)(puVar9 + -0x10) = 2;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12cc2;\n      sendall();\n      *(void **)(puVar9 + -0x10) = local_1c;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12cd1;\n      free(*(void **)(puVar9 + -0x10));\n    }\n    if (*(int *)((int)local_10 + 0xc) != 0) {\n      *(char **)(puVar9 + -0x10) = \"freeing resp data\\n\";\n      *(undefined4 *)(puVar9 + -0x14) = 0x12ced;\n      sVar5 = strlen(*(char **)(puVar9 + -0x10));\n      *(size_t *)(puVar9 + -8) = sVar5;\n      *(char **)(puVar9 + -0xc) = \"freeing resp data\\n\";\n      *(undefined4 *)(puVar9 + -0x10) = 2;\n      *(undefined4 *)(puVar9 + -0x14) = 0x12d02;\n      sendall();\n      *(undefined4 *)(puVar9 + -0x10) = *(undefined4 *)((int)local_10 + 0xc);\n      *(undefined4 *)(puVar9 + -0x14) = 0x12d14;\n      free(*(void **)(puVar9 + -0x10));\n    }\n    *(char **)(puVar9 + -0x10) = \"freeing resp\\n\";\n    *(undefined4 *)(puVar9 + -0x14) = 0x12d26;\n    sVar5 = strlen(*(char **)(puVar9 + -0x10));\n    *(size_t *)(puVar9 + -8) = sVar5;\n    *(char **)(puVar9 + -0xc) = \"freeing resp\\n\";\n    *(undefined4 *)(puVar9 + -0x10) = 2;\n    *(undefined4 *)(puVar9 + -0x14) = 0x12d3b;\n    sendall();\n    *(void **)(puVar9 + -0x10) = local_10;\n    *(undefined4 *)(puVar9 + -0x14) = 0x12d49;\n    free(*(void **)(puVar9 + -0x10));\n    uVar7 = 1;\n  }\n  return uVar7;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_request",
                        "recv",
                        "strlen",
                        "sendall",
                        "_terminate",
                        "memcmp",
                        "do_challenge",
                        "logreq",
                        "calloc",
                        "sendline",
                        "handle_v4",
                        "handle_v3",
                        "handle_v1",
                        "handle_v2",
                        "notimplemented",
                        "strcpy",
                        "memcpy",
                        "free"
                    ],
                    "calling_functions": [
                        "handle_request",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "print_stats",
                "func_c_signature": "void print_stats(void)",
                "decompiled_code": "void print_stats(void) {\n  undefined4 uVar1;\n  int iVar2;\n  undefined *puVar3;\n  undefined *puVar4;\n  undefined auStack_1c [4];\n  int local_18;\n  undefined4 *local_14;\n  undefined4 *local_10;\n  \n  puVar4 = auStack_1c;\n  local_10 = loglist;\n  if (loglist == (undefined4 *)0x0) {\n    local_14 = (undefined4 *)0x0;\n  }\n  else {\n    local_14 = (undefined4 *)*loglist;\n    puVar4 = auStack_1c;\n  }\n  while (local_10 != (undefined4 *)0x0) {\n    iVar2 = local_10[2];\n    if ((*(int *)(*(int *)(iVar2 + 4) + 0x14) != 0) && (*(int *)(*(int *)(iVar2 + 4) + 0xc) != 0)) {\n      local_18 = iVar2;\n      *(undefined4 *)(puVar4 + -8) = 4;\n      *(int *)(puVar4 + -0xc) = iVar2;\n      *(undefined4 *)(puVar4 + -0x10) = 1;\n      *(undefined4 *)(puVar4 + -0x14) = 0x12dcc;\n      iVar2 = sendall();\n      puVar3 = puVar4;\n      if (iVar2 < 0) {\n        puVar3 = puVar4 + -0x10;\n        *(undefined4 *)(puVar4 + -0x10) = 3;\n        *(undefined4 *)(puVar4 + -0x14) = 0x12ddd;\n        _terminate();\n      }\n      uVar1 = *(undefined4 *)(*(int *)(local_18 + 4) + 0x14);\n      *(undefined4 *)(puVar3 + -8) = *(undefined4 *)(*(int *)(local_18 + 4) + 0xc);\n      *(undefined4 *)(puVar3 + -0xc) = uVar1;\n      *(undefined4 *)(puVar3 + -0x10) = 1;\n      *(undefined4 *)(puVar3 + -0x14) = 0x12dfb;\n      iVar2 = sendall();\n      puVar4 = puVar3;\n      if (iVar2 < 0) {\n        puVar4 = puVar3 + -0x10;\n        *(undefined4 *)(puVar3 + -0x10) = 3;\n        *(undefined4 *)(puVar3 + -0x14) = 0x12e0c;\n        _terminate();\n      }\n    }\n    local_10 = local_14;\n    if (local_14 == (undefined4 *)0x0) {\n      local_14 = (undefined4 *)0x0;\n    }\n    else {\n      local_14 = (undefined4 *)*local_14;\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "print_stats",
                        "sendall",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "print_stats",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            }
        ],
        "prng.c": [
            {
                "func_name": "randint",
                "func_c_signature": "uint randint(void)",
                "decompiled_code": "uint randint(void) {\n  if (initialized == '\\0') {\n    last = _DAT_4347c000;\n    initialized = '\\x01';\n  }\n  last = last ^ *(uint *)(&DAT_4347c000 +\n                         (*(uint *)(&DAT_4347c000 + (last & 0x3ff) * 4) & 0x3ff) * 4) ^\n                *(uint *)(&DAT_4347c000 +\n                         (last * *(int *)(&DAT_4347c000 + (last & 0x3ff) * 4) & 0x3ff) * 4);\n  return last;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "randint"
                    ],
                    "calling_functions": [
                        "handle_auth",
                        "do_challenge",
                        "randint",
                        "rand"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "rand",
                "func_c_signature": "int rand(void)",
                "decompiled_code": "int rand(void) {\n  undefined uVar1;\n  int in_stack_00000004;\n  uint in_stack_00000008;\n  uint *in_stack_0000000c;\n  uint local_8;\n  \n  for (local_8 = 0; local_8 < in_stack_00000008; local_8 = local_8 + 1) {\n    uVar1 = randint();\n    *(undefined *)(local_8 + in_stack_00000004) = uVar1;\n  }\n  if (in_stack_0000000c != (uint *)0x0) {\n    *in_stack_0000000c = local_8;\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "rand",
                        "randint"
                    ],
                    "calling_functions": [
                        "rand",
                        "heapinit",
                        "__stack_cookie_init"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            }
        ],
        "service.c": [
            {
                "func_name": "initialize",
                "func_c_signature": "void initialize(int param_1,uint param_2)",
                "decompiled_code": "void initialize(int param_1,uint param_2) {\n  uint local_10;\n  \n  if (param_2 < 0x11) {\n    for (local_10 = 0; local_10 < param_2; local_10 = local_10 + 1) {\n      memcpy((void *)(param_1 + local_10 * 0x1000),&DAT_4347c000,0x1000);\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "initialize",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "initialize",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  undefined **ppuVar1;\n  char cVar2;\n  undefined *puVar3;\n  undefined4 uStack_100bc;\n  undefined4 uStack_100b8;\n  int iStack_100b4;\n  uint auStack_100b0 [32];\n  undefined auStack_10030 [28];\n  undefined auStack_10014 [65508];\n  int local_30;\n  uint local_2c;\n  undefined4 local_28;\n  uint local_24;\n  undefined *local_14;\n  \n  local_14 = &stack0x00000004;\n  ppuVar1 = &local_14;\n  do {\n    puVar3 = (undefined *)ppuVar1;\n    *(undefined4 *)(puVar3 + -0x1000) = *(undefined4 *)(puVar3 + -0x1000);\n    ppuVar1 = (undefined **)(puVar3 + -0x1000);\n  } while (puVar3 + -0x1000 != auStack_10014);\n  *(undefined4 *)(puVar3 + -0x10b0) = 0x132ec;\n  iStack_100b4 = 0;\n  uStack_100bc = 2;\n  uStack_100b8 = 0;\n  local_28 = 0;\n  *(undefined4 *)(puVar3 + -0x10b8) = 0x10;\n  *(undefined **)(puVar3 + -0x10bc) = auStack_10030;\n  *(undefined4 *)(puVar3 + -0x10c0) = 0x13328;\n  initialize();\n  *(undefined4 *)(puVar3 + -0x10b0) = 0x13330;\n  __stack_cookie_init();\n  do {\n    for (local_24 = 0; local_24 < 0x20; local_24 = local_24 + 1) {\n      auStack_100b0[local_24] = 0;\n    }\n    auStack_100b0[local_2c >> 5] = auStack_100b0[local_2c >> 5] | 1 << ((byte)local_2c & 0x1f);\n    *(int **)(puVar3 + -0x10bc) = &iStack_100b4;\n    *(undefined4 **)(puVar3 + -0x10c0) = &uStack_100bc;\n    *(undefined4 *)(puVar3 + -0x10c4) = 0;\n    *(uint **)(puVar3 + -0x10c8) = auStack_100b0;\n    *(uint *)(puVar3 + -0x10cc) = local_2c + 1;\n    *(undefined4 *)(puVar3 + -0x10d0) = 0x1339e;\n    local_30 = fdwait();\n    if ((local_30 != 0) || (iStack_100b4 == 0)) break;\n    *(undefined4 *)(puVar3 + -0x10b0) = 0x133b9;\n    cVar2 = handle_request();\n  } while (cVar2 != '\\0');\n  *(undefined4 *)(puVar3 + -0x10b0) = 0x133c8;\n  print_stats();\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "initialize",
                        "__stack_cookie_init",
                        "fdwait",
                        "handle_request",
                        "print_stats"
                    ],
                    "calling_functions": [
                        "_start",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00073_decompiled.c"
                }
            }
        ]
    }
}