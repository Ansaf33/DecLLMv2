{
    "file": "NRFIN_00024",
    "decompiled_code": {
        "service.c": [
            {
                "func_name": "find_session",
                "func_c_signature": "undefined4 * find_session(uint param_1)",
                "decompiled_code": "undefined4 * find_session(uint param_1) {\n  undefined4 *local_8;\n  \n  local_8 = head;\n  while( true ) {\n    if (local_8 == (undefined4 *)0x0) {\n      return (undefined4 *)0x0;\n    }\n    if (param_1 == *(ushort *)(local_8 + 1)) break;\n    local_8 = (undefined4 *)*local_8;\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "find_session"
                    ],
                    "calling_functions": [
                        "find_session",
                        "process_msg"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "new_session",
                "func_c_signature": "void * new_session(int param_1)",
                "decompiled_code": "void * new_session(int param_1) {\n  int iVar1;\n  void *pvVar2;\n  undefined *puVar3;\n  undefined *puVar4;\n  undefined *puVar5;\n  size_t asStackY_60 [6];\n  char *apcStackY_48 [7];\n  size_t in_stack_ffffffd8;\n  undefined4 uStack_24;\n  undefined4 uStack_20;\n  undefined auStack_1c [12];\n  void *local_10;\n  \n  puVar3 = auStack_1c;\n  puVar4 = auStack_1c;\n  uStack_20 = 0x11050;\n  local_10 = (void *)0x0;\n  local_10 = calloc(0x14,in_stack_ffffffd8);\n  if (local_10 == (void *)0x0) {\n    uStack_24 = 0xe;\n    iVar1 = sendline();\n    if (iVar1 < 0) {\n      puVar3 = &stack0xffffffd4;\n      _terminate();\n    }\n    puVar4 = puVar3 + -0x10;\n    *(undefined4 *)(puVar3 + -0x10) = 0x5a;\n    *(undefined4 *)(puVar3 + -0x14) = 0x110a1;\n    _terminate();\n  }\n  *(uint *)(puVar4 + -0x10) = (uint)*(ushort *)(param_1 + 0x14);\n  *(undefined4 *)(puVar4 + -0x14) = 0x110b4;\n  pvVar2 = calloc(*(size_t *)(puVar4 + -0x10),*(size_t *)(puVar4 + -0xc));\n  *(void **)((int)local_10 + 8) = pvVar2;\n  if (*(int *)((int)local_10 + 8) == 0) {\n    *(undefined4 *)(puVar4 + -8) = 0xe;\n    *(char **)(puVar4 + -0xc) = \"ROFL FALAFELS!\";\n    *(undefined4 *)(puVar4 + -0x10) = 1;\n    *(undefined4 *)(puVar4 + -0x14) = 0x110da;\n    iVar1 = sendline();\n    puVar5 = puVar4;\n    if (iVar1 < 0) {\n      *(undefined4 *)(puVar4 + -0x10) = 6;\n      *(undefined4 *)(puVar4 + -0x14) = 0x110eb;\n      _terminate();\n      puVar5 = puVar4 + -0x10;\n    }\n    *(undefined4 *)(puVar5 + -0x10) = 0x5a;\n    *(undefined4 *)(puVar5 + -0x14) = 0x110f5;\n    _terminate();\n  }\n  *(undefined2 *)((int)local_10 + 4) = *(undefined2 *)(param_1 + 0x10);\n  *(undefined2 *)((int)local_10 + 6) = *(undefined2 *)(param_1 + 0x14);\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "new_session",
                        "calloc",
                        "sendline",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "new_session",
                        "add_session"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "add_session",
                "func_c_signature": "undefined4 * add_session(undefined4 param_1)",
                "decompiled_code": "undefined4 * add_session(undefined4 param_1) {\n  undefined4 *puVar1;\n  undefined4 uVar2;\n  \n  puVar1 = head;\n  if (head == (undefined4 *)0x0) {\n    puVar1 = (undefined4 *)new_session(param_1);\n    head = puVar1;\n  }\n  else {\n    uVar2 = new_session(param_1);\n    *puVar1 = uVar2;\n    puVar1 = (undefined4 *)*puVar1;\n  }\n  return puVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_session",
                        "new_session"
                    ],
                    "calling_functions": [
                        "add_session",
                        "process_msg"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "delete_session",
                "func_c_signature": "void delete_session(uint param_1)",
                "decompiled_code": "void delete_session(uint param_1) {\n  undefined4 *puVar1;\n  undefined4 *local_14;\n  undefined4 *local_10;\n  \n  local_10 = head;\n  while( true ) {\n    if (local_10 == (undefined4 *)0x0) {\n      return;\n    }\n    if (param_1 == *(ushort *)(local_10 + 1)) break;\n    local_10 = (undefined4 *)*local_10;\n  }\n  local_14 = (undefined4 *)local_10[4];\n  while (local_14 != (undefined4 *)0x0) {\n    puVar1 = (undefined4 *)*local_14;\n    free(*(void **)(local_14[1] + 0x18));\n    free((void *)local_14[1]);\n    free(local_14);\n    local_14 = puVar1;\n  }\n  free((void *)local_10[2]);\n  free(local_10);\n  outstanding = outstanding + -1;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "delete_session",
                        "free"
                    ],
                    "calling_functions": [
                        "delete_session",
                        "process_msg"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "add_msg",
                "func_c_signature": "void * add_msg(void *param_1,int param_2)",
                "decompiled_code": "void * add_msg(void *param_1,int param_2) {\n  undefined4 uVar1;\n  int iVar2;\n  undefined *puVar3;\n  undefined *puVar4;\n  undefined *puVar5;\n  void *apvStackY_80 [3];\n  size_t asStackY_74 [7];\n  char *apcStackY_58 [7];\n  size_t in_stack_ffffffc8;\n  undefined4 uStack_34;\n  undefined4 uStack_30;\n  undefined auStack_2c [12];\n  void *local_20;\n  int *local_1c;\n  int local_18;\n  uint local_14;\n  int **local_10;\n  \n  puVar3 = auStack_2c;\n  puVar5 = auStack_2c;\n  uStack_30 = 0x11271;\n  local_10 = (int **)0x0;\n  local_1c = (int *)0x0;\n  local_20 = (void *)0x0;\n  local_18 = 0;\n  if ((*(ushort *)(param_2 + 6) < *(ushort *)((int)param_1 + 0x12)) ||\n     (*(char *)((uint)*(ushort *)((int)param_1 + 0x12) + *(int *)(param_2 + 8)) != '\\0')) {\n    free(*(void **)((int)param_1 + 0x18));\n    free(param_1);\n    local_20 = (void *)0x0;\n  }\n  else {\n    local_1c = (int *)calloc(8,in_stack_ffffffc8);\n    if (local_1c == (int *)0x0) {\n      uStack_34 = 0xe;\n      iVar2 = sendline();\n      if (iVar2 < 0) {\n        puVar3 = &stack0xffffffc4;\n        _terminate();\n      }\n      puVar5 = puVar3 + -0x10;\n      *(undefined4 *)(puVar3 + -0x10) = 0x5a;\n      *(undefined4 *)(puVar3 + -0x14) = 0x1132d;\n      _terminate();\n    }\n    local_1c[1] = (int)param_1;\n    *local_1c = 0;\n    if (*(int *)(param_2 + 0x10) == 0) {\n      *(int **)(param_2 + 0x10) = local_1c;\n    }\n    else {\n      for (local_10 = *(int ***)(param_2 + 0x10); *local_10 != (int *)0x0;\n          local_10 = (int **)*local_10) {\n      }\n      *local_10 = local_1c;\n    }\n    *(undefined *)((uint)*(ushort *)((int)param_1 + 0x12) + *(int *)(param_2 + 8)) = 1;\n    *(uint *)(param_2 + 0xc) = *(int *)(param_2 + 0xc) + (uint)*(ushort *)((int)param_1 + 0x16);\n    for (local_14 = 0;\n        (local_14 < *(ushort *)(param_2 + 6) &&\n        (*(char *)(local_14 + *(int *)(param_2 + 8)) != '\\0')); local_14 = local_14 + 1) {\n    }\n    if (local_14 == *(ushort *)(param_2 + 6)) {\n      *(undefined4 *)(puVar5 + -0x10) = *(undefined4 *)(param_2 + 0xc);\n      *(undefined4 *)(puVar5 + -0x14) = 0x113f5;\n      local_20 = calloc(*(size_t *)(puVar5 + -0x10),*(size_t *)(puVar5 + -0xc));\n      if (local_20 == (void *)0x0) {\n        *(undefined4 *)(puVar5 + -8) = 0xe;\n        *(char **)(puVar5 + -0xc) = \"ROFL FALAFELS!\";\n        *(undefined4 *)(puVar5 + -0x10) = 1;\n        *(undefined4 *)(puVar5 + -0x14) = 0x11414;\n        iVar2 = sendline();\n        puVar4 = puVar5;\n        if (iVar2 < 0) {\n          puVar4 = puVar5 + -0x10;\n          *(undefined4 *)(puVar5 + -0x10) = 6;\n          *(undefined4 *)(puVar5 + -0x14) = 0x11425;\n          _terminate();\n        }\n        puVar5 = puVar4 + -0x10;\n        *(undefined4 *)(puVar4 + -0x10) = 0x5f;\n        *(undefined4 *)(puVar4 + -0x14) = 0x1142f;\n        _terminate();\n      }\n      for (local_14 = 0; local_14 < *(ushort *)(param_2 + 6); local_14 = local_14 + 1) {\n        for (local_10 = *(int ***)(param_2 + 0x10); local_10 != (int **)0x0;\n            local_10 = (int **)*local_10) {\n          if (local_14 == *(ushort *)((int)local_10[1] + 0x12)) {\n            uVar1 = *(undefined4 *)((int)local_10[1] + 0x18);\n            *(uint *)(puVar5 + -8) = (uint)*(ushort *)((int)local_10[1] + 0x16);\n            *(undefined4 *)(puVar5 + -0xc) = uVar1;\n            *(int *)(puVar5 + -0x10) = local_18 + (int)local_20;\n            *(undefined4 *)(puVar5 + -0x14) = 0x1147e;\n            memcpy(*(void **)(puVar5 + -0x10),*(void **)(puVar5 + -0xc),*(size_t *)(puVar5 + -8));\n            local_18 = local_18 + (uint)*(ushort *)((int)local_10[1] + 0x16);\n            break;\n          }\n        }\n      }\n    }\n    else {\n      local_20 = (void *)0x0;\n    }\n  }\n  return local_20;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_msg",
                        "free",
                        "calloc",
                        "sendline",
                        "_terminate",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "add_msg",
                        "process_msg"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "process_msg",
                "func_c_signature": "void process_msg(int param_1)",
                "decompiled_code": "void process_msg(int param_1) {\n  int iVar1;\n  int *piVar2;\n  int iStack_2c;\n  int iStack_28;\n  undefined4 uStack_24;\n  uint uStack_20;\n  undefined auStack_1c [8];\n  int local_14;\n  int local_10;\n  \n  local_10 = 0;\n  uStack_20 = (uint)*(ushort *)(param_1 + 0x10);\n  uStack_24 = 0x114ee;\n  local_10 = find_session();\n  if (local_10 == 0) {\n    iStack_2c = param_1;\n    local_10 = add_session();\n  }\n  iStack_28 = local_10;\n  iStack_2c = param_1;\n  iStack_28 = add_msg();\n  if (iStack_28 != 0) {\n    uStack_24 = *(undefined4 *)(local_10 + 0xc);\n    iStack_2c = 1;\n    local_14 = iStack_28;\n    iVar1 = sendall();\n    piVar2 = (int *)auStack_1c;\n    if (iVar1 < 0) {\n      iStack_2c = 3;\n      _terminate();\n      piVar2 = &iStack_2c;\n    }\n    *(int *)((int)piVar2 + -0x10) = local_14;\n    *(undefined4 *)((int)piVar2 + -0x14) = 0x11555;\n    free(*(void **)((int)piVar2 + -0x10));\n    *(uint *)((int)piVar2 + -0x10) = (uint)*(ushort *)(local_10 + 4);\n    *(undefined4 *)((int)piVar2 + -0x14) = 0x1156b;\n    delete_session();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "process_msg",
                        "find_session",
                        "add_session",
                        "add_msg",
                        "sendall",
                        "_terminate",
                        "free",
                        "delete_session"
                    ],
                    "calling_functions": [
                        "process_msg",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "recv_msg",
                "func_c_signature": "void * recv_msg(void)",
                "decompiled_code": "void * recv_msg(void) {\n  undefined4 uVar1;\n  int iVar2;\n  ssize_t sVar3;\n  void *pvVar4;\n  undefined *puVar5;\n  undefined *puVar6;\n  undefined *puVar7;\n  int aiStackY_c0 [6];\n  char *pcStackY_a8;\n  size_t asStackY_a4 [7];\n  char *apcStackY_88 [15];\n  int iStackY_4c;\n  char *pcStackY_48;\n  size_t asStackY_44 [6];\n  size_t in_stack_ffffffd8;\n  undefined4 uStack_24;\n  undefined4 uStack_20;\n  undefined auStack_1c [12];\n  void *local_10;\n  \n  puVar5 = auStack_1c;\n  puVar6 = auStack_1c;\n  uStack_20 = 0x11580;\n  local_10 = calloc(0x1c,in_stack_ffffffd8);\n  if (local_10 == (void *)0x0) {\n    uStack_24 = 0xe;\n    iVar2 = sendline();\n    if (iVar2 < 0) {\n      puVar5 = &stack0xffffffd4;\n      _terminate();\n    }\n    puVar6 = puVar5 + -0x10;\n    *(undefined4 *)(puVar5 + -0x10) = 0x5d;\n    *(undefined4 *)(puVar5 + -0x14) = 0x115ca;\n    _terminate();\n  }\n  *(undefined4 *)(puVar6 + -8) = 0x18;\n  *(void **)(puVar6 + -0xc) = local_10;\n  *(undefined4 *)(puVar6 + -0x10) = 0;\n  *(undefined4 *)(puVar6 + -0x14) = 0x115d9;\n  sVar3 = recv(*(int *)(puVar6 + -0x10),*(void **)(puVar6 + -0xc),*(size_t *)(puVar6 + -8),\n               *(int *)(puVar6 + -4));\n  if (sVar3 < 0) {\n    *(undefined4 *)(puVar6 + -8) = 0x1e;\n    *(char **)(puVar6 + -0xc) = \"You didn\\'t say the magic word.\";\n    *(undefined4 *)(puVar6 + -0x10) = 1;\n    *(undefined4 *)(puVar6 + -0x14) = 0x115f3;\n    iVar2 = sendline();\n    puVar7 = puVar6;\n    if (iVar2 < 0) {\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 6;\n      *(undefined4 *)(puVar6 + -0x14) = 0x11604;\n      _terminate();\n    }\n    puVar6 = puVar7 + -0x10;\n    *(undefined4 *)(puVar7 + -0x10) = 4;\n    *(undefined4 *)(puVar7 + -0x14) = 0x1160e;\n    _terminate();\n  }\n  if ((*(short *)((int)local_10 + 0x16) == 0) || (0x100 < *(ushort *)((int)local_10 + 0x16))) {\n    *(undefined4 *)(puVar6 + -8) = 0xe;\n    *(char **)(puVar6 + -0xc) = \"ROFL FALAFELS!\";\n    *(undefined4 *)(puVar6 + -0x10) = 1;\n    *(undefined4 *)(puVar6 + -0x14) = 0x1163a;\n    iVar2 = sendline();\n    puVar7 = puVar6;\n    if (iVar2 < 0) {\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 6;\n      *(undefined4 *)(puVar6 + -0x14) = 0x1164b;\n      _terminate();\n    }\n    puVar6 = puVar7 + -0x10;\n    *(undefined4 *)(puVar7 + -0x10) = 0x5b;\n    *(undefined4 *)(puVar7 + -0x14) = 0x11655;\n    _terminate();\n  }\n  *(uint *)(puVar6 + -0x10) = (uint)*(ushort *)((int)local_10 + 0x16);\n  *(undefined4 *)(puVar6 + -0x14) = 0x11668;\n  pvVar4 = calloc(*(size_t *)(puVar6 + -0x10),*(size_t *)(puVar6 + -0xc));\n  *(void **)((int)local_10 + 0x18) = pvVar4;\n  if (*(int *)((int)local_10 + 0x18) == 0) {\n    *(undefined4 *)(puVar6 + -8) = 0xe;\n    *(char **)(puVar6 + -0xc) = \"ROFL FALAFELS!\";\n    *(undefined4 *)(puVar6 + -0x10) = 1;\n    *(undefined4 *)(puVar6 + -0x14) = 0x1168e;\n    iVar2 = sendline();\n    puVar7 = puVar6;\n    if (iVar2 < 0) {\n      puVar7 = puVar6 + -0x10;\n      *(undefined4 *)(puVar6 + -0x10) = 6;\n      *(undefined4 *)(puVar6 + -0x14) = 0x1169f;\n      _terminate();\n    }\n    puVar6 = puVar7 + -0x10;\n    *(undefined4 *)(puVar7 + -0x10) = 0x5e;\n    *(undefined4 *)(puVar7 + -0x14) = 0x116a9;\n    _terminate();\n  }\n  uVar1 = *(undefined4 *)((int)local_10 + 0x18);\n  *(uint *)(puVar6 + -8) = (uint)*(ushort *)((int)local_10 + 0x16);\n  *(undefined4 *)(puVar6 + -0xc) = uVar1;\n  *(undefined4 *)(puVar6 + -0x10) = 0;\n  *(undefined4 *)(puVar6 + -0x14) = 0x116c5;\n  sVar3 = recv(*(int *)(puVar6 + -0x10),*(void **)(puVar6 + -0xc),*(size_t *)(puVar6 + -8),\n               *(int *)(puVar6 + -4));\n  if (sVar3 < 0) {\n    *(undefined4 *)(puVar6 + -8) = 0x1e;\n    *(char **)(puVar6 + -0xc) = \"You didn\\'t say the magic word.\";\n    *(undefined4 *)(puVar6 + -0x10) = 1;\n    *(undefined4 *)(puVar6 + -0x14) = 0x116df;\n    iVar2 = sendline();\n    puVar7 = puVar6;\n    if (iVar2 < 0) {\n      *(undefined4 *)(puVar6 + -0x10) = 6;\n      *(undefined4 *)(puVar6 + -0x14) = 0x116f0;\n      _terminate();\n      puVar7 = puVar6 + -0x10;\n    }\n    *(undefined4 *)(puVar7 + -0x10) = 4;\n    *(undefined4 *)(puVar7 + -0x14) = 0x116fa;\n    _terminate();\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "recv_msg",
                        "calloc",
                        "sendline",
                        "_terminate",
                        "recv"
                    ],
                    "calling_functions": [
                        "recv_msg",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "check_number",
                "func_c_signature": "undefined4 check_number(byte *param_1,byte *param_2)",
                "decompiled_code": "undefined4 check_number(byte *param_1,byte *param_2) {\n  undefined4 uVar1;\n  \n  if ((((((*param_1 & 0xf) == (*param_2 & 0xf)) && (*param_1 >> 4 == *param_2 >> 4)) &&\n       ((param_1[1] & 0xf) == (param_2[1] & 0xf))) &&\n      (((param_1[1] >> 4 == param_2[1] >> 4 && ((param_1[2] & 0xf) == (param_2[2] & 0xf))) &&\n       ((param_1[2] >> 4 == param_2[2] >> 4 &&\n        (((param_1[3] & 0xf) == (param_2[3] & 0xf) && (param_1[3] >> 4 == param_2[3] >> 4)))))))) &&\n     (((param_1[4] & 0xf) == (param_2[4] & 0xf) &&\n      (((((param_1[4] >> 4 == param_2[4] >> 4 && ((param_1[5] & 0xf) == (param_2[5] & 0xf))) &&\n         (param_1[5] >> 4 == param_2[5] >> 4)) &&\n        (((param_1[6] & 0xf) == (param_2[6] & 0xf) && (param_1[6] >> 4 == param_2[6] >> 4)))) &&\n       ((param_1[7] & 0xf) == (param_2[7] & 0xf))))))) {\n    uVar1 = 1;\n  }\n  else {\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "check_number"
                    ],
                    "calling_functions": [
                        "check_number",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  char cVar1;\n  undefined4 local_1c;\n  undefined4 local_18;\n  int local_14;\n  undefined *local_10;\n  \n  local_10 = &stack0x00000004;\n  local_14 = 0;\n  local_1c = 0x73317331;\n  local_18 = 0x3000000;\n  local_14 = recv_msg();\n  outstanding = (uint)(*(byte *)(local_14 + 7) >> 4);\n  while( true ) {\n    cVar1 = check_number(local_14,&local_1c);\n    if (cVar1 != '\\0') {\n      process_msg(local_14);\n    }\n    if (outstanding == 0) break;\n    local_14 = recv_msg();\n    if (local_14 == 0) {\n      return 0;\n    }\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "recv_msg",
                        "check_number",
                        "process_msg"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "NRFIN_00024_decompiled.c"
                }
            }
        ]
    }
}