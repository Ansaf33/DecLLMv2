{
    "file": "NRFIN_00051",
    "decompiled_code": {
        "service.c": [
            {
                "func_name": "access_check",
                "func_c_signature": "undefined4 access_check(uint param_1,uint param_2,uint param_3)",
                "decompiled_code": "undefined4 access_check(uint param_1,uint param_2,uint param_3) {\n  undefined4 uVar1;\n  \n  if (((param_1 < param_2) || (param_3 < param_1)) &&\n     ((param_1 + 3 < param_2 || (param_3 < param_1 + 3)))) {\n    uVar1 = 0;\n  }\n  else {\n    uVar1 = 1;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "access_check"
                    ],
                    "calling_functions": [
                        "access_check",
                        "do_normal",
                        "do_scratch"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "packet_send",
                "func_c_signature": "undefined4 packet_send(undefined4 param_1)",
                "decompiled_code": "undefined4 packet_send(undefined4 param_1) {\n  undefined4 uVar1;\n  \n  uVar1 = send_bytes(1,param_1,0x1c,0x1104d);\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "packet_send",
                        "send_bytes"
                    ],
                    "calling_functions": [
                        "packet_send",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "packet_recv",
                "func_c_signature": "int packet_recv(void *param_1)",
                "decompiled_code": "int packet_recv(void *param_1) {\n  int iVar1;\n  \n  if (0x7d04cU - (int)rx_buf_cursor < 0x1d) {\n    if ((undefined4 *)rx_buf_cursor == &func_ptr) {\n      iVar1 = recv_bytes(0,rx_buf,0x1c);\n      if (iVar1 != 0) {\n        return iVar1;\n      }\n      rx_buf_cursor = rx_buf;\n    }\n    memcpy(param_1,rx_buf_cursor,0x1c);\n    rx_buf_cursor = (undefined1 *)((int)rx_buf_cursor + 0x1c);\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "packet_recv",
                        "recv_bytes",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "packet_recv",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "do_normal",
                "func_c_signature": "undefined4 do_normal(int param_1,undefined4 *param_2)",
                "decompiled_code": "undefined4 do_normal(int param_1,undefined4 *param_2) {\n  char cVar1;\n  undefined4 uVar2;\n  \n  if (*(int *)(param_1 + 0xc) == 0) {\n    if ((*(int *)(param_1 + 0x10) == 1) &&\n       (cVar1 = access_check(*(undefined4 *)(param_1 + 0x18),0x4347c000,0x4347d000), cVar1 == '\\x01'\n       )) {\n      *param_2 = 2;\n      return 0;\n    }\n    if (*(int *)(param_1 + 0x10) == 0) {\n      uVar2 = *(undefined4 *)(param_1 + 0x18);\n    }\n    else {\n      uVar2 = **(undefined4 **)(param_1 + 0x18);\n    }\n    param_2[5] = uVar2;\n  }\n  else {\n    if (*(int *)(param_1 + 0x10) != 0) {\n      *param_2 = 2;\n      return 0;\n    }\n    cVar1 = access_check(*(undefined4 *)(param_1 + 0x14),0x8048000,0x8146000);\n    if ((cVar1 == '\\0') &&\n       (cVar1 = access_check(*(undefined4 *)(param_1 + 0x14),0x8146000,0x816b000), cVar1 == '\\0')) {\n      *param_2 = 2;\n      return 0;\n    }\n    **(undefined4 **)(param_1 + 0x14) = *(undefined4 *)(param_1 + 0x18);\n  }\n  *param_2 = 1;\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_normal",
                        "access_check"
                    ],
                    "calling_functions": [
                        "do_normal"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "do_scratch",
                "func_c_signature": "undefined4 do_scratch(int param_1,undefined4 *param_2)",
                "decompiled_code": "undefined4 do_scratch(int param_1,undefined4 *param_2) {\n  char cVar1;\n  undefined4 uVar2;\n  int local_10;\n  int local_c;\n  \n  local_c = 0;\n  local_10 = 0;\n  if ((*(int *)(param_1 + 0xc) != 0) || (*(int *)(param_1 + 0x10) != 0)) {\n    if ((*(int *)(param_1 + 0xc) == 0) && (*(int *)(param_1 + 0x10) == 1)) {\n      local_c = *(int *)(param_1 + 0x18);\n    }\n    else if ((*(int *)(param_1 + 0xc) == 1) && (*(int *)(param_1 + 0x10) == 0)) {\n      local_c = *(int *)(param_1 + 0x14);\n    }\n    else {\n      if (*(int *)(param_1 + 0xc) != 1) {\n        return 0;\n      }\n      if (*(int *)(param_1 + 0x10) != 1) {\n        return 0;\n      }\n      local_c = *(int *)(param_1 + 0x18);\n      local_10 = *(int *)(param_1 + 0x14);\n    }\n  }\n  if ((local_c != 0) &&\n     (cVar1 = access_check(local_c,buf_scratch,buf_scratch + 0x1000), cVar1 == '\\0')) {\n    *param_2 = 2;\n    return 0;\n  }\n  if ((local_10 != 0) &&\n     (cVar1 = access_check(local_10,buf_scratch,buf_scratch + 0x1000), cVar1 == '\\0')) {\n    *param_2 = 2;\n    return 0;\n  }\n  if (*(int *)(param_1 + 0xc) == 0) {\n    if (*(int *)(param_1 + 0x10) == 0) {\n      uVar2 = *(undefined4 *)(param_1 + 0x18);\n    }\n    else {\n      uVar2 = **(undefined4 **)(param_1 + 0x18);\n    }\n    param_2[5] = uVar2;\n  }\n  else {\n    if (*(int *)(param_1 + 0x10) == 0) {\n      uVar2 = *(undefined4 *)(param_1 + 0x18);\n    }\n    else {\n      uVar2 = **(undefined4 **)(param_1 + 0x18);\n    }\n    **(undefined4 **)(param_1 + 0x14) = uVar2;\n  }\n  *param_2 = 1;\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_scratch",
                        "access_check"
                    ],
                    "calling_functions": [
                        "do_scratch"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "do_static",
                "func_c_signature": "undefined4 do_static(int param_1,undefined4 *param_2)",
                "decompiled_code": "undefined4 do_static(int param_1,undefined4 *param_2) {\n  undefined4 uVar1;\n  \n  if (*(int *)(param_1 + 0xc) == 0) {\n    if (*(uint *)(param_1 + 0x18) < 0xfffd) {\n      uVar1 = static_switch(*(uint *)(param_1 + 0x18));\n      param_2[5] = uVar1;\n      *param_2 = 1;\n    }\n    else {\n      *param_2 = 2;\n    }\n  }\n  else {\n    *param_2 = 2;\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_static",
                        "static_switch"
                    ],
                    "calling_functions": [
                        "do_static"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "bad_request",
                "func_c_signature": "undefined4 bad_request(undefined4 param_1,undefined4 *param_2)",
                "decompiled_code": "undefined4 bad_request(undefined4 param_1,undefined4 *param_2) {\n  *param_2 = 2;\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "bad_request"
                    ],
                    "calling_functions": [
                        "bad_request"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "init",
                "func_c_signature": "int init(EVP_PKEY_CTX *ctx)",
                "decompiled_code": "int init(EVP_PKEY_CTX *ctx) {\n  int iVar1;\n  \n  rx_buf_cursor = &func_ptr;\n  iVar1 = allocate(0x1000,1,&buf_scratch);\n  return iVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "init",
                        "allocate"
                    ],
                    "calling_functions": [
                        "init",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "int main(void)",
                "decompiled_code": "int main(void) {\n  int iVar1;\n  EVP_PKEY_CTX *in_stack_ffffffa0;\n  undefined4 local_4c;\n  undefined4 local_48;\n  int local_30;\n  undefined4 local_2c;\n  uint local_28;\n  int local_24;\n  int local_20;\n  int local_14;\n  undefined *local_10;\n  \n  local_10 = &stack0x00000004;\n  local_14 = 0;\n  local_14 = init(in_stack_ffffffa0);\n  if (local_14 == 0) {\n    while( true ) {\n      func_ptr = 0xdeadbeef;\n      DAT_0007d038 = 0xaaaaaaaa;\n      local_14 = packet_recv(&local_30);\n      if ((local_14 != 0) || (local_30 == 3)) break;\n      memset(&local_4c,0,0x1c);\n      local_48 = local_2c;\n      if (((local_30 == 0) && ((local_24 == 0 || (local_24 == 1)))) &&\n         ((local_20 == 0 || (local_20 == 1)))) {\n        if (local_28 != 3) {\n          if (local_28 < 4) {\n            if (local_28 == 2) {\n              DAT_0007d034 = do_static;\n            }\n            else {\n              if (2 < local_28) goto LAB_000115b0;\n              if (local_28 == 0) {\n                DAT_0007d034 = do_normal;\n              }\n              else {\n                if (local_28 != 1) goto LAB_000115b0;\n                DAT_0007d034 = do_scratch;\n              }\n            }\n          }\n          else {\nLAB_000115b0:\n            DAT_0007d034 = bad_request;\n          }\n        }\n        local_14 = (*DAT_0007d034)(&local_30,&local_4c);\n        if (local_14 != 0) {\n          return local_14;\n        }\n      }\n      else {\n        local_4c = 2;\n      }\n      iVar1 = packet_send(&local_4c);\n      if (iVar1 != 0) {\n        return iVar1;\n      }\n      local_14 = 0;\n    }\n  }\n  return local_14;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "init",
                        "packet_recv",
                        "memset",
                        "packet_send"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            }
        ],
        "switch.c": [
            {
                "func_name": "static_switch",
                "func_c_signature": "undefined4 static_switch(uint param_1)",
                "decompiled_code": "undefined4 static_switch(uint param_1) {\n  undefined4 uVar1;\n  \n  if (param_1 < 0xfffd) {\n                    /* WARNING: Could not recover jumptable at 0x0001195b. Too many branches */\n                    /* WARNING: Treating indirect jump as call */\n    uVar1 = (*(code *)((int)&_GLOBAL_OFFSET_TABLE_ + *(int *)(&DAT_0003b000 + param_1 * 4)))();\n    return uVar1;\n  }\n  return 0xdeadbeef;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "static_switch"
                    ],
                    "calling_functions": [
                        "do_static",
                        "static_switch"
                    ],
                    "defined_in_file": "NRFIN_00051_decompiled.c"
                }
            }
        ]
    }
}