{
    "file": "CROMU_00097",
    "decompiled_code": {
        "application.c": [
            {
                "func_name": "msls_handle_application",
                "func_c_signature": "void msls_handle_application(undefined4 param_1,undefined4 param_2,int param_3)",
                "decompiled_code": "void msls_handle_application(undefined4 param_1,undefined4 param_2,int param_3) {\n  uint uVar1;\n  size_t __size;\n  undefined4 uVar2;\n  byte *pbVar3;\n  undefined2 *puVar4;\n  undefined *puVar5;\n  char *pcVar6;\n  uint uVar7;\n  \n  debug_print(\"Handling Application Message ($d)\\n\",*(undefined2 *)(param_3 + 0x10));\n  if (2 < *(ushort *)(param_3 + 0x10)) {\n    pbVar3 = *(byte **)(param_3 + 0x14);\n    uVar7 = (uint)*(ushort *)(pbVar3 + 1);\n    uVar1 = (uint)*pbVar3;\n    debug_print(\"Type: $d Len: $d\\n\",uVar1,uVar7);\n    switch(*pbVar3) {\n    case 0xa0:\n      debug_print(\"APP: List Board\\n\",uVar1,uVar7);\n      puVar4 = (undefined2 *)calloc(0x18,uVar1);\n      puVar5 = (undefined *)calloc(7,uVar1);\n      pcVar6 = (char *)calloc(0x80,uVar1);\n      *(undefined *)(puVar4 + 2) = 4;\n      puVar4[1] = 0xff01;\n      *(undefined4 *)(puVar4 + 6) = *(undefined4 *)(param_3 + 0xc);\n      *(undefined **)(puVar4 + 10) = puVar5;\n      *puVar4 = 0x92;\n      puVar4[8] = 0x83;\n      *puVar5 = 0xaa;\n      *(undefined2 *)(puVar5 + 1) = 0x80;\n      *(char **)(puVar5 + 3) = pcVar6;\n      sprintf(pcVar6,\"$d of $d slots filled\\n\",numMessages,0x40);\n      msls_encrypt(*(undefined4 *)(puVar5 + 3),*(undefined2 *)(puVar5 + 1),param_2);\n      msls_send_msg(puVar4);\n      msls_destroy_msg(puVar4);\n      break;\n    case 0xa1:\n      if (0x7f < *(ushort *)(pbVar3 + 1)) {\n        msls_decrypt(pbVar3 + 3,*(undefined2 *)(pbVar3 + 1),param_2);\n        uVar2 = post_new_message(pbVar3 + 3);\n        __size = numMessages - 1;\n        debug_print(\"Posting to slot $d\\n\");\n        puVar4 = (undefined2 *)calloc(0x18,__size);\n        puVar5 = (undefined *)calloc(7,__size);\n        pcVar6 = (char *)calloc(0x80,__size);\n        *(undefined *)(puVar4 + 2) = 4;\n        puVar4[1] = 0xff01;\n        *(undefined4 *)(puVar4 + 6) = *(undefined4 *)(param_3 + 0xc);\n        *(undefined **)(puVar4 + 10) = puVar5;\n        *puVar4 = 0x92;\n        puVar4[8] = 0x83;\n        *puVar5 = 0xaa;\n        *(undefined2 *)(puVar5 + 1) = 0x80;\n        *(char **)(puVar5 + 3) = pcVar6;\n        sprintf(pcVar6,\"POST returned: $d\\n\",uVar2);\n        msls_encrypt(*(undefined4 *)(puVar5 + 3),*(undefined2 *)(puVar5 + 1),param_2);\n        msls_send_msg(puVar4);\n        msls_destroy_msg(puVar4);\n      }\n      break;\n    case 0xa2:\n      if (*(short *)(pbVar3 + 1) != 0) {\n        msls_decrypt(pbVar3 + 3,*(undefined2 *)(pbVar3 + 1),param_2);\n        uVar2 = delete_message(pbVar3[3]);\n        uVar1 = (uint)pbVar3[3];\n        debug_print(\"Deleting message $d\\n\");\n        puVar4 = (undefined2 *)calloc(0x18,uVar1);\n        puVar5 = (undefined *)calloc(7,uVar1);\n        pcVar6 = (char *)calloc(0x80,uVar1);\n        *(undefined *)(puVar4 + 2) = 4;\n        puVar4[1] = 0xff01;\n        *(undefined4 *)(puVar4 + 6) = *(undefined4 *)(param_3 + 0xc);\n        *(undefined **)(puVar4 + 10) = puVar5;\n        *puVar4 = 0x92;\n        puVar4[8] = 0x83;\n        *puVar5 = 0xaa;\n        *(undefined2 *)(puVar5 + 1) = 0x80;\n        *(char **)(puVar5 + 3) = pcVar6;\n        sprintf(pcVar6,\"DELETE returned: $d\\n\",uVar2);\n        msls_encrypt(*(undefined4 *)(puVar5 + 3),*(undefined2 *)(puVar5 + 1),param_2);\n        msls_send_msg(puVar4);\n        msls_destroy_msg(puVar4);\n      }\n      break;\n    case 0xa3:\n      clear_message_board();\n      puVar4 = (undefined2 *)calloc(0x18,uVar1);\n      puVar5 = (undefined *)calloc(7,uVar1);\n      pcVar6 = (char *)calloc(0x80,uVar1);\n      *(undefined *)(puVar4 + 2) = 4;\n      puVar4[1] = 0xff01;\n      *(undefined4 *)(puVar4 + 6) = *(undefined4 *)(param_3 + 0xc);\n      *(undefined **)(puVar4 + 10) = puVar5;\n      *puVar4 = 0x92;\n      puVar4[8] = 0x83;\n      *puVar5 = 0xaa;\n      *(undefined2 *)(puVar5 + 1) = 0x80;\n      *(char **)(puVar5 + 3) = pcVar6;\n      sprintf(pcVar6,\"Cleared Board\\n\",numMessages,0x40);\n      msls_encrypt(*(undefined4 *)(puVar5 + 3),*(undefined2 *)(puVar5 + 1),param_2);\n      msls_send_msg(puVar4);\n      msls_destroy_msg(puVar4);\n      break;\n    case 0xa4:\n      if (*(short *)(pbVar3 + 1) != 0) {\n        msls_decrypt(pbVar3 + 3,*(undefined2 *)(pbVar3 + 1),param_2);\n        pbVar3 = pbVar3 + 3;\n        uVar1 = (uint)*pbVar3;\n        debug_print(\"Reading slot $d\\n\");\n        puVar4 = (undefined2 *)calloc(0x18,uVar1);\n        puVar5 = (undefined *)calloc(7,uVar1);\n        pcVar6 = (char *)calloc(0x80,uVar1);\n        *(undefined *)(puVar4 + 2) = 4;\n        puVar4[1] = 0xff01;\n        *(undefined4 *)(puVar4 + 6) = *(undefined4 *)(param_3 + 0xc);\n        *(undefined **)(puVar4 + 10) = puVar5;\n        *puVar4 = 0x92;\n        puVar4[8] = 0x83;\n        *puVar5 = 0xaa;\n        *(undefined2 *)(puVar5 + 1) = 0x80;\n        *(char **)(puVar5 + 3) = pcVar6;\n        if (*pbVar3 < 0x40) {\n          memcpy(pcVar6,APPLICATION_MSG_BOARD + (uint)*pbVar3 * 0x80,0x80);\n        }\n        else {\n          sprintf(pcVar6,\"INVALID MESSAGE\");\n        }\n        msls_encrypt(*(undefined4 *)(puVar5 + 3),*(undefined2 *)(puVar5 + 1),param_2);\n        msls_send_msg(puVar4);\n        msls_destroy_msg(puVar4);\n      }\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [
                    "Message"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_handle_application",
                        "debug_print",
                        "Message",
                        "calloc",
                        "sprintf",
                        "msls_encrypt",
                        "msls_send_msg",
                        "msls_destroy_msg",
                        "msls_decrypt",
                        "post_new_message",
                        "delete_message",
                        "clear_message_board",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "msls_handle_application"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "clear_message_board",
                "func_c_signature": "void clear_message_board(void)",
                "decompiled_code": "void clear_message_board(void) {\n  memset(APPLICATION_MSG_BOARD,0,0x2000);\n  numMessages = 0;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "clear_message_board",
                        "memset"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "clear_message_board"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "delete_message",
                "func_c_signature": "undefined4 delete_message(byte param_1)",
                "decompiled_code": "undefined4 delete_message(byte param_1) {\n  undefined4 uVar1;\n  uint local_10;\n  \n  if (param_1 < 0x40) {\n    memset(APPLICATION_MSG_BOARD + (uint)param_1 * 0x80,0,0x80);\n    for (local_10 = (uint)param_1; (int)local_10 < 0x3f; local_10 = local_10 + 1) {\n      memcpy(APPLICATION_MSG_BOARD + local_10 * 0x80,APPLICATION_MSG_BOARD + (local_10 + 1) * 0x80,\n             0x80);\n    }\n    numMessages = numMessages + -1;\n    uVar1 = 1;\n  }\n  else {\n    uVar1 = 0xffffffff;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "delete_message",
                        "memset",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "delete_message"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "post_new_message",
                "func_c_signature": "undefined4 post_new_message(void *param_1)",
                "decompiled_code": "undefined4 post_new_message(void *param_1) {\n  undefined4 uVar1;\n  \n  if (numMessages < 0x40) {\n    memcpy(APPLICATION_MSG_BOARD + numMessages * 0x80,param_1,0x80);\n    numMessages = numMessages + 1;\n    uVar1 = 1;\n  }\n  else {\n    uVar1 = 0xffffffff;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "post_new_message",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "post_new_message"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            }
        ],
        "msls.c": [
            {
                "func_name": "get_random",
                "func_c_signature": "uint get_random(void)",
                "decompiled_code": "uint get_random(void) {\n  uint uVar1;\n  uint *puVar2;\n  uint *puVar3;\n  \n  uVar1 = *pRandom;\n  puVar2 = pRandom + 1;\n  puVar3 = pRandom + 4;\n  pRandom = pRandom + 2;\n  if ((uint *)0x4347cfff < puVar3) {\n    pRandom = (uint *)&DAT_4347c800;\n  }\n  return *puVar2 ^ uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_random"
                    ],
                    "calling_functions": [
                        "get_random",
                        "msls_handle_handshake",
                        "msls_send_server_hello"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_get_sls_functions",
                "func_c_signature": "code ** msls_get_sls_functions(void)",
                "decompiled_code": "code ** msls_get_sls_functions(void) {\n  code **ppcVar1;\n  size_t in_stack_ffffffd8;\n  \n  ppcVar1 = (code **)calloc(0x3c,in_stack_ffffffd8);\n  *ppcVar1 = msls_receive_msg;\n  ppcVar1[1] = msls_send_msg;\n  ppcVar1[2] = msls_cleanup;\n  ppcVar1[3] = msls_version_check;\n  ppcVar1[4] = msls_send_error_msg;\n  ppcVar1[5] = msls_generate_checksum;\n  ppcVar1[6] = msls_handle_heartbeat;\n  ppcVar1[7] = msls_destroy_msg;\n  ppcVar1[8] = msls_handle_handshake;\n  ppcVar1[9] = msls_get_connection;\n  ppcVar1[10] = msls_set_cookie;\n  ppcVar1[0xb] = msls_lookup_context;\n  ppcVar1[0xc] = msls_handle_application;\n  ppcVar1[0xd] = msls_handle_changespec;\n  ppcVar1[0xe] = msls_handle_error;\n  return ppcVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_get_sls_functions",
                        "calloc"
                    ],
                    "calling_functions": [
                        "msls_get_sls_functions",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_receive_msg",
                "func_c_signature": "ushort * msls_receive_msg(int param_1)",
                "decompiled_code": "ushort * msls_receive_msg(int param_1) {\n  ushort *puVar1;\n  void *pvVar2;\n  int iVar3;\n  size_t in_stack_ffffffd8;\n  size_t __size;\n  \n  debug_print(\"Receive MSG\\n\");\n  puVar1 = (ushort *)calloc(0x18,in_stack_ffffffd8);\n  receive_fixed(puVar1,2);\n  debug_print(\"msg length: $d\\n\",*puVar1);\n  if ((*puVar1 < 0xf) || (0x800 < *puVar1)) {\n    (**(code **)(*(int *)(param_1 + 4) + 0x10))(0xe0,0xa1);\n  }\n  else {\n    receive_fixed(puVar1 + 1,2);\n    receive_fixed(puVar1 + 2,1);\n    receive_fixed(puVar1 + 4,4);\n    receive_fixed(puVar1 + 6,4);\n    __size = 2;\n    receive_fixed(puVar1 + 8);\n    if ((uint)puVar1[8] == *puVar1 - 0xf) {\n      if (puVar1[8] != 0) {\n        pvVar2 = calloc((uint)puVar1[8],__size);\n        *(void **)(puVar1 + 10) = pvVar2;\n        receive_fixed(*(undefined4 *)(puVar1 + 10),puVar1[8]);\n      }\n      iVar3 = (**(code **)(*(int *)(param_1 + 4) + 0xc))(puVar1[1]);\n      if (iVar3 == 0) {\n        (**(code **)(*(int *)(param_1 + 4) + 0x10))(0xe1,0xa1);\n      }\n      else {\n        iVar3 = (**(code **)(*(int *)(param_1 + 4) + 0x14))(puVar1);\n        if (iVar3 == *(int *)(puVar1 + 4)) {\n          return puVar1;\n        }\n        (**(code **)(*(int *)(param_1 + 4) + 0x10))(0xe2,0xa1);\n      }\n    }\n    else {\n      debug_print(\"Length: $d expected: $d received: $d\\n\",*puVar1,*puVar1 - 0xf,puVar1[8]);\n      (**(code **)(*(int *)(param_1 + 4) + 0x10))(0xe0,0xa1);\n    }\n  }\n  msls_destroy_msg(puVar1);\n  return (ushort *)0x0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_receive_msg",
                        "debug_print",
                        "calloc",
                        "receive_fixed",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_receive_msg"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_msg",
                "func_c_signature": "undefined4 msls_send_msg(int param_1)",
                "decompiled_code": "undefined4 msls_send_msg(int param_1) {\n  int iVar1;\n  undefined4 uVar2;\n  \n  if (param_1 == 0) {\n    uVar2 = 0xffffffff;\n  }\n  else {\n    uVar2 = msls_generate_checksum_outgoing(param_1);\n    *(undefined4 *)(param_1 + 8) = uVar2;\n    debug_print(\"Send MSG\\n\");\n    transmit_fixed(param_1,2);\n    transmit_fixed(param_1 + 2,2);\n    transmit_fixed(param_1 + 4,1);\n    transmit_fixed(param_1 + 8,4);\n    transmit_fixed(param_1 + 0xc,4);\n    transmit_fixed(param_1 + 0x10,2);\n    if (*(short *)(param_1 + 0x10) != 0) {\n      switch(*(undefined *)(param_1 + 4)) {\n      case 2:\n        transmit_fixed(*(undefined4 *)(param_1 + 0x14),*(undefined2 *)(param_1 + 0x10));\n        break;\n      case 3:\n        iVar1 = *(int *)(param_1 + 0x14);\n        if (((iVar1 != 0) && (transmit_fixed(iVar1,0xc), *(short *)(iVar1 + 10) != 0)) &&\n           (*(int *)(iVar1 + 0xc) != 0)) {\n          transmit_fixed(*(undefined4 *)(iVar1 + 0xc),*(undefined2 *)(iVar1 + 10));\n        }\n        break;\n      case 4:\n        iVar1 = *(int *)(param_1 + 0x14);\n        transmit_fixed(iVar1,1);\n        transmit_fixed(iVar1 + 1,2);\n        if ((*(short *)(iVar1 + 1) != 0) && (*(int *)(iVar1 + 3) != 0)) {\n          transmit_fixed(*(undefined4 *)(iVar1 + 3),*(undefined2 *)(iVar1 + 1));\n        }\n        break;\n      case 5:\n        iVar1 = *(int *)(param_1 + 0x14);\n        if (iVar1 != 0) {\n          transmit_fixed(iVar1,1);\n          transmit_fixed(iVar1 + 1,2);\n          if ((*(short *)(iVar1 + 1) != 0) && (*(int *)(iVar1 + 3) != 0)) {\n            transmit_fixed(*(undefined4 *)(iVar1 + 3),*(undefined2 *)(iVar1 + 1));\n          }\n        }\n      }\n    }\n    uVar2 = 0;\n  }\n  return uVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_msg",
                        "msls_generate_checksum_outgoing",
                        "debug_print",
                        "transmit_fixed"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "msls_send_msg",
                        "msls_cleanup",
                        "msls_send_error_msg",
                        "msls_handle_heartbeat",
                        "msls_send_hello_verify",
                        "msls_send_server_hello",
                        "msls_send_keyx",
                        "msls_send_hello_done",
                        "msls_send_finish"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_cleanup",
                "func_c_signature": "void msls_cleanup(int param_1)",
                "decompiled_code": "void msls_cleanup(int param_1) {\n  undefined2 *__ptr;\n  size_t in_stack_ffffffd8;\n  int local_10;\n  \n  debug_print(\"Exiting\\n\");\n  __ptr = (undefined2 *)calloc(0x18,in_stack_ffffffd8);\n  *(undefined *)(__ptr + 2) = 6;\n  __ptr[1] = 0xff01;\n  *__ptr = 0xf;\n  msls_send_msg(__ptr);\n  free(__ptr);\n  for (local_10 = 0; local_10 < 0x20; local_10 = local_10 + 1) {\n    destroy_context(*(undefined4 *)(param_1 + 8 + local_10 * 4));\n  }\n  free(*(void **)(param_1 + 0x88));\n  free(*(void **)(param_1 + 4));\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_cleanup",
                        "debug_print",
                        "calloc",
                        "msls_send_msg",
                        "free",
                        "destroy_context"
                    ],
                    "calling_functions": [
                        "msls_cleanup"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_version_check",
                "func_c_signature": "bool msls_version_check(short param_1)",
                "decompiled_code": "bool msls_version_check(short param_1) {\n  return param_1 == -0xff;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_version_check"
                    ],
                    "calling_functions": [
                        "msls_version_check"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_destroy_msg",
                "func_c_signature": "void msls_destroy_msg(void *param_1)",
                "decompiled_code": "void msls_destroy_msg(void *param_1) {\n  int iVar1;\n  void *pvVar2;\n  \n  if (param_1 != (void *)0x0) {\n    switch(*(undefined *)((int)param_1 + 4)) {\n    case 2:\n      free(*(void **)((int)param_1 + 0x14));\n      break;\n    case 3:\n      pvVar2 = *(void **)((int)param_1 + 0x14);\n      if (pvVar2 != (void *)0x0) {\n        free(*(void **)((int)pvVar2 + 0xc));\n        free(pvVar2);\n      }\n      break;\n    case 4:\n      iVar1 = *(int *)((int)param_1 + 0x14);\n      if ((*(short *)(iVar1 + 1) != 0) && (*(int *)(iVar1 + 3) != 0)) {\n        free(*(void **)(iVar1 + 3));\n      }\n      break;\n    case 5:\n      pvVar2 = *(void **)((int)param_1 + 0x14);\n      if (pvVar2 != (void *)0x0) {\n        free(*(void **)((int)pvVar2 + 3));\n        free(pvVar2);\n      }\n    }\n    free(param_1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_destroy_msg",
                        "free"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "msls_receive_msg",
                        "msls_destroy_msg",
                        "msls_send_error_msg",
                        "msls_handle_heartbeat",
                        "msls_send_hello_verify",
                        "msls_send_server_hello",
                        "msls_send_keyx",
                        "msls_send_hello_done",
                        "msls_send_finish"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_encrypt",
                "func_c_signature": "void msls_encrypt(int param_1,uint param_2,int param_3)",
                "decompiled_code": "void msls_encrypt(int param_1,uint param_2,int param_3) {\n  uint local_10;\n  int local_c;\n  \n  local_c = 0;\n  for (local_10 = 0; local_10 < param_2; local_10 = local_10 + 1) {\n    *(byte *)(param_1 + local_10) =\n         *(byte *)(param_1 + local_10) ^\n         (byte)*(undefined4 *)(*(int *)(param_3 + 0x14) + local_c * 4) ^\n         (byte)*(undefined4 *)(*(int *)(param_3 + 0x20) + local_c * 4);\n    local_c = local_c + 1;\n    if (0x7f < local_c) {\n      local_c = 0;\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_encrypt"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "msls_encrypt"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_decrypt",
                "func_c_signature": "void msls_decrypt(int param_1,uint param_2,int param_3)",
                "decompiled_code": "void msls_decrypt(int param_1,uint param_2,int param_3) {\n  uint local_10;\n  int local_c;\n  \n  local_c = 0;\n  for (local_10 = 0; local_10 < param_2; local_10 = local_10 + 1) {\n    *(byte *)(param_1 + local_10) =\n         *(byte *)(param_1 + local_10) ^\n         (byte)*(undefined4 *)(*(int *)(param_3 + 0x18) + local_c * 4) ^\n         (byte)*(undefined4 *)(*(int *)(param_3 + 0x1c) + local_c * 4);\n    local_c = local_c + 1;\n    if (0x7f < local_c) {\n      local_c = 0;\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_decrypt"
                    ],
                    "calling_functions": [
                        "msls_handle_application",
                        "msls_decrypt"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_error_msg",
                "func_c_signature": "void msls_send_error_msg(ushort param_1,undefined param_2)",
                "decompiled_code": "void msls_send_error_msg(ushort param_1,undefined param_2) {\n  uint __size;\n  short *psVar1;\n  ushort *puVar2;\n  \n  __size = (uint)param_1;\n  debug_print(\"Error: $x\\n\");\n  psVar1 = (short *)calloc(0x18,__size);\n  *(undefined *)(psVar1 + 2) = 2;\n  puVar2 = (ushort *)calloc(3,__size);\n  *puVar2 = param_1;\n  *(undefined *)(puVar2 + 1) = param_2;\n  *(ushort **)(psVar1 + 10) = puVar2;\n  psVar1[8] = 3;\n  *psVar1 = psVar1[8] + 0xf;\n  msls_send_msg(psVar1);\n  msls_destroy_msg(psVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_error_msg",
                        "debug_print",
                        "calloc",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_send_error_msg",
                        "msls_handle_handshake"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_generate_checksum",
                "func_c_signature": "uint msls_generate_checksum(int param_1)",
                "decompiled_code": "uint msls_generate_checksum(int param_1) {\n  int local_c;\n  uint local_8;\n  \n  local_8 = 0;\n  for (local_c = 0; local_c < (int)(uint)*(ushort *)(param_1 + 0x10); local_c = local_c + 1) {\n    local_8 = (uint)*(byte *)(local_c + *(int *)(param_1 + 0x14)) ^ (local_8 << 8 | local_8 >> 0x18)\n    ;\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_generate_checksum"
                    ],
                    "calling_functions": [
                        "msls_generate_checksum"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_generate_checksum_outgoing",
                "func_c_signature": "uint msls_generate_checksum_outgoing(int param_1)",
                "decompiled_code": "uint msls_generate_checksum_outgoing(int param_1) {\n  int iVar1;\n  int local_24;\n  int local_20;\n  int local_1c;\n  int local_18;\n  int local_14;\n  int local_10;\n  int local_c;\n  uint local_8;\n  \n  local_8 = 0;\n  switch(*(undefined *)(param_1 + 4)) {\n  case 1:\n  case 2:\n  case 6:\n    for (local_c = 0; local_c < (int)(uint)*(ushort *)(param_1 + 0x10); local_c = local_c + 1) {\n      local_8 = (uint)*(byte *)(local_c + *(int *)(param_1 + 0x14)) ^\n                (local_8 << 8 | local_8 >> 0x18);\n    }\n    break;\n  case 3:\n    iVar1 = *(int *)(param_1 + 0x14);\n    if (iVar1 != 0) {\n      for (local_20 = 0; local_20 < 0xc; local_20 = local_20 + 1) {\n        local_8 = (uint)*(byte *)(local_20 + *(int *)(param_1 + 0x14)) ^\n                  (local_8 << 8 | local_8 >> 0x18);\n      }\n      for (local_24 = 0; local_24 < (int)(uint)*(ushort *)(iVar1 + 10); local_24 = local_24 + 1) {\n        local_8 = (uint)*(byte *)(local_24 + *(int *)(iVar1 + 0xc)) ^\n                  (local_8 << 8 | local_8 >> 0x18);\n      }\n    }\n    break;\n  case 4:\n    iVar1 = *(int *)(param_1 + 0x14);\n    if (iVar1 != 0) {\n      for (local_10 = 0; local_10 < 3; local_10 = local_10 + 1) {\n        local_8 = (uint)*(byte *)(local_10 + *(int *)(param_1 + 0x14)) ^\n                  (local_8 << 8 | local_8 >> 0x18);\n      }\n      for (local_14 = 0; local_14 < (int)(uint)*(ushort *)(iVar1 + 1); local_14 = local_14 + 1) {\n        local_8 = (uint)*(byte *)(local_14 + *(int *)(iVar1 + 3)) ^ (local_8 << 8 | local_8 >> 0x18)\n        ;\n      }\n    }\n    break;\n  case 5:\n    iVar1 = *(int *)(param_1 + 0x14);\n    if (iVar1 != 0) {\n      for (local_18 = 0; local_18 < 3; local_18 = local_18 + 1) {\n        local_8 = (uint)*(byte *)(local_18 + *(int *)(param_1 + 0x14)) ^\n                  (local_8 << 8 | local_8 >> 0x18);\n      }\n      for (local_1c = 0; local_1c < (int)(uint)*(ushort *)(iVar1 + 1); local_1c = local_1c + 1) {\n        local_8 = (uint)*(byte *)(local_1c + *(int *)(iVar1 + 3)) ^ (local_8 << 8 | local_8 >> 0x18)\n        ;\n      }\n    }\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_generate_checksum_outgoing"
                    ],
                    "calling_functions": [
                        "msls_send_msg",
                        "msls_generate_checksum_outgoing"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            }
        ],
        "msls_handlers.c": [
            {
                "func_name": "msls_handle_heartbeat",
                "func_c_signature": "void msls_handle_heartbeat(int param_1)",
                "decompiled_code": "void msls_handle_heartbeat(int param_1) {\n  short *psVar1;\n  undefined *puVar2;\n  void *__src;\n  void *pvVar3;\n  size_t in_stack_ffffffd8;\n  \n  debug_print(\"Handling Heartbeat\\n\");\n  psVar1 = (short *)calloc(0x18,in_stack_ffffffd8);\n  puVar2 = (undefined *)calloc(7,in_stack_ffffffd8);\n  *(undefined *)(psVar1 + 2) = 5;\n  psVar1[1] = -0xff;\n  *(undefined4 *)(psVar1 + 6) = *(undefined4 *)(param_1 + 0xc);\n  *puVar2 = 0x42;\n  __src = (void *)(*(int *)(param_1 + 0x14) + 3);\n  *(undefined2 *)(puVar2 + 1) = *(undefined2 *)(*(int *)(param_1 + 0x14) + 1);\n  if (*(short *)(puVar2 + 1) != 0) {\n    pvVar3 = calloc((uint)*(ushort *)(puVar2 + 1),in_stack_ffffffd8);\n    *(void **)(puVar2 + 3) = pvVar3;\n    debug_print(\"Reading heartbeats from $x to $x\\n\",__src,\n                (int)__src + (uint)*(ushort *)(puVar2 + 1));\n    memcpy(*(void **)(puVar2 + 3),__src,(uint)*(ushort *)(puVar2 + 1));\n  }\n  psVar1[8] = *(short *)(puVar2 + 1) + 3;\n  *(undefined **)(psVar1 + 10) = puVar2;\n  *psVar1 = psVar1[8] + 0xf;\n  debug_print(\"Sending HB response. Length: $d\\n\",*(undefined2 *)(puVar2 + 1));\n  msls_send_msg(psVar1);\n  msls_destroy_msg(psVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_handle_heartbeat",
                        "debug_print",
                        "calloc",
                        "memcpy",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_handle_heartbeat"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_handle_changespec",
                "func_c_signature": "undefined ** msls_handle_changespec(undefined4 param_1,int param_2,int param_3)",
                "decompiled_code": "undefined ** msls_handle_changespec(undefined4 param_1,int param_2,int param_3) {\n  undefined **ppuVar1;\n  \n  ppuVar1 = &_GLOBAL_OFFSET_TABLE_;\n  if ((*(undefined2 **)(param_3 + 0x14) != (undefined2 *)0x0) && (param_2 != 0)) {\n    *(undefined2 *)(param_2 + 0x10) = **(undefined2 **)(param_3 + 0x14);\n    ppuVar1 = (undefined **)msls_send_server_hello(param_2);\n  }\n  return ppuVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_handle_changespec",
                        "msls_send_server_hello"
                    ],
                    "calling_functions": [
                        "msls_handle_changespec"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_handle_error",
                "func_c_signature": "void msls_handle_error(int param_1,int param_2)",
                "decompiled_code": "void msls_handle_error(int param_1,int param_2) {\n  byte bVar1;\n  undefined2 *puVar2;\n  int iVar3;\n  \n  iVar3 = (**(code **)(*(int *)(param_1 + 4) + 0x2c))(param_1,*(undefined4 *)(param_2 + 0xc));\n  puVar2 = *(undefined2 **)(param_2 + 0x14);\n  if (puVar2 != (undefined2 *)0x0) {\n    bVar1 = *(byte *)(puVar2 + 1);\n    if (bVar1 == 0xa2) {\n      debug_print(\"Received Fatal Error $x. Shutting down server\\n\",*puVar2);\n      *(undefined *)(param_1 + 1) = 1;\n    }\n    else {\n      if (bVar1 < 0xa3) {\n        if (bVar1 == 0xa0) {\n          debug_print(\"Received Client Warning $x\\n\",*puVar2);\n          return;\n        }\n        if (bVar1 == 0xa1) {\n          if (iVar3 == 0) {\n            return;\n          }\n          debug_print(\"Received Critical Error $x. Shutting down connection.\\n\",*puVar2);\n          *(undefined *)(iVar3 + 0xc) = 0;\n          return;\n        }\n      }\n      debug_print(\"Unknown Error Code $x $x\\n\",*puVar2,*(undefined *)(puVar2 + 1));\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_handle_error",
                        "debug_print"
                    ],
                    "calling_functions": [
                        "msls_handle_error"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            }
        ],
        "msls_handshake.c": [
            {
                "func_name": "msls_handle_handshake",
                "func_c_signature": "void msls_handle_handshake(int param_1,int param_2)",
                "decompiled_code": "void msls_handle_handshake(int param_1,int param_2) {\n  ushort uVar1;\n  int iVar2;\n  int iVar3;\n  uint uVar4;\n  ushort *puVar5;\n  void *pvVar6;\n  size_t __size;\n  ushort *__size_00;\n  int local_18;\n  int local_14;\n  int local_10;\n  \n  if ((param_1 != 0) && (param_2 != 0)) {\n    if (*(ushort *)(param_2 + 0x10) < 0xc) {\n      msls_send_error_msg(0xe0,0xa1);\n    }\n    else {\n      puVar5 = *(ushort **)(param_2 + 0x14);\n      if (*(int *)(puVar5 + 3) == *(int *)(param_2 + 0xc)) {\n        __size = *(size_t *)(param_2 + 0xc);\n        iVar3 = msls_lookup_context(param_1);\n        uVar1 = *puVar5;\n        if (uVar1 == 0x59) {\n          debug_print(\"received client finished\\n\");\n          if (iVar3 == 0) {\n            msls_send_error_msg(0xe3,0xa1);\n          }\n          else if (((*(char *)(iVar3 + 4) == '\\0') || (*(char *)(iVar3 + 0xe) == '\\0')) ||\n                  (*(char *)(iVar3 + 0xd) == '\\0')) {\n            msls_send_error_msg(0xe5,0xa0);\n          }\n          else if (puVar5[5] == 0x200) {\n            iVar2 = *(int *)(puVar5 + 1);\n            *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;\n            if (iVar2 == *(int *)(iVar3 + 8)) {\n              for (local_18 = 0; local_18 < 0x80; local_18 = local_18 + 1) {\n                if (*(uint *)(puVar5 + local_18 * 2 + 6) !=\n                    (*(uint *)(*(int *)(iVar3 + 0x24) + local_18 * 4) ^\n                    *(uint *)(*(int *)(iVar3 + 0x20) + local_18 * 4) ^\n                    *(uint *)(*(int *)(iVar3 + 0x18) + local_18 * 4))) {\n                  msls_send_error_msg(0xe7,0xa1);\n                  return;\n                }\n              }\n              *(undefined *)(iVar3 + 0xc) = 1;\n              *(undefined *)(iVar3 + 4) = 0;\n            }\n            else {\n              msls_send_error_msg(0xe6,0xa0);\n            }\n          }\n          else {\n            debug_print(\"expected length: $d got length: $d\\n\",0x200,puVar5[5]);\n            msls_send_error_msg(0xe0,0xa1);\n          }\n        }\n        else {\n          if (uVar1 < 0x5a) {\n            if (uVar1 == 0x58) {\n              debug_print(\"Received Client Done\\n\");\n              if (iVar3 == 0) {\n                msls_send_error_msg(0xe3,0xa1);\n                return;\n              }\n              if ((*(char *)(iVar3 + 4) == '\\0') || (*(char *)(iVar3 + 0xe) == '\\0')) {\n                msls_send_error_msg(0xe5,0xa0);\n                return;\n              }\n              if (puVar5[5] != 0) {\n                debug_print(\"expected length: $d got length: $d\\n\",0x200,puVar5[5]);\n                msls_send_error_msg(0xe0,0xa1);\n                return;\n              }\n              iVar2 = *(int *)(puVar5 + 1);\n              *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;\n              if (iVar2 != *(int *)(iVar3 + 8)) {\n                msls_send_error_msg(0xe6,0xa0);\n                return;\n              }\n              msls_send_finish(iVar3);\n              *(undefined *)(iVar3 + 0xd) = 1;\n              return;\n            }\n            if (uVar1 < 0x59) {\n              if (uVar1 == 0x51) {\n                debug_print(\"Received Client Hello\\n\");\n                if (puVar5[5] != 0x222) {\n                  msls_send_error_msg(0xe0,0xa1);\n                  return;\n                }\n                for (local_10 = 0; local_10 < 0x80; local_10 = local_10 + 1) {\n                  if (*(uint *)(puVar5 + local_10 * 2 + 0xb) !=\n                      (*(uint *)(param_2 + 0xc) ^ *(uint *)(*(int *)(param_1 + 0x88) + local_10 * 4)\n                      )) {\n                    debug_print(\"Cookie failed\\n\");\n                    msls_send_hello_verify(param_1,*(undefined4 *)(param_2 + 0xc));\n                    return;\n                  }\n                }\n                debug_print(\"Done checking cookie\\n\");\n                iVar3 = msls_get_connection(param_1,*(undefined4 *)(param_2 + 0xc));\n                if (iVar3 == 0) {\n                  msls_send_error_msg(0xe3,0xa2);\n                  *(undefined *)(param_1 + 1) = 1;\n                  return;\n                }\n                *(undefined *)(iVar3 + 0xc) = 0;\n                *(undefined *)(iVar3 + 4) = 1;\n                *(undefined *)(iVar3 + 0xe) = 0;\n                *(undefined *)(iVar3 + 0xd) = 0;\n                *(undefined4 *)(iVar3 + 8) = 0;\n                uVar4 = get_random();\n                *(ushort *)(iVar3 + 0x10) = puVar5[uVar4 % 0xb + 0x10b];\n                msls_send_server_hello(iVar3);\n                msls_send_keyx(iVar3);\n                msls_send_hello_done(iVar3);\n                if (*(int *)(iVar3 + 0x28) == 0) {\n                  return;\n                }\n                free(*(void **)(iVar3 + 0x28));\n                *(undefined4 *)(iVar3 + 0x28) = 0;\n                return;\n              }\n              if (uVar1 == 0x56) {\n                debug_print(\"Received Client Keyx\\n\");\n                if (iVar3 == 0) {\n                  msls_send_error_msg(0xe3,0xa1);\n                  return;\n                }\n                if (*(char *)(iVar3 + 4) == '\\0') {\n                  msls_send_error_msg(0xe5,0xa0);\n                  return;\n                }\n                if (puVar5[5] != 0x400) {\n                  msls_send_error_msg(0xe0,0xa1);\n                  return;\n                }\n                iVar2 = *(int *)(puVar5 + 1);\n                *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;\n                if (iVar2 != *(int *)(iVar3 + 8)) {\n                  msls_send_error_msg(0xe6,0xa0);\n                  return;\n                }\n                puVar5 = puVar5 + 6;\n                pvVar6 = calloc(0x200,__size);\n                *(void **)(iVar3 + 0x14) = pvVar6;\n                __size_00 = puVar5;\n                memcpy(*(void **)(iVar3 + 0x14),puVar5,0x200);\n                *(undefined *)(iVar3 + 0xe) = 1;\n                pvVar6 = calloc(0x200,(size_t)__size_00);\n                *(void **)(iVar3 + 0x1c) = pvVar6;\n                for (local_14 = 0; local_14 < 0x80; local_14 = local_14 + 1) {\n                  *(uint *)(*(int *)(iVar3 + 0x1c) + local_14 * 4) =\n                       *(uint *)(puVar5 + (local_14 + 0x80) * 2) ^\n                       *(uint *)(*(int *)(iVar3 + 0x18) + local_14 * 4);\n                }\n                return;\n              }\n            }\n          }\n          msls_send_error_msg(0xe4,0xa2);\n          *(undefined *)(param_1 + 1) = 1;\n        }\n      }\n      else {\n        debug_print(\"client_id $x != connection id $x\\n\",*(undefined4 *)(puVar5 + 3),\n                    *(undefined4 *)(param_2 + 0xc));\n        msls_send_error_msg(0xe3,0xa1);\n      }\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_handle_handshake",
                        "msls_send_error_msg",
                        "msls_lookup_context",
                        "debug_print",
                        "msls_send_finish",
                        "msls_send_hello_verify",
                        "msls_get_connection",
                        "get_random",
                        "msls_send_server_hello",
                        "msls_send_keyx",
                        "msls_send_hello_done",
                        "free",
                        "calloc",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_hello_verify",
                "func_c_signature": "void msls_send_hello_verify(int param_1,uint param_2)",
                "decompiled_code": "void msls_send_hello_verify(int param_1,uint param_2) {\n  undefined2 *puVar1;\n  undefined2 *puVar2;\n  undefined2 *puVar3;\n  size_t in_stack_ffffffd8;\n  int local_10;\n  \n  puVar1 = (undefined2 *)calloc(0x18,in_stack_ffffffd8);\n  puVar2 = (undefined2 *)calloc(0x10,in_stack_ffffffd8);\n  puVar3 = (undefined2 *)calloc(0x202,in_stack_ffffffd8);\n  *puVar3 = 0xff01;\n  for (local_10 = 0; local_10 < 0x80; local_10 = local_10 + 1) {\n    *(uint *)(puVar3 + local_10 * 2 + 1) =\n         *(uint *)(*(int *)(param_1 + 0x88) + local_10 * 4) ^ param_2;\n  }\n  *puVar2 = 0x52;\n  *(undefined4 *)(puVar2 + 1) = 0;\n  *(uint *)(puVar2 + 3) = param_2;\n  puVar2[5] = 0x202;\n  *(undefined2 **)(puVar2 + 6) = puVar3;\n  *puVar1 = 0x21d;\n  puVar1[1] = 0xff01;\n  *(undefined *)(puVar1 + 2) = 3;\n  *(uint *)(puVar1 + 6) = param_2;\n  puVar1[8] = 0x20e;\n  *(undefined2 **)(puVar1 + 10) = puVar2;\n  msls_send_msg(puVar1);\n  msls_destroy_msg(puVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_hello_verify",
                        "calloc",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake",
                        "msls_send_hello_verify"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_server_hello",
                "func_c_signature": "void msls_send_server_hello(undefined4 *param_1)",
                "decompiled_code": "void msls_send_server_hello(undefined4 *param_1) {\n  undefined2 *puVar1;\n  undefined2 *puVar2;\n  undefined2 *puVar3;\n  undefined4 uVar4;\n  size_t in_stack_ffffffd8;\n  \n  puVar1 = (undefined2 *)calloc(0x18,in_stack_ffffffd8);\n  puVar2 = (undefined2 *)calloc(0x10,in_stack_ffffffd8);\n  puVar3 = (undefined2 *)calloc(8,in_stack_ffffffd8);\n  *puVar3 = 0xff01;\n  uVar4 = get_random();\n  *(undefined4 *)(puVar3 + 1) = uVar4;\n  puVar3[3] = *(undefined2 *)(param_1 + 4);\n  *puVar2 = 0x53;\n  param_1[2] = param_1[2] + 1;\n  *(undefined4 *)(puVar2 + 1) = param_1[2];\n  *(undefined4 *)(puVar2 + 3) = *param_1;\n  puVar2[5] = 8;\n  *(undefined2 **)(puVar2 + 6) = puVar3;\n  *puVar1 = 0x23;\n  puVar1[1] = 0xff01;\n  *(undefined *)(puVar1 + 2) = 3;\n  *(undefined4 *)(puVar1 + 6) = *param_1;\n  puVar1[8] = 0x14;\n  *(undefined2 **)(puVar1 + 10) = puVar2;\n  msls_send_msg(puVar1);\n  msls_destroy_msg(puVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_server_hello",
                        "calloc",
                        "get_random",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_handle_changespec",
                        "msls_handle_handshake",
                        "msls_send_server_hello"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_keyx",
                "func_c_signature": "void msls_send_keyx(undefined4 *param_1)",
                "decompiled_code": "void msls_send_keyx(undefined4 *param_1) {\n  undefined2 *puVar1;\n  undefined2 *puVar2;\n  void *pvVar3;\n  void *pvVar4;\n  size_t in_stack_ffffffd8;\n  int local_10;\n  \n  puVar1 = (undefined2 *)calloc(0x18,in_stack_ffffffd8);\n  puVar2 = (undefined2 *)calloc(0x10,in_stack_ffffffd8);\n  pvVar3 = calloc(0x200,in_stack_ffffffd8);\n  pvVar4 = calloc(0x200,in_stack_ffffffd8);\n  param_1[6] = pvVar4;\n  for (local_10 = 0; local_10 < 0x80; local_10 = local_10 + 1) {\n    *(uint *)(param_1[6] + local_10 * 4) =\n         *(uint *)(local_10 * 4 + 0x4347c600) ^ *(uint *)(local_10 * 4 + 0x4347c400);\n    *(undefined4 *)((int)pvVar3 + local_10 * 4) = *(undefined4 *)(param_1[6] + local_10 * 4);\n  }\n  *puVar2 = 0x55;\n  param_1[2] = param_1[2] + 1;\n  *(undefined4 *)(puVar2 + 1) = param_1[2];\n  *(undefined4 *)(puVar2 + 3) = *param_1;\n  puVar2[5] = 0x200;\n  *(void **)(puVar2 + 6) = pvVar3;\n  *puVar1 = 0x21b;\n  puVar1[1] = 0xff01;\n  *(undefined *)(puVar1 + 2) = 3;\n  *(undefined4 *)(puVar1 + 6) = *param_1;\n  puVar1[8] = 0x20c;\n  *(undefined2 **)(puVar1 + 10) = puVar2;\n  msls_send_msg(puVar1);\n  msls_destroy_msg(puVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_keyx",
                        "calloc",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake",
                        "msls_send_keyx"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_hello_done",
                "func_c_signature": "void msls_send_hello_done(undefined4 *param_1)",
                "decompiled_code": "void msls_send_hello_done(undefined4 *param_1) {\n  undefined2 *puVar1;\n  undefined2 *puVar2;\n  size_t in_stack_ffffffd8;\n  \n  puVar1 = (undefined2 *)calloc(0x18,in_stack_ffffffd8);\n  puVar2 = (undefined2 *)calloc(0x10,in_stack_ffffffd8);\n  *puVar2 = 0x57;\n  param_1[2] = param_1[2] + 1;\n  *(undefined4 *)(puVar2 + 1) = param_1[2];\n  *(undefined4 *)(puVar2 + 3) = *param_1;\n  puVar2[5] = 0;\n  *(undefined4 *)(puVar2 + 6) = 0;\n  *puVar1 = 0x1b;\n  puVar1[1] = 0xff01;\n  *(undefined *)(puVar1 + 2) = 3;\n  *(undefined4 *)(puVar1 + 6) = *param_1;\n  puVar1[8] = 0xc;\n  *(undefined2 **)(puVar1 + 10) = puVar2;\n  msls_send_msg(puVar1);\n  msls_destroy_msg(puVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_hello_done",
                        "calloc",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake",
                        "msls_send_hello_done"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_send_finish",
                "func_c_signature": "void msls_send_finish(undefined4 *param_1)",
                "decompiled_code": "void msls_send_finish(undefined4 *param_1) {\n  undefined2 *puVar1;\n  undefined2 *puVar2;\n  void *pvVar3;\n  void *pvVar4;\n  size_t in_stack_ffffffc8;\n  int local_14;\n  int local_10;\n  \n  puVar1 = (undefined2 *)calloc(0x18,in_stack_ffffffc8);\n  puVar2 = (undefined2 *)calloc(0x10,in_stack_ffffffc8);\n  pvVar3 = calloc(0x200,in_stack_ffffffc8);\n  pvVar4 = calloc(0x200,in_stack_ffffffc8);\n  param_1[8] = pvVar4;\n  for (local_10 = 0; local_10 < 0x80; local_10 = local_10 + 1) {\n    *(uint *)(param_1[8] + local_10 * 4) =\n         *(uint *)(local_10 * 4 + 0x4347c400) ^ *(uint *)(local_10 * 4 + 0x4347c200);\n  }\n  for (local_14 = 0; local_14 < 0x80; local_14 = local_14 + 1) {\n    *(uint *)((int)pvVar3 + local_14 * 4) =\n         *(uint *)(param_1[8] + local_14 * 4) ^ *(uint *)(param_1[7] + local_14 * 4) ^\n         *(uint *)(param_1[5] + local_14 * 4) ^ *(uint *)(param_1[9] + local_14 * 4);\n  }\n  *puVar2 = 0x59;\n  param_1[2] = param_1[2] + 1;\n  *(undefined4 *)(puVar2 + 1) = param_1[2];\n  *(undefined4 *)(puVar2 + 3) = *param_1;\n  puVar2[5] = 0x200;\n  *(void **)(puVar2 + 6) = pvVar3;\n  *puVar1 = 0x21b;\n  puVar1[1] = 0xff01;\n  *(undefined *)(puVar1 + 2) = 3;\n  *(undefined4 *)(puVar1 + 6) = *param_1;\n  puVar1[8] = 0x20c;\n  *(undefined2 **)(puVar1 + 10) = puVar2;\n  msls_send_msg(puVar1);\n  msls_destroy_msg(puVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_send_finish",
                        "calloc",
                        "msls_send_msg",
                        "msls_destroy_msg"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake",
                        "msls_send_finish"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_get_connection",
                "func_c_signature": "uint * msls_get_connection(int param_1,uint param_2)",
                "decompiled_code": "uint * msls_get_connection(int param_1,uint param_2) {\n  uint *puVar1;\n  uint *puVar2;\n  void *__dest;\n  void *__dest_00;\n  uint __size;\n  int local_14;\n  int local_10;\n  \n  if (param_1 == 0) {\n    puVar1 = (uint *)0x0;\n  }\n  else {\n    __size = param_2;\n    puVar1 = (uint *)msls_lookup_context(param_1);\n    if (puVar1 == (uint *)0x0) {\n      for (local_10 = 0; local_10 < 0x20; local_10 = local_10 + 1) {\n        if (*(int *)(param_1 + 8 + local_10 * 4) == 0) {\n          puVar2 = (uint *)calloc(0x2c,__size);\n          puVar1 = puVar2;\n          debug_print(\"Created connection at $x\\n\");\n          *puVar2 = param_2;\n          *(uint **)(param_1 + 8 + local_10 * 4) = puVar2;\n          __dest = calloc(0x200,(size_t)puVar1);\n          __dest_00 = calloc(0x200,(size_t)puVar1);\n          memcpy(__dest,(void *)0x4347c000,0x200);\n          memcpy(__dest_00,(void *)0x4347c200,0x200);\n          for (local_14 = 0; local_14 < 0x80; local_14 = local_14 + 1) {\n            *(uint *)((int)__dest + local_14 * 4) =\n                 *(uint *)((int)__dest_00 + local_14 * 4) ^ *(uint *)((int)__dest + local_14 * 4) ^\n                 param_2;\n          }\n          debug_print(\"leaving some magic at: $x\\n\",__dest_00);\n          puVar2[10] = (uint)__dest_00;\n          puVar2[9] = (uint)__dest;\n          return puVar2;\n        }\n      }\n      puVar1 = (uint *)0x0;\n    }\n  }\n  return puVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_get_connection",
                        "msls_lookup_context",
                        "calloc",
                        "debug_print",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake",
                        "msls_get_connection"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_lookup_context",
                "func_c_signature": "int * msls_lookup_context(int param_1,int param_2)",
                "decompiled_code": "int * msls_lookup_context(int param_1,int param_2) {\n  int *piVar1;\n  int local_8;\n  \n  if (param_1 != 0) {\n    for (local_8 = 0; local_8 < 0x20; local_8 = local_8 + 1) {\n      piVar1 = *(int **)(param_1 + 8 + local_8 * 4);\n      if ((piVar1 != (int *)0x0) && (param_2 == *piVar1)) {\n        return piVar1;\n      }\n    }\n  }\n  return (int *)0x0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_lookup_context"
                    ],
                    "calling_functions": [
                        "msls_handle_handshake",
                        "msls_get_connection",
                        "msls_lookup_context"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_destroy_connection",
                "func_c_signature": "undefined ** msls_destroy_connection(undefined **param_1,undefined **param_2)",
                "decompiled_code": "undefined ** msls_destroy_connection(undefined **param_1,undefined **param_2) {\n  undefined **ppuVar1;\n  undefined **ppuVar2;\n  int local_10;\n  \n  ppuVar2 = &_GLOBAL_OFFSET_TABLE_;\n  if (param_1 != (undefined **)0x0) {\n    for (local_10 = 0; local_10 < 0x20; local_10 = local_10 + 1) {\n      ppuVar1 = (undefined **)param_1[local_10 + 2];\n      ppuVar2 = ppuVar1;\n      if ((ppuVar1 != (undefined **)0x0) &&\n         (ppuVar2 = (undefined **)*ppuVar1, param_2 == (undefined **)*ppuVar1)) {\n        destroy_context(ppuVar1);\n        param_1[local_10 + 2] = (undefined *)0x0;\n        ppuVar2 = param_1;\n      }\n    }\n  }\n  return ppuVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_destroy_connection",
                        "destroy_context"
                    ],
                    "calling_functions": [
                        "msls_destroy_connection"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "msls_set_cookie",
                "func_c_signature": "void msls_set_cookie(int param_1)",
                "decompiled_code": "void msls_set_cookie(int param_1) {\n  void *pvVar1;\n  size_t in_stack_ffffffd8;\n  int local_10;\n  \n  pvVar1 = calloc(0x200,in_stack_ffffffd8);\n  *(void **)(param_1 + 0x88) = pvVar1;\n  for (local_10 = 0; local_10 < 0x80; local_10 = local_10 + 1) {\n    *(uint *)(*(int *)(param_1 + 0x88) + local_10 * 4) =\n         *(uint *)((local_10 + 0x10d1f080) * 4) ^ *(uint *)((local_10 + 0x10d1f000) * 4);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "msls_set_cookie",
                        "calloc"
                    ],
                    "calling_functions": [
                        "msls_set_cookie"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            },
            {
                "func_name": "destroy_context",
                "func_c_signature": "void destroy_context(int param_1)",
                "decompiled_code": "void destroy_context(int param_1) {\n  if (param_1 != 0) {\n    free(*(void **)(param_1 + 0x24));\n    free(*(void **)(param_1 + 0x14));\n    free(*(void **)(param_1 + 0x18));\n    free(*(void **)(param_1 + 0x20));\n    free(*(void **)(param_1 + 0x1c));\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "destroy_context",
                        "free"
                    ],
                    "calling_functions": [
                        "msls_cleanup",
                        "msls_destroy_connection",
                        "destroy_context"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            }
        ],
        "service.c": [
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  undefined *__ptr;\n  undefined4 uVar1;\n  void *__ptr_00;\n  int iVar2;\n  size_t in_stack_ffffffd4;\n  \n  __ptr = (undefined *)calloc(0x8c,in_stack_ffffffd4);\n  uVar1 = msls_get_sls_functions();\n  *(undefined4 *)(__ptr + 4) = uVar1;\n  (**(code **)(*(int *)(__ptr + 4) + 0x28))(__ptr);\n  *__ptr = 1;\n  while (__ptr[1] == '\\0') {\n    __ptr_00 = (void *)(***(code ***)(__ptr + 4))(__ptr);\n    if (__ptr_00 == (void *)0x0) {\n      debug_print(\"Skipping invalid MSG\\n\");\n    }\n    else {\n      iVar2 = (**(code **)(*(int *)(__ptr + 4) + 0x2c))(__ptr,*(undefined4 *)((int)__ptr_00 + 0xc));\n      switch(*(undefined *)((int)__ptr_00 + 4)) {\n      case 1:\n        if ((iVar2 != 0) && (*(char *)(iVar2 + 0xc) != '\\0')) {\n          (**(code **)(*(int *)(__ptr + 4) + 0x34))(__ptr,iVar2,__ptr_00);\n        }\n        break;\n      case 2:\n        (**(code **)(*(int *)(__ptr + 4) + 0x38))(__ptr,__ptr_00);\n        break;\n      case 3:\n        (**(code **)(*(int *)(__ptr + 4) + 0x20))(__ptr,__ptr_00);\n        break;\n      case 4:\n        if ((iVar2 != 0) && (*(char *)(iVar2 + 0xc) != '\\0')) {\n          (**(code **)(*(int *)(__ptr + 4) + 0x30))(__ptr,iVar2,__ptr_00);\n        }\n        break;\n      case 5:\n        if ((iVar2 == 0) || (*(char *)(iVar2 + 4) == '\\0')) {\n          (**(code **)(*(int *)(__ptr + 4) + 0x18))(__ptr_00);\n        }\n        break;\n      case 6:\n        __ptr[1] = 1;\n      }\n      free(*(void **)((int)__ptr_00 + 0x14));\n      free(__ptr_00);\n    }\n  }\n  (**(code **)(*(int *)(__ptr + 4) + 8))(__ptr);\n  free(__ptr);\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "calloc",
                        "msls_get_sls_functions",
                        "debug_print",
                        "free"
                    ],
                    "calling_functions": [
                        "_start",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00097_decompiled.c"
                }
            }
        ]
    }
}