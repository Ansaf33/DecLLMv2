{
    "file": "KPRCA_00029",
    "decompiled_code": {
        "bbs.c": [
            {
                "func_name": "send_string",
                "func_c_signature": "void send_string(char *param_1)",
                "decompiled_code": "void send_string(char *param_1) {\n  size_t sVar1;\n  \n  sVar1 = strlen(param_1);\n  modem_output(param_1,sVar1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_string",
                        "strlen",
                        "modem_output"
                    ],
                    "calling_functions": [
                        "send_string",
                        "bbs_help",
                        "bbs_menu",
                        "send_thread",
                        "send_message_brief",
                        "send_message",
                        "send_thread_list",
                        "send_message_list",
                        "do_list",
                        "do_post",
                        "do_read",
                        "handle_post",
                        "handle_list",
                        "handle_menu"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "bbs_help",
                "func_c_signature": "void bbs_help(void)",
                "decompiled_code": "void bbs_help(void) {\n  send_string(\n             \"Available commands:\\n\\t(L)ist [thread-id]\\n\\t\\tList all threads, or messages in a thread\\n\\t(P)ost [thread-id]\\n\\t\\tPost a new thread, or a reply to a thread\\n\\t(R)ead message-id\\n\\t\\tGet message contents\\n\\t(H)elp\\n\\t\\tThis screen\\n\"\n             );\n  return;\n}",
                "globals": [],
                "externs": [
                    "t"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "bbs_help",
                        "send_string",
                        "t"
                    ],
                    "calling_functions": [
                        "bbs_help",
                        "handle_menu"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "bbs_menu",
                "func_c_signature": "void bbs_menu(void)",
                "decompiled_code": "void bbs_menu(void) {\n  send_string(\"(L)ist, (H)elp, (P)ost, (R)ead\\n\");\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "bbs_menu",
                        "send_string"
                    ],
                    "calling_functions": [
                        "bbs_menu",
                        "bbs_rx",
                        "main"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "find_thread",
                "func_c_signature": "undefined4 * find_thread(uint param_1)",
                "decompiled_code": "undefined4 * find_thread(uint param_1) {\n  undefined4 *local_8;\n  \n  for (local_8 = g_threads; (local_8 != (undefined4 *)0x0 && (param_1 <= (uint)local_8[2]));\n      local_8 = (undefined4 *)*local_8) {\n    if (local_8[2] == param_1) {\n      return local_8;\n    }\n  }\n  return (undefined4 *)0x0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "find_thread"
                    ],
                    "calling_functions": [
                        "find_thread",
                        "do_list",
                        "do_post"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "find_message",
                "func_c_signature": "undefined4 * find_message(uint param_1)",
                "decompiled_code": "undefined4 * find_message(uint param_1) {\n  undefined4 *local_c;\n  undefined4 *local_8;\n  \n  local_8 = g_threads;\n  do {\n    if (local_8 == (undefined4 *)0x0) {\n      return (undefined4 *)0x0;\n    }\n    for (local_c = (undefined4 *)local_8[1];\n        (local_c != (undefined4 *)0x0 && (param_1 <= (uint)local_c[1]));\n        local_c = (undefined4 *)*local_c) {\n      if (local_c[1] == param_1) {\n        return local_c;\n      }\n    }\n    local_8 = (undefined4 *)*local_8;\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "find_message"
                    ],
                    "calling_functions": [
                        "find_message",
                        "do_read"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "send_thread",
                "func_c_signature": "void send_thread(int param_1)",
                "decompiled_code": "void send_thread(int param_1) {\n  char local_70 [104];\n  \n  sprintf(local_70,\"%08d - %s\\n\",*(undefined4 *)(param_1 + 8),param_1 + 0xc);\n  send_string(local_70);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_thread",
                        "sprintf",
                        "send_string"
                    ],
                    "calling_functions": [
                        "send_thread",
                        "send_thread_list"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "send_message_brief",
                "func_c_signature": "void send_message_brief(int param_1)",
                "decompiled_code": "void send_message_brief(int param_1) {\n  char local_70 [104];\n  \n  sprintf(local_70,\"%08d - %s\\n\",*(undefined4 *)(param_1 + 4),param_1 + 8);\n  send_string(local_70);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_message_brief",
                        "sprintf",
                        "send_string"
                    ],
                    "calling_functions": [
                        "send_message_brief",
                        "send_message_list"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "send_message",
                "func_c_signature": "void send_message(int param_1)",
                "decompiled_code": "void send_message(int param_1) {\n  char local_70 [104];\n  \n  sprintf(local_70,\"%08d - %s\\n\",*(undefined4 *)(param_1 + 4),param_1 + 8);\n  send_string(local_70);\n  send_string(*(undefined4 *)(param_1 + 0x48));\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_message",
                        "sprintf",
                        "send_string"
                    ],
                    "calling_functions": [
                        "send_message",
                        "do_read"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "send_thread_list",
                "func_c_signature": "void send_thread_list(undefined4 *param_1)",
                "decompiled_code": "void send_thread_list(undefined4 *param_1) {\n  int local_10;\n  \n  local_10 = 0;\n  for (; (local_10 < 0x28 && (param_1 != (undefined4 *)0x0)); param_1 = (undefined4 *)*param_1) {\n    send_thread(param_1);\n    local_10 = local_10 + 1;\n  }\n  if (param_1 == (undefined4 *)0x0) {\n    g_state = 0;\n  }\n  else {\n    g_state = 1;\n    DAT_00019384 = param_1;\n    send_string(\"(N)ext page, (Q)uit\\n\");\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_thread_list",
                        "send_thread",
                        "send_string"
                    ],
                    "calling_functions": [
                        "send_thread_list",
                        "do_list",
                        "handle_list"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "send_message_list",
                "func_c_signature": "void send_message_list(undefined4 *param_1)",
                "decompiled_code": "void send_message_list(undefined4 *param_1) {\n  int local_10;\n  \n  local_10 = 0;\n  for (; (local_10 < 0x28 && (param_1 != (undefined4 *)0x0)); param_1 = (undefined4 *)*param_1) {\n    send_message_brief(param_1);\n    local_10 = local_10 + 1;\n  }\n  if (param_1 == (undefined4 *)0x0) {\n    g_state = 0;\n  }\n  else {\n    g_state = 2;\n    DAT_00019388 = param_1;\n    send_string(\"(N)ext page, (Q)uit\\n\");\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_message_list",
                        "send_message_brief",
                        "send_string"
                    ],
                    "calling_functions": [
                        "send_message_list",
                        "do_list",
                        "handle_list"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "do_list",
                "func_c_signature": "void do_list(int param_1)",
                "decompiled_code": "void do_list(int param_1) {\n  long lVar1;\n  int iVar2;\n  \n  if (*(char *)(param_1 + 1) == ' ') {\n    lVar1 = strtol((char *)(param_1 + 2),(char **)0x0,10);\n    iVar2 = find_thread(lVar1);\n    if (iVar2 == 0) {\n      send_string(\"Thread ID not found.\\n\");\n    }\n    else {\n      send_message_list(*(undefined4 *)(iVar2 + 4));\n    }\n  }\n  else {\n    send_thread_list(g_threads);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_list",
                        "strtol",
                        "find_thread",
                        "send_string",
                        "send_message_list",
                        "send_thread_list"
                    ],
                    "calling_functions": [
                        "do_list",
                        "handle_menu"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "do_post",
                "func_c_signature": "void do_post(int param_1)",
                "decompiled_code": "void do_post(int param_1) {\n  long lVar1;\n  int local_10;\n  \n  local_10 = 0;\n  if (*(char *)(param_1 + 1) == ' ') {\n    lVar1 = strtol((char *)(param_1 + 2),(char **)0x0,10);\n    local_10 = find_thread(lVar1);\n    if (local_10 == 0) {\n      send_string(\"Thread ID not found.\\n\");\n      return;\n    }\n  }\n  send_string(\"Subject?\\n\");\n  DAT_00019384 = local_10;\n  g_state = 3;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_post",
                        "strtol",
                        "find_thread",
                        "send_string"
                    ],
                    "calling_functions": [
                        "do_post",
                        "handle_menu"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "do_read",
                "func_c_signature": "void do_read(int param_1)",
                "decompiled_code": "void do_read(int param_1) {\n  long lVar1;\n  int iVar2;\n  \n  if (*(char *)(param_1 + 1) == ' ') {\n    lVar1 = strtol((char *)(param_1 + 2),(char **)0x0,10);\n    iVar2 = find_message(lVar1);\n    if (iVar2 == 0) {\n      send_string(\"Message ID not found.\\n\");\n    }\n    else {\n      send_message(iVar2);\n    }\n  }\n  else {\n    send_string(\"Missing required argument.\\n\");\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "do_read",
                        "strtol",
                        "find_message",
                        "send_string",
                        "send_message"
                    ],
                    "calling_functions": [
                        "do_read",
                        "handle_menu"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "handle_post",
                "func_c_signature": "void handle_post(char *param_1)",
                "decompiled_code": "void handle_post(char *param_1) {\n  int iVar1;\n  undefined4 *puVar2;\n  char *pcVar3;\n  undefined4 *local_10;\n  \n  if (g_state == 3) {\n    strncpy((char *)&DAT_00019388,param_1,0x3f);\n    DAT_000193c7 = 0;\n    send_string(\"Body?\\n\");\n    g_state = 4;\n    return;\n  }\n  if (g_state == 4) {\n    local_10 = DAT_00019384;\n    if (DAT_00019384 == (undefined4 *)0x0) {\n      local_10 = (undefined4 *)malloc(0x4c);\n      if (local_10 == (undefined4 *)0x0) {\n        g_state = 0;\n        return;\n      }\n      strcpy((char *)(local_10 + 3),(char *)&DAT_00019388);\n      iVar1 = g_next_id + 1;\n      local_10[2] = g_next_id;\n      g_next_id = iVar1;\n      *local_10 = g_threads;\n      local_10[1] = 0;\n      g_threads = local_10;\n    }\n    puVar2 = (undefined4 *)malloc(0x4c);\n    if (puVar2 != (undefined4 *)0x0) {\n      iVar1 = g_next_id + 1;\n      puVar2[1] = g_next_id;\n      g_next_id = iVar1;\n      strcpy((char *)(puVar2 + 2),(char *)&DAT_00019388);\n      pcVar3 = strdup(param_1);\n      puVar2[0x12] = pcVar3;\n      if (puVar2[0x12] != 0) {\n        *puVar2 = local_10[1];\n        local_10[1] = puVar2;\n      }\n    }\n    g_state = 0;\n    return;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_post",
                        "strncpy",
                        "send_string",
                        "malloc",
                        "strcpy",
                        "strdup"
                    ],
                    "calling_functions": [
                        "handle_post",
                        "bbs_rx"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "handle_list",
                "func_c_signature": "void handle_list(char *param_1)",
                "decompiled_code": "void handle_list(char *param_1) {\n  int iVar1;\n  \n  iVar1 = tolower((int)*param_1);\n  if (iVar1 == 0x71) {\n    g_state = 0;\n  }\n  else {\n    iVar1 = tolower((int)*param_1);\n    if (iVar1 == 0x6e) {\n      if (g_state == 1) {\n        send_thread_list(DAT_00019384);\n      }\n      else {\n        send_message_list(DAT_00019388);\n      }\n    }\n    else {\n      send_string(\"Bad input.\\n\");\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_list",
                        "tolower",
                        "send_thread_list",
                        "send_message_list",
                        "send_string"
                    ],
                    "calling_functions": [
                        "handle_list",
                        "bbs_rx"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "handle_menu",
                "func_c_signature": "void handle_menu(char *param_1)",
                "decompiled_code": "void handle_menu(char *param_1) {\n  int local_10;\n  \n  local_10 = (int)*param_1;\n  if ((param_1[1] != '\\0') && (param_1[1] != ' ')) {\n    local_10 = 0;\n  }\n  switch(local_10) {\n  case 0x3f:\n  case 0x48:\n  case 0x68:\n    bbs_help();\n    break;\n  default:\n    send_string(\"Bad input. Unknown command.\\n\");\n    break;\n  case 0x4c:\n  case 0x6c:\n    do_list(param_1);\n    break;\n  case 0x50:\n  case 0x70:\n    do_post(param_1);\n    break;\n  case 0x51:\n  case 0x71:\n                    /* WARNING: Subroutine does not return */\n    exit(0);\n  case 0x52:\n  case 0x72:\n    do_read(param_1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_menu",
                        "bbs_help",
                        "send_string",
                        "do_list",
                        "do_post",
                        "exit",
                        "do_read"
                    ],
                    "calling_functions": [
                        "handle_menu",
                        "bbs_rx"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "bbs_rx",
                "func_c_signature": "void bbs_rx(void *param_1,size_t param_2)",
                "decompiled_code": "void bbs_rx(void *param_1,size_t param_2) {\n  size_t sVar1;\n  char local_71 [105];\n  \n  memcpy(local_71,param_1,param_2);\n  local_71[param_2] = '\\0';\n  sVar1 = strlen(local_71);\n  if (sVar1 != 0) {\n    if (g_state == 0) {\n      handle_menu(local_71);\n    }\n    else if ((g_state == 1) || (g_state == 2)) {\n      handle_list(local_71);\n    }\n    else if ((g_state == 3) || (g_state == 4)) {\n      handle_post(local_71);\n    }\n    if (g_state == 0) {\n      bbs_menu();\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "bbs_rx",
                        "memcpy",
                        "strlen",
                        "handle_menu",
                        "handle_list",
                        "handle_post",
                        "bbs_menu"
                    ],
                    "calling_functions": [
                        "bbs_rx"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  modem_init(&stack0x00000004);\n  bbs_menu();\n  modem_loop(bbs_rx);\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "modem_init",
                        "bbs_menu",
                        "modem_loop"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            }
        ],
        "buffer.c": [
            {
                "func_name": "increment_read",
                "func_c_signature": "void increment_read(uint *param_1,uint param_2)",
                "decompiled_code": "void increment_read(uint *param_1,uint param_2) {\n  uint uVar1;\n  \n  uVar1 = *param_1;\n  *param_1 = uVar1 + param_2;\n  param_1[1] = param_1[1] + (uint)CARRY4(uVar1,param_2);\n  if ((*param_1 ^ param_1[5] << 3 | param_1[1]) == 0) {\n    *param_1 = 0;\n    param_1[1] = 0;\n  }\n  else if (param_1[1] != 0 || -param_1[1] < (uint)(param_1[5] << 3 < *param_1)) {\n                    /* WARNING: Subroutine does not return */\n    exit(1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [
                    "CARRY4"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "increment_read",
                        "CARRY4",
                        "exit"
                    ],
                    "calling_functions": [
                        "increment_read",
                        "buffer_read_bit",
                        "buffer_read_bytes"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "increment_write",
                "func_c_signature": "int increment_write(int param_1,uint param_2)",
                "decompiled_code": "int increment_write(int param_1,uint param_2) {\n  uint uVar1;\n  int iVar2;\n  \n  uVar1 = *(uint *)(param_1 + 8);\n  *(uint *)(param_1 + 8) = uVar1 + param_2;\n  *(uint *)(param_1 + 0xc) = *(int *)(param_1 + 0xc) + (uint)CARRY4(uVar1,param_2);\n  uVar1 = (uint)(*(uint *)(param_1 + 8) < (uint)(*(int *)(param_1 + 0x14) << 3));\n  iVar2 = *(uint *)(param_1 + 0xc) - uVar1;\n  if (uVar1 <= *(uint *)(param_1 + 0xc)) {\n    uVar1 = *(uint *)(param_1 + 8);\n    iVar2 = uVar1 + *(int *)(param_1 + 0x14) * -8;\n    *(int *)(param_1 + 8) = iVar2;\n    *(uint *)(param_1 + 0xc) =\n         *(int *)(param_1 + 0xc) - (uint)(uVar1 < (uint)(*(int *)(param_1 + 0x14) * 8));\n  }\n  return iVar2;\n}",
                "globals": [],
                "externs": [
                    "CARRY4"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "increment_write",
                        "CARRY4"
                    ],
                    "calling_functions": [
                        "increment_write",
                        "buffer_write_bit",
                        "buffer_write_bytes"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_read_bit",
                "func_c_signature": "uint buffer_read_bit(uint *param_1)",
                "decompiled_code": "uint buffer_read_bit(uint *param_1) {\n  byte bVar1;\n  uint uVar2;\n  \n  if ((*param_1 ^ param_1[2] | param_1[3] ^ param_1[1]) == 0) {\n    uVar2 = 0xffffffff;\n  }\n  else {\n    bVar1 = *(byte *)((*param_1 >> 3 | param_1[1] << 0x1d) + param_1[4]);\n    uVar2 = *param_1;\n    increment_read(param_1,1);\n    uVar2 = (uint)((byte)((int)(uint)bVar1 >> (~(byte)uVar2 & 7)) & 1);\n  }\n  return uVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_read_bit",
                        "increment_read"
                    ],
                    "calling_functions": [
                        "buffer_read_bit",
                        "buffer_read_bits",
                        "checksum8",
                        "frame_decode",
                        "frame_encode",
                        "modem_encode",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_read_bits",
                "func_c_signature": "uint buffer_read_bits(uint *param_1,uint param_2)",
                "decompiled_code": "uint buffer_read_bits(uint *param_1,uint param_2) {\n  uint uVar1;\n  uint local_24;\n  uint local_20;\n  \n  local_20 = 0;\n  local_24 = 0;\n  while ((local_24 < param_2 && ((*param_1 ^ param_1[2] | param_1[3] ^ param_1[1]) != 0))) {\n    uVar1 = buffer_read_bit(param_1);\n    local_20 = uVar1 | local_20 * 2;\n    local_24 = local_24 + 1;\n  }\n  return local_20;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_read_bits",
                        "buffer_read_bit"
                    ],
                    "calling_functions": [
                        "buffer_read_bits",
                        "buffer_read_bytes",
                        "frame_decode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_read_bytes",
                "func_c_signature": "void buffer_read_bytes(uint *param_1,int param_2,uint param_3)",
                "decompiled_code": "void buffer_read_bytes(uint *param_1,int param_2,uint param_3) {\n  undefined uVar1;\n  ulonglong uVar2;\n  uint local_10;\n  \n  if (((*param_1 & 7) == 0) &&\n     (uVar2 = buffer_read_remaining(param_1),\n     (uint)((uint)(uVar2 >> 3) < param_3) <= (uint)((uVar2 >> 3) >> 0x20))) {\n    for (local_10 = 0; local_10 < param_3; local_10 = local_10 + 1) {\n      *(undefined *)(local_10 + param_2) =\n           *(undefined *)((*param_1 >> 3 | param_1[1] << 0x1d) + param_1[4]);\n      increment_read(param_1,8);\n    }\n  }\n  else {\n    for (local_10 = 0; local_10 < param_3; local_10 = local_10 + 1) {\n      uVar1 = buffer_read_bits(param_1,8);\n      *(undefined *)(local_10 + param_2) = uVar1;\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_read_bytes",
                        "buffer_read_remaining",
                        "increment_read",
                        "buffer_read_bits"
                    ],
                    "calling_functions": [
                        "buffer_read_bytes",
                        "frame_decode",
                        "frame_encode",
                        "modem_decode",
                        "modem_encode_frame",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_write_bit",
                "func_c_signature": "void buffer_write_bit(int param_1,int param_2)",
                "decompiled_code": "void buffer_write_bit(int param_1,int param_2) {\n  byte bVar1;\n  byte local_d;\n  \n  local_d = *(byte *)((*(uint *)(param_1 + 8) >> 3 | *(int *)(param_1 + 0xc) << 0x1d) +\n                     *(int *)(param_1 + 0x10));\n  bVar1 = ~(byte)*(undefined4 *)(param_1 + 8) & 7;\n  if (bVar1 == 7) {\n    local_d = 0;\n  }\n  *(byte *)((*(uint *)(param_1 + 8) >> 3 | *(int *)(param_1 + 0xc) << 0x1d) +\n           *(int *)(param_1 + 0x10)) = (byte)(param_2 << bVar1) | local_d;\n  increment_write(param_1,1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_write_bit",
                        "increment_write"
                    ],
                    "calling_functions": [
                        "buffer_write_bit",
                        "buffer_write_bits",
                        "frame_decode",
                        "frame_encode",
                        "modem_decode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_write_bits",
                "func_c_signature": "void buffer_write_bits(undefined4 param_1,uint param_2,int param_3)",
                "decompiled_code": "void buffer_write_bits(undefined4 param_1,uint param_2,int param_3) {\n  int local_8;\n  \n  for (local_8 = param_3 + -1; -1 < local_8; local_8 = local_8 + -1) {\n    buffer_write_bit(param_1,param_2 >> ((byte)local_8 & 0x1f) & 1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_write_bits",
                        "buffer_write_bit"
                    ],
                    "calling_functions": [
                        "buffer_write_bits",
                        "buffer_write_bytes",
                        "frame_encode",
                        "modem_encode_frame"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_write_bytes",
                "func_c_signature": "void buffer_write_bytes(int param_1,int param_2,uint param_3)",
                "decompiled_code": "void buffer_write_bytes(int param_1,int param_2,uint param_3) {\n  undefined4 uVar1;\n  uint local_10;\n  \n  uVar1 = 0x11fc3;\n  if ((*(uint *)(param_1 + 8) & 7) == 0) {\n    for (local_10 = 0; local_10 < param_3; local_10 = local_10 + 1) {\n      *(undefined *)\n       (*(int *)(param_1 + 0x10) + (*(uint *)(param_1 + 8) >> 3 | *(int *)(param_1 + 0xc) << 0x1d))\n           = *(undefined *)(param_2 + local_10);\n      increment_write(param_1,8);\n    }\n  }\n  else {\n    for (local_10 = 0; local_10 < param_3; local_10 = local_10 + 1) {\n      buffer_write_bits(param_1,*(undefined *)(local_10 + param_2),8,uVar1);\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_write_bytes",
                        "increment_write",
                        "buffer_write_bits"
                    ],
                    "calling_functions": [
                        "buffer_write_bytes",
                        "frame_decode",
                        "frame_encode",
                        "modem_encode",
                        "modem_encode_frame",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_read_remaining",
                "func_c_signature": "undefined8 buffer_read_remaining(uint *param_1)",
                "decompiled_code": "undefined8 buffer_read_remaining(uint *param_1) {\n  uint uVar1;\n  int iVar2;\n  bool bVar3;\n  \n  uVar1 = param_1[2] - *param_1;\n  iVar2 = (param_1[3] - param_1[1]) - (uint)(param_1[2] < *param_1);\n  if (iVar2 < 0) {\n    bVar3 = CARRY4(uVar1,param_1[5] * 8);\n    uVar1 = uVar1 + param_1[5] * 8;\n    iVar2 = iVar2 + (uint)bVar3;\n  }\n  return CONCAT44(iVar2,uVar1);\n}",
                "globals": [],
                "externs": [
                    "CARRY4",
                    "CONCAT44"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_read_remaining",
                        "CARRY4",
                        "CONCAT44"
                    ],
                    "calling_functions": [
                        "buffer_read_bytes",
                        "buffer_read_remaining",
                        "frame_encode",
                        "modem_output",
                        "modem_encode_frame",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_read_tell",
                "func_c_signature": "undefined8 buffer_read_tell(undefined8 *param_1)",
                "decompiled_code": "undefined8 buffer_read_tell(undefined8 *param_1) {\n  return *param_1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_read_tell"
                    ],
                    "calling_functions": [
                        "buffer_read_tell",
                        "frame_decode",
                        "frame_encode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_read_seek",
                "func_c_signature": "void buffer_read_seek(undefined4 *param_1,undefined4 param_2,undefined4 param_3)",
                "decompiled_code": "void buffer_read_seek(undefined4 *param_1,undefined4 param_2,undefined4 param_3) {\n  *param_1 = param_2;\n  param_1[1] = param_3;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_read_seek"
                    ],
                    "calling_functions": [
                        "buffer_read_seek",
                        "frame_decode",
                        "frame_encode",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_write_tell",
                "func_c_signature": "undefined8 buffer_write_tell(int param_1)",
                "decompiled_code": "undefined8 buffer_write_tell(int param_1) {\n  return *(undefined8 *)(param_1 + 8);\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_write_tell"
                    ],
                    "calling_functions": [
                        "buffer_write_tell"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_write_seek",
                "func_c_signature": "void buffer_write_seek(int param_1,undefined4 param_2,undefined4 param_3)",
                "decompiled_code": "void buffer_write_seek(int param_1,undefined4 param_2,undefined4 param_3) {\n  *(undefined4 *)(param_1 + 8) = param_2;\n  *(undefined4 *)(param_1 + 0xc) = param_3;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_write_seek"
                    ],
                    "calling_functions": [
                        "buffer_write_seek",
                        "modem_output"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "buffer_init",
                "func_c_signature": "void buffer_init(void *param_1,undefined4 param_2,undefined4 param_3)",
                "decompiled_code": "void buffer_init(void *param_1,undefined4 param_2,undefined4 param_3) {\n  memset(param_1,0,0x18);\n  *(undefined4 *)((int)param_1 + 0x10) = param_2;\n  *(undefined4 *)((int)param_1 + 0x14) = param_3;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "buffer_init",
                        "memset"
                    ],
                    "calling_functions": [
                        "buffer_init",
                        "frame_decode",
                        "frame_encode",
                        "modem_output",
                        "modem_encode_frame",
                        "modem_init",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            }
        ],
        "checksum.c": [
            {
                "func_name": "checksum8",
                "func_c_signature": "byte checksum8(undefined4 param_1,uint param_2,byte param_3)",
                "decompiled_code": "byte checksum8(undefined4 param_1,uint param_2,byte param_3) {\n  byte bVar1;\n  byte bVar2;\n  byte local_20;\n  uint local_10;\n  \n  local_20 = param_3;\n  for (local_10 = 0; local_10 < param_2; local_10 = local_10 + 1) {\n    bVar1 = local_20 & 0x80;\n    bVar2 = buffer_read_bit(param_1);\n    local_20 = bVar2 | local_20 * '\\x02';\n    if (bVar1 != 0) {\n      local_20 = local_20 ^ 0x97;\n    }\n  }\n  return local_20;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "checksum8",
                        "buffer_read_bit"
                    ],
                    "calling_functions": [
                        "checksum8",
                        "frame_decode",
                        "frame_encode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            }
        ],
        "ecc.c": [
            {
                "func_name": "ecc_init",
                "func_c_signature": "void ecc_init(void)",
                "decompiled_code": "void ecc_init(void) {\n  int local_c;\n  \n  for (local_c = 0; local_c < 7; local_c = local_c + 1) {\n    field[local_c] = (char)(1 << ((byte)local_c & 0x1f));\n  }\n  field[7] = 9;\n  for (local_c = 8; local_c < 0x7f; local_c = local_c + 1) {\n    field[local_c] = *(char *)(local_c + 0x193df) * '\\x02';\n    if ((char)field[local_c] < '\\0') {\n      field[local_c] = field[local_c] ^ field[7] ^ 0x80;\n    }\n  }\n  for (local_c = 0; local_c < 0x7f; local_c = local_c + 1) {\n    gf_index[(byte)field[local_c]] = (char)local_c;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "ecc_init"
                    ],
                    "calling_functions": [
                        "ecc_init",
                        "modem_init"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "ecc_encode",
                "func_c_signature": "undefined4 ecc_encode(undefined *param_1)",
                "decompiled_code": "undefined4 ecc_encode(undefined *param_1) {\n  char cVar1;\n  char cVar2;\n  int local_10;\n  int local_c;\n  \n  for (local_c = 0; local_c < 0x1c; local_c = local_c + 1) {\n    param_1[local_c] = 0;\n  }\n  for (local_c = 0x7e; 0x1b < local_c; local_c = local_c + -1) {\n    cVar1 = param_1[0x1b];\n    cVar2 = param_1[local_c];\n    for (local_10 = 0x1b; 0 < local_10; local_10 = local_10 + -1) {\n      param_1[local_10] = param_1[local_10 + -1];\n    }\n    *param_1 = 0;\n    if (cVar2 != cVar1) {\n      for (local_10 = 0; local_10 < 0x1c; local_10 = local_10 + 1) {\n        param_1[local_10] = param_1[local_10] ^ (byte)(0x1c9c26b9 >> ((byte)local_10 & 0x1f)) & 1;\n      }\n    }\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "ecc_encode"
                    ],
                    "calling_functions": [
                        "ecc_encode",
                        "frame_encode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "ecc_decode",
                "func_c_signature": "bool ecc_decode(int param_1)",
                "decompiled_code": "bool ecc_decode(int param_1) {\n  int iVar1;\n  undefined local_3d [5];\n  byte local_38 [5];\n  byte local_33 [5];\n  byte local_2e [8];\n  byte local_26;\n  byte local_25;\n  int local_24;\n  uint local_20;\n  int local_1c;\n  int local_18;\n  int local_14;\n  int local_10;\n  \n  for (local_10 = 0; local_10 < 8; local_10 = local_10 + 1) {\n    local_2e[local_10] = 0;\n  }\n  for (local_10 = 0; local_10 < 0x7f; local_10 = local_10 + 1) {\n    if (*(char *)(param_1 + local_10) != '\\0') {\n      for (local_14 = 0; local_14 < 8; local_14 = local_14 + 1) {\n        local_2e[local_14] = local_2e[local_14] ^ field[((local_14 + 1) * local_10) % 0x7f];\n      }\n    }\n  }\n  memset(local_38,0,5);\n  memset(local_33,0,5);\n  local_38[0] = 1;\n  local_33[0] = 1;\n  local_18 = 0;\n  local_1c = 1;\n  local_20 = 1;\n  for (local_10 = 0; local_10 < 8; local_10 = local_10 + 1) {\n    local_25 = local_2e[local_10];\n    for (local_14 = 1; local_14 <= local_18; local_14 = local_14 + 1) {\n      local_25 = local_25 ^\n                 field[((uint)(byte)gf_index[local_33[local_14]] +\n                       (uint)(byte)gf_index[local_2e[local_10 - local_14]]) % 0x7f];\n    }\n    if (local_25 != 0) {\n      memcpy(local_3d,local_33,5);\n      for (local_14 = 0; local_14 < 4; local_14 = local_14 + 1) {\n        if (local_38[local_14] != 0) {\n          local_33[local_14 + local_1c] =\n               local_33[local_14 + local_1c] ^\n               field[((uint)(byte)gf_index[local_25] +\n                     (uint)(byte)gf_index[(byte)field[((uint)(byte)gf_index[(byte)field[(int)(0x7f -\n                                                                                             (uint)(\n                                                  byte)gf_index[local_20]) % 0x7f]] +\n                                                  (uint)(byte)gf_index[local_38[local_14]]) % 0x7f]]\n                     ) % 0x7f];\n        }\n      }\n      if (SBORROW4(local_10,local_18 * 2) == local_10 + local_18 * -2 < 0) {\n        local_18 = (local_10 + 1) - local_18;\n        local_20 = (uint)local_25;\n        local_1c = 0;\n        memcpy(local_38,local_3d,5);\n      }\n    }\n    local_1c = local_1c + 1;\n  }\n  local_24 = 0;\n  for (local_10 = 0; local_10 < 0x7f; local_10 = local_10 + 1) {\n    local_26 = 0;\n    for (local_14 = 0; local_14 <= local_18; local_14 = local_14 + 1) {\n      local_26 = local_26 ^\n                 field[((uint)(byte)gf_index[local_33[local_14]] +\n                       (uint)(byte)gf_index[(byte)field[(local_10 * local_14) % 0x7f]]) % 0x7f];\n    }\n    if (local_26 == 0) {\n      local_24 = local_24 + 1;\n      iVar1 = (0x7f - local_10) % 0x7f;\n      *(byte *)(param_1 + iVar1) = *(byte *)(param_1 + iVar1) ^ 1;\n    }\n  }\n  if (2 < local_18) {\n    fdprintf(2,\"\\nFOUND ERRORS: %d %d\\n\",local_24,local_18);\n  }\n  return local_24 == local_18;\n}",
                "globals": [],
                "externs": [
                    "SBORROW4"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "ecc_decode",
                        "memset",
                        "memcpy",
                        "SBORROW4",
                        "fdprintf"
                    ],
                    "calling_functions": [
                        "ecc_decode",
                        "frame_decode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            }
        ],
        "frame.c": [
            {
                "func_name": "frame_decode",
                "func_c_signature": "undefined4 frame_decode(undefined4 param_1,undefined4 param_2)",
                "decompiled_code": "undefined4 frame_decode(undefined4 param_1,undefined4 param_2) {\n  undefined uVar1;\n  int iVar2;\n  undefined4 uVar3;\n  undefined4 uVar4;\n  undefined4 uVar5;\n  undefined local_d0 [27];\n  undefined local_b5 [14];\n  byte local_a7 [9];\n  undefined local_9e [127];\n  byte local_1f;\n  char local_1e;\n  char local_1d;\n  undefined8 local_1c;\n  byte local_11;\n  uint local_10;\n  \n  uVar5 = 0x1289d;\n  uVar4 = 0x7f;\n  uVar3 = 0;\n  memset(local_9e,0,0x7f);\n  for (local_10 = 0; local_10 < 0x70; local_10 = local_10 + 1) {\n    uVar1 = buffer_read_bit(param_1,uVar3,uVar4,uVar5);\n    local_9e[local_10] = uVar1;\n  }\n  iVar2 = ecc_decode(local_9e);\n  if (iVar2 == 0) {\n    uVar3 = 0;\n  }\n  else {\n    buffer_init(local_d0,local_b5,0xe);\n    for (local_10 = 0x1c; local_10 < 0x70; local_10 = local_10 + 1) {\n      buffer_write_bit(local_d0,local_9e[local_10]);\n    }\n    local_1c = buffer_read_tell(local_d0);\n    local_1d = checksum8(local_d0,0x4c,0);\n    local_1e = buffer_read_bits(local_d0,8);\n    if (local_1d == local_1e) {\n      buffer_read_seek(local_d0,local_1c);\n      local_1f = buffer_read_bits(local_d0,4);\n      local_11 = local_1f;\n      if (9 < local_1f) {\n        local_11 = 9;\n      }\n      buffer_read_bytes(local_d0,local_a7,local_11);\n      for (local_10 = 0; local_10 < local_11; local_10 = local_10 + 1) {\n        local_a7[local_10] = local_a7[local_10] ^ 0x55;\n      }\n      buffer_write_bytes(param_2,local_a7,local_11);\n      if (local_1f == 0xf) {\n        uVar3 = 1;\n      }\n      else {\n        uVar3 = 2;\n      }\n    }\n    else {\n      uVar3 = 0;\n    }\n  }\n  return uVar3;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "frame_decode",
                        "memset",
                        "buffer_read_bit",
                        "ecc_decode",
                        "buffer_init",
                        "buffer_write_bit",
                        "buffer_read_tell",
                        "checksum8",
                        "buffer_read_bits",
                        "buffer_read_seek",
                        "buffer_read_bytes",
                        "buffer_write_bytes"
                    ],
                    "calling_functions": [
                        "frame_decode",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "frame_encode",
                "func_c_signature": "void frame_encode(undefined4 param_1,undefined4 param_2)",
                "decompiled_code": "void frame_encode(undefined4 param_1,undefined4 param_2) {\n  undefined *puVar1;\n  undefined uVar2;\n  undefined8 uVar3;\n  undefined local_ee;\n  byte local_ed;\n  undefined local_ec [24];\n  undefined local_d4 [24];\n  undefined local_bc [14];\n  undefined local_ae [10];\n  undefined local_a4 [127];\n  undefined local_25;\n  undefined8 local_24;\n  uint local_1c;\n  uint local_18;\n  uint local_14;\n  uint local_10;\n  \n  buffer_init(local_d4,local_bc,0xe,0x12a8a);\n  buffer_init(local_ec,local_ae,10);\n  uVar3 = buffer_read_remaining(param_1);\n  local_1c = (uint)uVar3 >> 3 | (int)((ulonglong)uVar3 >> 0x20) << 0x1d;\n  local_18 = local_1c;\n  if (9 < local_1c) {\n    local_1c = 9;\n    local_18 = 0xf;\n  }\n  for (local_10 = 0; local_10 < local_1c; local_10 = local_10 + 1) {\n    buffer_read_bytes(param_1,&local_ed,1);\n    local_ed = local_ed ^ 0x55;\n    buffer_write_bytes(local_ec,&local_ed,1);\n  }\n  for (; local_10 < 9; local_10 = local_10 + 1) {\n    local_ee = 0x55;\n    buffer_write_bytes(local_ec,&local_ee,1);\n  }\n  local_24 = buffer_read_tell(local_ec);\n  buffer_write_bits(local_d4,local_18,4);\n  local_25 = checksum8(local_d4,4,0);\n  local_25 = checksum8(local_ec,0x48,local_25);\n  buffer_read_seek(local_ec,local_24);\n  buffer_init(local_d4,local_bc,0xe);\n  buffer_write_bits(local_d4,local_18,4);\n  buffer_write_bits(local_d4,local_25,8);\n  memset(local_a4,0,0x7f);\n  local_10 = 0x1c;\n  for (local_14 = 0; local_14 < 4; local_14 = local_14 + 1) {\n    uVar2 = buffer_read_bit(local_d4);\n    puVar1 = local_a4 + local_10;\n    local_10 = local_10 + 1;\n    *puVar1 = uVar2;\n  }\n  for (local_14 = 0; local_14 < 0x48; local_14 = local_14 + 1) {\n    uVar2 = buffer_read_bit(local_ec);\n    puVar1 = local_a4 + local_10;\n    local_10 = local_10 + 1;\n    *puVar1 = uVar2;\n  }\n  for (local_14 = 0; local_14 < 8; local_14 = local_14 + 1) {\n    uVar2 = buffer_read_bit(local_d4);\n    puVar1 = local_a4 + local_10;\n    local_10 = local_10 + 1;\n    *puVar1 = uVar2;\n  }\n  ecc_encode(local_a4);\n  for (local_10 = 0; local_10 < 0x70; local_10 = local_10 + 1) {\n    buffer_write_bit(param_2,local_a4[local_10]);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "frame_encode",
                        "buffer_init",
                        "buffer_read_remaining",
                        "buffer_read_bytes",
                        "buffer_write_bytes",
                        "buffer_read_tell",
                        "buffer_write_bits",
                        "checksum8",
                        "buffer_read_seek",
                        "memset",
                        "buffer_read_bit",
                        "ecc_encode",
                        "buffer_write_bit"
                    ],
                    "calling_functions": [
                        "frame_encode",
                        "modem_output"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            }
        ],
        "modem.c": [
            {
                "func_name": "filter",
                "func_c_signature": "void filter(void *param_1,int param_2,uint param_3,void *param_4)",
                "decompiled_code": "void filter(void *param_1,int param_2,uint param_3,void *param_4) {\n  short local_16;\n  uint local_14;\n  uint local_10;\n  \n  memcpy((void *)((int)param_4 + (param_3 + 0x7fffffff) * 2),param_1,0xa0);\n  for (local_10 = 0; local_10 < 0x50; local_10 = local_10 + 1) {\n    local_16 = 0;\n    for (local_14 = 0; local_14 < param_3; local_14 = local_14 + 1) {\n      local_16 = local_16 +\n                 (short)((uint)((int)*(short *)(param_2 + ((param_3 - local_14) + 0x7fffffff) * 2) *\n                               (int)*(short *)((int)param_4 + (local_14 + local_10) * 2)) >> 0x10);\n    }\n    *(short *)(local_10 * 2 + (int)param_1) = local_16;\n  }\n  memmove(param_4,(void *)((int)param_4 + 0xa0),(param_3 - 1) * 2);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "filter",
                        "memcpy",
                        "memmove"
                    ],
                    "calling_functions": [
                        "filter",
                        "bandpass_filter",
                        "lowpass_filter"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "bandpass_filter",
                "func_c_signature": "void bandpass_filter(undefined4 param_1)",
                "decompiled_code": "void bandpass_filter(undefined4 param_1) {\n  filter(param_1,BANDPASS_COEFFS,0x11,history_8);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "bandpass_filter",
                        "filter"
                    ],
                    "calling_functions": [
                        "bandpass_filter",
                        "modem_decode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "lowpass_filter",
                "func_c_signature": "void lowpass_filter(undefined4 param_1)",
                "decompiled_code": "void lowpass_filter(undefined4 param_1) {\n  filter(param_1,LOWPASS_COEFFS,0x2d,history_7);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "lowpass_filter",
                        "filter"
                    ],
                    "calling_functions": [
                        "lowpass_filter",
                        "modem_decode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "convolution",
                "func_c_signature": "void convolution(void *param_1)",
                "decompiled_code": "void convolution(void *param_1) {\n  uint local_10;\n  \n  memcpy(buf_6 + 0x12,param_1,0xa0);\n  for (local_10 = 0; local_10 < 0x50; local_10 = local_10 + 1) {\n    *(short *)((int)param_1 + local_10 * 2) =\n         (short)((uint)((int)*(short *)(buf_6 + (local_10 + 9) * 2) *\n                       (int)*(short *)(buf_6 + local_10 * 2)) >> 0x10);\n  }\n  memmove(buf_6,buf_6 + 0xa0,0x12);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "convolution",
                        "memcpy",
                        "memmove"
                    ],
                    "calling_functions": [
                        "convolution",
                        "modem_decode"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "modem_decode",
                "func_c_signature": "void modem_decode(undefined4 param_1,undefined4 param_2)",
                "decompiled_code": "void modem_decode(undefined4 param_1,undefined4 param_2) {\n  int iVar1;\n  undefined local_c5;\n  short local_c4 [80];\n  uint local_24;\n  int local_20;\n  uint local_1c;\n  short local_16;\n  uint local_14;\n  uint local_10;\n  \n  for (local_14 = 0; local_14 < 0x50; local_14 = local_14 + 1) {\n    buffer_read_bytes(param_1,&local_c5,1);\n    iVar1 = comp_decode(local_c5);\n    local_c4[local_14] = (short)(iVar1 << 2);\n  }\n  bandpass_filter(local_c4);\n  convolution(local_c4);\n  lowpass_filter(local_c4);\n  if (phase_5 == 0xffffffff) {\n    local_16 = 0;\n    local_10 = 0;\n    for (local_14 = 0; local_14 < 0x50; local_14 = local_14 + 1) {\n      if (local_16 < local_c4[local_14]) {\n        local_16 = local_c4[local_14];\n        local_10 = local_14;\n      }\n      else if (-(int)local_16 != (int)local_c4[local_14] &&\n               (int)local_16 <= -(int)local_c4[local_14]) {\n        local_16 = -local_c4[local_14];\n        local_10 = local_14;\n      }\n    }\n    phase_5 = (int)local_10 % 10;\n  }\n  for (local_14 = phase_5; local_14 < 0x50; local_14 = local_14 + 0x14) {\n    local_1c = 0;\n    for (local_20 = 0; local_20 < 5; local_20 = local_20 + 1) {\n      local_1c = local_1c + (int)local_c4[local_14 + local_20];\n    }\n    local_1c = (int)local_1c / 5;\n    local_24 = local_1c >> 0x1f;\n    buffer_write_bit(param_2,local_24);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "modem_decode",
                        "buffer_read_bytes",
                        "comp_decode",
                        "bandpass_filter",
                        "convolution",
                        "lowpass_filter",
                        "buffer_write_bit"
                    ],
                    "calling_functions": [
                        "modem_decode",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "_modem_encode",
                "func_c_signature": "void _modem_encode(int param_1)",
                "decompiled_code": "void _modem_encode(int param_1) {\n  short sVar1;\n  \n  if (param_1 == 0) {\n    sVar1 = 0x3666;\n  }\n  else {\n    sVar1 = 0x4333;\n  }\n  t_4 = t_4 + sVar1;\n  sVar1 = fastsin((int)t_4);\n  comp_encode((int)(sVar1 >> 2));\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "_modem_encode",
                        "fastsin",
                        "comp_encode"
                    ],
                    "calling_functions": [
                        "_modem_encode",
                        "modem_encode",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "modem_encode",
                "func_c_signature": "void modem_encode(undefined4 param_1,undefined4 param_2)",
                "decompiled_code": "void modem_encode(undefined4 param_1,undefined4 param_2) {\n  undefined local_15;\n  int local_14;\n  int local_10;\n  \n  while( true ) {\n    local_14 = buffer_read_bit(param_1);\n    if (local_14 == -1) break;\n    for (local_10 = 0; local_10 < 0x14; local_10 = local_10 + 1) {\n      local_15 = _modem_encode(local_14);\n      buffer_write_bytes(param_2,&local_15,1);\n    }\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "modem_encode",
                        "buffer_read_bit",
                        "_modem_encode",
                        "buffer_write_bytes"
                    ],
                    "calling_functions": [
                        "modem_encode",
                        "modem_encode_frame"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "modem_output",
                "func_c_signature": "void modem_output(undefined4 param_1,int param_2)",
                "decompiled_code": "void modem_output(undefined4 param_1,int param_2) {\n  longlong lVar1;\n  undefined local_24 [28];\n  \n  buffer_init(local_24,param_1,param_2 + 1);\n  buffer_write_seek(local_24,param_2 << 3,0);\n  while( true ) {\n    lVar1 = buffer_read_remaining(local_24);\n    if (lVar1 == 0) break;\n    frame_encode(local_24,g_frames);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "modem_output",
                        "buffer_init",
                        "buffer_write_seek",
                        "buffer_read_remaining",
                        "frame_encode"
                    ],
                    "calling_functions": [
                        "send_string",
                        "modem_output"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "modem_encode_frame",
                "func_c_signature": "void modem_encode_frame(undefined4 param_1)",
                "decompiled_code": "void modem_encode_frame(undefined4 param_1) {\n  int iVar1;\n  undefined8 uVar2;\n  undefined local_39;\n  undefined local_38 [25];\n  undefined local_1f [15];\n  uint local_10;\n  \n  uVar2 = buffer_read_remaining(g_frames);\n  iVar1 = (int)((ulonglong)uVar2 >> 0x20);\n  if (iVar1 != 0 || (uint)-iVar1 < (uint)(0x6f < (uint)uVar2)) {\n    buffer_init(local_38,local_1f,0xf);\n    buffer_write_bits(local_38,0x13,5);\n    for (local_10 = 0; local_10 < 0xe; local_10 = local_10 + 1) {\n      buffer_read_bytes(g_frames,&local_39,1);\n      buffer_write_bytes(local_38,&local_39,1);\n    }\n    modem_encode(local_38,param_1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "modem_encode_frame",
                        "buffer_read_remaining",
                        "buffer_init",
                        "buffer_write_bits",
                        "buffer_read_bytes",
                        "buffer_write_bytes",
                        "modem_encode"
                    ],
                    "calling_functions": [
                        "modem_encode_frame",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "modem_init",
                "func_c_signature": "void modem_init(void)",
                "decompiled_code": "void modem_init(void) {\n  ecc_init();\n  buffer_init(g_frames,g_frames_data,0x2000);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "modem_init",
                        "ecc_init",
                        "buffer_init"
                    ],
                    "calling_functions": [
                        "main",
                        "modem_init"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "get_byte",
                "func_c_signature": "undefined4 get_byte(undefined *param_1)",
                "decompiled_code": "undefined4 get_byte(undefined *param_1) {\n  int iVar1;\n  \n  if (buf_read == buf_offset) {\n    iVar1 = receive(0,&buf,0x400,&buf_read);\n    if ((iVar1 != 0) || (buf_read == 0)) {\n      return 0xffffffff;\n    }\n    buf_offset = 0;\n  }\n  *param_1 = (&buf)[buf_offset];\n  buf_offset = buf_offset + 1;\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_byte",
                        "receive"
                    ],
                    "calling_functions": [
                        "get_byte",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "ready_to_read",
                "func_c_signature": "undefined4 ready_to_read(void)",
                "decompiled_code": "undefined4 ready_to_read(void) {\n  undefined4 uVar1;\n  undefined4 local_a0;\n  undefined4 local_9c;\n  uint local_98;\n  uint local_94 [32];\n  int local_14;\n  uint local_10;\n  \n  if (buf_offset < buf_read) {\n    uVar1 = 1;\n  }\n  else {\n    for (local_10 = 0; local_10 < 0x20; local_10 = local_10 + 1) {\n      local_94[local_10] = 0;\n    }\n    local_94[0] = local_94[0] | 1;\n    local_a0 = 0;\n    local_9c = 1;\n    local_14 = fdwait(1,local_94,0,&local_a0,&local_98);\n    if (local_14 != 0) {\n                    /* WARNING: Subroutine does not return */\n      _terminate(1);\n    }\n    if ((local_94[local_98 >> 5] & 1 << ((byte)local_98 & 0x1f)) == 0) {\n      uVar1 = 0;\n    }\n    else {\n      uVar1 = 1;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "ready_to_read",
                        "fdwait",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "ready_to_read",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "send_n_bytes",
                "func_c_signature": "uint send_n_bytes(undefined4 param_1,uint param_2,int param_3)",
                "decompiled_code": "uint send_n_bytes(undefined4 param_1,uint param_2,int param_3) {\n  int iVar1;\n  int local_14;\n  uint local_10;\n  \n  if ((param_2 == 0) || (param_3 == 0)) {\n    local_10 = 0xffffffff;\n  }\n  else {\n    local_14 = 0;\n    for (local_10 = 0; local_10 < param_2; local_10 = local_10 + local_14) {\n      iVar1 = transmit(param_1,param_3 + local_10,param_2 - local_10,&local_14);\n      if (iVar1 != 0) {\n                    /* WARNING: Subroutine does not return */\n        _terminate(1);\n      }\n      if (local_14 == 0) {\n        return local_10;\n      }\n    }\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_n_bytes",
                        "transmit",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "send_n_bytes",
                        "flush_output"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "flush_output",
                "func_c_signature": "void flush_output(void)",
                "decompiled_code": "void flush_output(void) {\n  if (out_buf_len != 0) {\n    send_n_bytes(1,out_buf_len,out_buf);\n    out_buf_len = 0;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "flush_output",
                        "send_n_bytes"
                    ],
                    "calling_functions": [
                        "flush_output",
                        "write_byte",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "write_byte",
                "func_c_signature": "void write_byte(undefined param_1)",
                "decompiled_code": "void write_byte(undefined param_1) {\n  undefined1 *puVar1;\n  \n  puVar1 = out_buf + out_buf_len;\n  out_buf_len = out_buf_len + 1;\n  *puVar1 = param_1;\n  if (0x3ff < out_buf_len) {\n    flush_output();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "write_byte",
                        "flush_output"
                    ],
                    "calling_functions": [
                        "write_byte",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            },
            {
                "func_name": "modem_loop",
                "func_c_signature": "void modem_loop(code *param_1)",
                "decompiled_code": "void modem_loop(code *param_1) {\n  int iVar1;\n  undefined8 uVar2;\n  longlong lVar3;\n  undefined local_89;\n  undefined local_88 [24];\n  undefined local_70 [24];\n  undefined local_58 [24];\n  undefined local_40 [24];\n  int local_28;\n  undefined local_21;\n  undefined4 local_20;\n  undefined4 local_1c;\n  undefined4 local_18;\n  int local_14;\n  uint local_10;\n  \n  local_10 = 0;\n  local_14 = 0;\n  buffer_init(local_40,indata_3,0x400);\n  buffer_init(local_58,decdata_2,0x200);\n  buffer_init(local_70,pktdata_1,0x400);\n  buffer_init(local_88,outdata_0,0x8000);\n  do {\n    local_20 = 1;\n    iVar1 = ready_to_read();\n    if (iVar1 == 0) {\n      flush_output();\n    }\n    iVar1 = get_byte(&local_89);\n    if (iVar1 != 0) {\n      return;\n    }\n    local_14 = local_14 + 1;\n    buffer_write_bytes(local_40,&local_89,1);\n    uVar2 = buffer_read_remaining(local_40);\n    iVar1 = (int)((ulonglong)uVar2 >> 0x20);\n    if (iVar1 != 0 || (uint)-iVar1 < (uint)(0x27f < (uint)uVar2)) {\n      modem_decode(local_40,local_58);\nswitchD_000138f8_caseD_5:\n      while (local_10 != 5) {\n        uVar2 = buffer_read_remaining(local_58);\n        iVar1 = (int)((ulonglong)uVar2 >> 0x20);\n        if (iVar1 == 0 && (uint)(7 < (uint)uVar2) <= (uint)-iVar1) break;\n        local_21 = buffer_read_bit(local_58);\n        if (local_10 < 5) {\n                    /* WARNING: Could not recover jumptable at 0x000138f8. Too many branches */\n                    /* WARNING: Treating indirect jump as call */\n          (*(code *)((int)&_GLOBAL_OFFSET_TABLE_ +\n                    (&switchD_000138f8::switchdataD_000162a0)[local_10]))();\n          return;\n        }\n      }\n      if (local_10 != 5) goto LAB_00013a4c;\n      uVar2 = buffer_read_remaining(local_58);\n      iVar1 = (int)((ulonglong)uVar2 >> 0x20);\n      if (iVar1 == 0 && (uint)(0x70 < (uint)uVar2) <= (uint)-iVar1) goto LAB_00013a4c;\n      local_28 = frame_decode(local_58,local_70);\n      if (local_28 == 0) {\n        local_10 = 0;\n        buffer_read_seek(local_58,local_1c,local_18);\n        goto switchD_000138f8_caseD_5;\n      }\n      if (local_28 == 2) {\n        uVar2 = buffer_read_remaining(local_70);\n        (*param_1)(pktdata_1,(uint)uVar2 >> 3 | (int)((ulonglong)uVar2 >> 0x20) << 0x1d);\n        buffer_init(local_70,pktdata_1,0x400);\n      }\n      local_10 = 0;\n    }\nLAB_00013a4c:\n    lVar3 = buffer_read_remaining(local_88);\n    if (lVar3 == 0) {\n      modem_encode_frame(local_88);\n    }\n    lVar3 = buffer_read_remaining(local_88);\n    if (lVar3 == 0) {\n      local_89 = _modem_encode(1);\n    }\n    else {\n      buffer_read_bytes(local_88,&local_89,1);\n    }\n    write_byte(local_89);\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "modem_loop",
                        "buffer_init",
                        "ready_to_read",
                        "flush_output",
                        "get_byte",
                        "buffer_write_bytes",
                        "buffer_read_remaining",
                        "modem_decode",
                        "buffer_read_bit",
                        "frame_decode",
                        "buffer_read_seek",
                        "modem_encode_frame",
                        "_modem_encode",
                        "buffer_read_bytes",
                        "write_byte"
                    ],
                    "calling_functions": [
                        "main",
                        "modem_loop"
                    ],
                    "defined_in_file": "KPRCA_00029_decompiled.c"
                }
            }
        ]
    }
}