{
    "file": "chown-core",
    "decompiled_code": {
        "chown-core.c": [
            {
                "func_name": "chopt_init",
                "func_c_signature": "void chopt_init(undefined4 *param_1)",
                "decompiled_code": "void chopt_init(undefined4 *param_1) {\n  *param_1 = 2;\n  *(undefined8 *)(param_1 + 2) = 0;\n  *(undefined *)(param_1 + 4) = 1;\n  *(undefined *)(param_1 + 1) = 0;\n  *(undefined *)((long)param_1 + 0x11) = 0;\n  *(undefined8 *)(param_1 + 6) = 0;\n  *(undefined8 *)(param_1 + 8) = 0;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "chopt_init"
                    ],
                    "calling_functions": [
                        "chopt_init"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "chopt_free",
                "func_c_signature": "void chopt_free(long param_1)",
                "decompiled_code": "void chopt_free(long param_1) {\n  free(*(void **)(param_1 + 0x18));\n  free(*(void **)(param_1 + 0x20));\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "chopt_free",
                        "free"
                    ],
                    "calling_functions": [
                        "chopt_free"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "uid_to_str",
                "func_c_signature": "void uid_to_str(undefined4 param_1)",
                "decompiled_code": "void uid_to_str(undefined4 param_1) {\n  undefined8 uVar1;\n  long in_FS_OFFSET;\n  undefined local_28 [24];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  uVar1 = umaxtostr(param_1,local_28);\n  xstrdup(uVar1);\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "uid_to_str",
                        "umaxtostr",
                        "xstrdup",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "uid_to_str",
                        "uid_to_name",
                        "change_file_owner"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "gid_to_str",
                "func_c_signature": "void gid_to_str(undefined4 param_1)",
                "decompiled_code": "void gid_to_str(undefined4 param_1) {\n  undefined8 uVar1;\n  long in_FS_OFFSET;\n  undefined local_28 [24];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  uVar1 = umaxtostr(param_1,local_28);\n  xstrdup(uVar1);\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "gid_to_str",
                        "umaxtostr",
                        "xstrdup",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "gid_to_str",
                        "gid_to_name",
                        "change_file_owner"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "gid_to_name",
                "func_c_signature": "void gid_to_name(__gid_t param_1)",
                "decompiled_code": "void gid_to_name(__gid_t param_1) {\n  group *pgVar1;\n  \n  pgVar1 = getgrgid(param_1);\n  if (pgVar1 == (group *)0x0) {\n    gid_to_str(param_1);\n  }\n  else {\n    xstrdup(pgVar1->gr_name);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "gid_to_name",
                        "getgrgid",
                        "gid_to_str",
                        "xstrdup"
                    ],
                    "calling_functions": [
                        "gid_to_name",
                        "change_file_owner"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "uid_to_name",
                "func_c_signature": "void uid_to_name(__uid_t param_1)",
                "decompiled_code": "void uid_to_name(__uid_t param_1) {\n  passwd *ppVar1;\n  \n  ppVar1 = getpwuid(param_1);\n  if (ppVar1 == (passwd *)0x0) {\n    uid_to_str(param_1);\n  }\n  else {\n    xstrdup(ppVar1->pw_name);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "uid_to_name",
                        "getpwuid",
                        "uid_to_str",
                        "xstrdup"
                    ],
                    "calling_functions": [
                        "uid_to_name",
                        "change_file_owner"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "user_group_str",
                "func_c_signature": "char * user_group_str(char *param_1,char *param_2)",
                "decompiled_code": "char * user_group_str(char *param_1,char *param_2) {\n  size_t sVar1;\n  size_t sVar2;\n  undefined2 *puVar3;\n  char *local_20;\n  \n  local_20 = (char *)0x0;\n  if (param_1 == (char *)0x0) {\n    if (param_2 != (char *)0x0) {\n      local_20 = (char *)xstrdup(param_2);\n    }\n  }\n  else if (param_2 == (char *)0x0) {\n    local_20 = (char *)xstrdup(param_1);\n  }\n  else {\n    sVar1 = strlen(param_1);\n    sVar2 = strlen(param_2);\n    local_20 = (char *)xmalloc(sVar2 + sVar1 + 2);\n    puVar3 = (undefined2 *)stpcpy(local_20,param_1);\n    *puVar3 = 0x3a;\n    strcpy((char *)((long)puVar3 + 1),param_2);\n  }\n  return local_20;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "user_group_str",
                        "xstrdup",
                        "strlen",
                        "xmalloc",
                        "stpcpy",
                        "strcpy"
                    ],
                    "calling_functions": [
                        "user_group_str",
                        "describe_change"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "describe_change",
                "func_c_signature": "void describe_change(undefined8 param_1,uint param_2,undefined8 param_3,undefined8 param_4,\n                    long param_5,long param_6)",
                "decompiled_code": "void describe_change(undefined8 param_1,uint param_2,undefined8 param_3,undefined8 param_4,\n                    long param_5,long param_6) {\n  undefined8 uVar1;\n  char *__format;\n  void *pvVar2;\n  char *local_30;\n  void *local_28;\n  void *local_20;\n  \n  if (param_2 == 1) {\n    uVar1 = quotearg_style(4,param_1);\n    __format = (char *)gettext(\"neither symbolic link %s nor referent has been changed\\n\");\n    printf(__format,uVar1);\n  }\n  else {\n    pvVar2 = (void *)user_group_str(param_5,param_6);\n    if (param_6 == 0) {\n      param_4 = 0;\n    }\n    if (param_5 == 0) {\n      param_3 = 0;\n    }\n    local_28 = (void *)user_group_str(param_3,param_4);\n    local_20 = pvVar2;\n    if (param_2 == 4) {\n      if (param_5 == 0) {\n        if (param_6 == 0) {\n          local_30 = (char *)gettext(\"ownership of %s retained\\n\");\n        }\n        else {\n          local_30 = (char *)gettext(\"group of %s retained as %s\\n\");\n        }\n      }\n      else {\n        local_30 = (char *)gettext(\"ownership of %s retained as %s\\n\");\n      }\n    }\n    else {\n      if (4 < param_2) {\nLAB_0010047d:\n                    /* WARNING: Subroutine does not return */\n        __assert_fail(\"0\",\n                      \"/workspace/home/aiclub1/B220032CS_Jaefar/fyp/repos/ansaf/coreutils/src/chown-core.c\"\n                      ,0xca,\"describe_change\");\n      }\n      if (param_2 == 2) {\n        if (param_5 == 0) {\n          if (param_6 == 0) {\n            local_30 = (char *)gettext(\"no change to ownership of %s\\n\");\n          }\n          else {\n            local_30 = (char *)gettext(\"changed group of %s from %s to %s\\n\");\n          }\n        }\n        else {\n          local_30 = (char *)gettext(\"changed ownership of %s from %s to %s\\n\");\n        }\n      }\n      else {\n        if (param_2 != 3) goto LAB_0010047d;\n        if (local_28 == (void *)0x0) {\n          if (param_5 == 0) {\n            if (param_6 == 0) {\n              local_30 = (char *)gettext(\"failed to change ownership of %s\\n\");\n            }\n            else {\n              local_30 = (char *)gettext(\"failed to change group of %s to %s\\n\");\n            }\n          }\n          else {\n            local_30 = (char *)gettext(\"failed to change ownership of %s to %s\\n\");\n          }\n          free((void *)0x0);\n          local_20 = (void *)0x0;\n          local_28 = pvVar2;\n        }\n        else if (param_5 == 0) {\n          if (param_6 == 0) {\n            local_30 = (char *)gettext(\"failed to change ownership of %s\\n\");\n          }\n          else {\n            local_30 = (char *)gettext(\"failed to change group of %s from %s to %s\\n\");\n          }\n        }\n        else {\n          local_30 = (char *)gettext(\"failed to change ownership of %s from %s to %s\\n\");\n        }\n      }\n    }\n    uVar1 = quotearg_style(4,param_1);\n    printf(local_30,uVar1,local_28,local_20);\n    free(local_28);\n    free(local_20);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "describe_change",
                        "quotearg_style",
                        "gettext",
                        "printf",
                        "user_group_str",
                        "__assert_fail",
                        "free"
                    ],
                    "calling_functions": [
                        "describe_change",
                        "change_file_owner"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "restricted_chown",
                "func_c_signature": "undefined4\nrestricted_chown(int param_1,char *param_2,long param_3,__uid_t param_4,__gid_t param_5,\n                __uid_t param_6,__gid_t param_7)",
                "decompiled_code": "undefined4\nrestricted_chown(int param_1,char *param_2,long param_3,__uid_t param_4,__gid_t param_5,\n                __uid_t param_6,__gid_t param_7) {\n  char cVar1;\n  int iVar2;\n  int *piVar3;\n  long in_FS_OFFSET;\n  undefined4 local_b8;\n  uint local_b4;\n  int local_b0;\n  stat local_a8;\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  local_b8 = 2;\n  local_b4 = 0x900;\n  if ((param_6 == 0xffffffff) && (param_7 == 0xffffffff)) {\n    local_b8 = 5;\n    goto LAB_0010073e;\n  }\n  if ((*(uint *)(param_3 + 0x18) & 0xf000) != 0x8000) {\n    if ((*(uint *)(param_3 + 0x18) & 0xf000) != 0x4000) {\n      local_b8 = 5;\n      goto LAB_0010073e;\n    }\n    local_b4 = 0x10900;\n  }\n  local_b0 = openat(param_1,param_2,local_b4);\n  if (local_b0 < 0) {\n    piVar3 = __errno_location();\n    if ((*piVar3 == 0xd) && ((*(uint *)(param_3 + 0x18) & 0xf000) == 0x8000)) {\n      local_b0 = openat(param_1,param_2,local_b4 | 1);\n      if (-1 < local_b0) goto LAB_0010064e;\n    }\n    piVar3 = __errno_location();\n    if (*piVar3 == 0xd) {\n      local_b8 = 5;\n    }\n    else {\n      local_b8 = 6;\n    }\n  }\n  else {\nLAB_0010064e:\n    iVar2 = fstat(local_b0,&local_a8);\n    if (iVar2 == 0) {\n      cVar1 = psame_inode(param_3,&local_a8);\n      if (cVar1 == '\\x01') {\n        if (((param_6 == 0xffffffff) || (param_6 == local_a8.st_uid)) &&\n           ((param_7 == 0xffffffff || (param_7 == local_a8.st_gid)))) {\n          iVar2 = fchown(local_b0,param_4,param_5);\n          if (iVar2 == 0) {\n            iVar2 = close(local_b0);\n            if (iVar2 < 0) {\n              local_b8 = 6;\n            }\n            else {\n              local_b8 = 2;\n            }\n            goto LAB_0010073e;\n          }\n          local_b8 = 6;\n        }\n      }\n      else {\n        local_b8 = 4;\n      }\n    }\n    else {\n      local_b8 = 6;\n    }\n    piVar3 = __errno_location();\n    iVar2 = *piVar3;\n    close(local_b0);\n    piVar3 = __errno_location();\n    *piVar3 = iVar2;\n  }\nLAB_0010073e:\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return local_b8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "restricted_chown",
                        "openat",
                        "__errno_location",
                        "fstat",
                        "psame_inode",
                        "fchown",
                        "close",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "restricted_chown",
                        "change_file_owner"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "change_file_owner",
                "func_c_signature": "bool change_file_owner(long param_1,long param_2,__uid_t param_3,__gid_t param_4,__uid_t param_5,\n                      __gid_t param_6,int *param_7)",
                "decompiled_code": "bool change_file_owner(long param_1,long param_2,__uid_t param_3,__gid_t param_4,__uid_t param_5,\n                      __gid_t param_6,int *param_7) {\n  char *__file;\n  bool bVar1;\n  char cVar2;\n  bool bVar3;\n  int iVar4;\n  uint uVar5;\n  undefined4 uVar6;\n  undefined8 uVar7;\n  undefined8 uVar8;\n  undefined8 uVar9;\n  int *piVar10;\n  void *__ptr;\n  void *__ptr_00;\n  void *__ptr_01;\n  void *__ptr_02;\n  long in_FS_OFFSET;\n  bool local_1c4;\n  stat *local_158;\n  stat local_b8;\n  long local_20;\n  \n  local_20 = *(long *)(in_FS_OFFSET + 0x28);\n  uVar7 = *(undefined8 *)(param_2 + 0x38);\n  __file = *(char **)(param_2 + 0x30);\n  local_1c4 = true;\n  bVar1 = true;\n  switch(*(undefined2 *)(param_2 + 0x68)) {\n  case 1:\n    if (*(char *)(param_7 + 1) != '\\0') {\n      if ((*(long *)(param_7 + 2) == 0) ||\n         ((**(ulong **)(param_7 + 2) ^ *(ulong *)(param_2 + 0x78) |\n          *(ulong *)(param_2 + 0x70) ^ *(ulong *)(*(long *)(param_7 + 2) + 8)) != 0)) {\n        local_1c4 = true;\n      }\n      else {\n        cVar2 = streq(uVar7,&DAT_0010193e);\n        if (cVar2 == '\\0') {\n          uVar8 = quotearg_n_style(1,4,&DAT_0010193e);\n          uVar7 = quotearg_n_style(0,4,uVar7);\n          uVar9 = gettext(\"it is dangerous to operate recursively on %s (same as %s)\");\n          error(0,0,uVar9,uVar7,uVar8);\n        }\n        else {\n          uVar7 = quotearg_style(4,uVar7);\n          uVar8 = gettext(\"it is dangerous to operate recursively on %s\");\n          error(0,0,uVar8,uVar7);\n        }\n        uVar7 = gettext(\"use --no-preserve-root to override this failsafe\");\n        error(0,0,uVar7);\n        rpl_fts_set(param_1,param_2,4);\n        rpl_fts_read(param_1);\n        local_1c4 = false;\n      }\n      goto LAB_00101557;\n    }\n    break;\n  case 2:\n    cVar2 = cycle_warning_required(param_1,param_2);\n    if (cVar2 != '\\0') {\n      uVar7 = quotearg_n_style_colon(0,3,uVar7);\n      uVar8 = gettext(\n                     \"WARNING: Circular directory structure.\\nThis almost certainly means that you have a corrupted file system.\\nNOTIFY YOUR SYSTEM MANAGER.\\nThe following directory is part of the cycle:\\n  %s\\n\"\n                     );\n      error(0,0,uVar8,uVar7);\n      local_1c4 = false;\n      goto LAB_00101557;\n    }\n    break;\n  case 4:\n    if (*(char *)((long)param_7 + 0x11) != '\\x01') {\n      uVar8 = quotearg_style(4,uVar7);\n      uVar9 = gettext(\"cannot read directory %s\");\n      error(0,*(undefined4 *)(param_2 + 0x40),uVar9,uVar8);\n    }\n    local_1c4 = false;\n    break;\n  case 6:\n    if (*(char *)(param_7 + 1) != '\\x01') {\n      local_1c4 = true;\n      goto LAB_00101557;\n    }\n    break;\n  case 7:\n    if (*(char *)((long)param_7 + 0x11) != '\\x01') {\n      uVar8 = quotearg_n_style_colon(0,3,uVar7);\n      error(0,*(undefined4 *)(param_2 + 0x40),&DAT_001019f2,uVar8);\n    }\n    local_1c4 = false;\n    break;\n  case 10:\n    if ((*(long *)(param_2 + 0x58) == 0) && (*(long *)(param_2 + 0x20) == 0)) {\n      *(undefined8 *)(param_2 + 0x20) = 1;\n      rpl_fts_set(param_1,param_2,1);\n      local_1c4 = true;\n      goto LAB_00101557;\n    }\n    if (*(char *)((long)param_7 + 0x11) != '\\x01') {\n      uVar8 = quotearg_style(4,uVar7);\n      uVar9 = gettext(\"cannot access %s\");\n      error(0,*(undefined4 *)(param_2 + 0x40),uVar9,uVar8);\n    }\n    local_1c4 = false;\n  }\n  if (local_1c4 == true) {\n    if ((((param_5 == 0xffffffff) && (param_6 == 0xffffffff)) && (*param_7 == 2)) &&\n       ((*(long *)(param_7 + 2) == 0 && (*(char *)(param_7 + 4) != '\\x01')))) {\n      bVar3 = true;\n      local_158 = (stat *)(param_2 + 0x70);\n    }\n    else {\n      local_158 = (stat *)(param_2 + 0x70);\n      if ((*(char *)(param_7 + 4) != '\\0') && ((*(uint *)(param_2 + 0x88) & 0xf000) == 0xa000)) {\n        iVar4 = fstatat(*(int *)(param_1 + 0x2c),__file,&local_b8,0);\n        if (iVar4 != 0) {\n          if (*(char *)((long)param_7 + 0x11) != '\\x01') {\n            uVar8 = quotearg_style(4,uVar7);\n            uVar9 = gettext(\"cannot dereference %s\");\n            piVar10 = __errno_location();\n            error(0,*piVar10,uVar9,uVar8);\n          }\n          local_1c4 = false;\n        }\n        local_158 = &local_b8;\n      }\n      if (((local_1c4 == false) || ((param_5 != 0xffffffff && (param_5 != local_158->st_uid)))) ||\n         ((param_6 != 0xffffffff && (param_6 != local_158->st_gid)))) {\n        bVar3 = false;\n      }\n      else {\n        bVar3 = true;\n      }\n    }\n  }\n  else {\n    bVar3 = false;\n    local_158 = (stat *)0x0;\n  }\n  if ((local_1c4 == false) ||\n     (((((*(short *)(param_2 + 0x68) != 1 && (*(short *)(param_2 + 0x68) != 2)) &&\n        (*(short *)(param_2 + 0x68) != 6)) && (*(short *)(param_2 + 0x68) != 4)) ||\n      ((*(long *)(param_7 + 2) == 0 ||\n       ((**(ulong **)(param_7 + 2) ^ local_158->st_ino |\n        local_158->st_dev ^ *(ulong *)(*(long *)(param_7 + 2) + 8)) != 0)))))) {\n    if (bVar3) {\n      if (*(char *)(param_7 + 4) == '\\x01') {\n        uVar5 = restricted_chown(*(undefined4 *)(param_1 + 0x2c),__file,local_158,param_3,param_4,\n                                 param_5,param_6);\n        if (uVar5 == 6) {\n          local_1c4 = false;\n        }\n        else if (uVar5 < 7) {\n          if (uVar5 == 5) {\n            iVar4 = chownat(*(undefined4 *)(param_1 + 0x2c),__file,param_3,param_4);\n            local_1c4 = iVar4 == 0;\n          }\n          else if (((uVar5 < 6) && (uVar5 != 2)) && ((1 < uVar5 && (uVar5 - 3 < 2)))) {\n            bVar3 = false;\n            local_1c4 = false;\n          }\n        }\n      }\n      else {\n        iVar4 = lchownat(*(undefined4 *)(param_1 + 0x2c),__file,param_3,param_4);\n        local_1c4 = iVar4 == 0;\n        if (!local_1c4) {\n          piVar10 = __errno_location();\n          cVar2 = is_ENOTSUP(*piVar10);\n          if (cVar2 != '\\0') {\n            local_1c4 = true;\n            bVar1 = false;\n          }\n        }\n      }\n      if (((bVar3) && (local_1c4 != true)) && (*(char *)((long)param_7 + 0x11) != '\\x01')) {\n        uVar8 = quotearg_style(4,uVar7);\n        if (param_3 == 0xffffffff) {\n          uVar9 = gettext(\"changing group of %s\");\n        }\n        else {\n          uVar9 = gettext(\"changing ownership of %s\");\n        }\n        piVar10 = __errno_location();\n        error(0,*piVar10,uVar9,uVar8);\n      }\n    }\n    if (*param_7 != 2) {\n      if (((bVar3) && (local_1c4 != false)) &&\n         ((bVar1 && (((param_3 != 0xffffffff && (param_3 != local_158->st_uid)) ||\n                     ((param_4 != 0xffffffff && (param_4 != local_158->st_gid)))))))) {\n        bVar3 = true;\n      }\n      else {\n        bVar3 = false;\n      }\n      if ((bVar3) || (*param_7 == 0)) {\n        if (local_1c4 == true) {\n          if (bVar1) {\n            if (bVar3) {\n              uVar6 = 2;\n            }\n            else {\n              uVar6 = 4;\n            }\n          }\n          else {\n            uVar6 = 1;\n          }\n        }\n        else {\n          uVar6 = 3;\n        }\n        if (local_158 == (stat *)0x0) {\n          __ptr = (void *)0x0;\n          __ptr_00 = (void *)0x0;\n        }\n        else {\n          __ptr = (void *)uid_to_name(local_158->st_uid);\n          __ptr_00 = (void *)gid_to_name(local_158->st_gid);\n        }\n        if (*(long *)(param_7 + 6) == 0) {\n          if (param_3 == 0xffffffff) {\n            __ptr_01 = (void *)0x0;\n          }\n          else {\n            __ptr_01 = (void *)uid_to_str(param_3);\n          }\n        }\n        else {\n          __ptr_01 = *(void **)(param_7 + 6);\n        }\n        if (*(long *)(param_7 + 8) == 0) {\n          if (param_4 == 0xffffffff) {\n            __ptr_02 = (void *)0x0;\n          }\n          else {\n            __ptr_02 = (void *)gid_to_str(param_4);\n          }\n        }\n        else {\n          __ptr_02 = *(void **)(param_7 + 8);\n        }\n        describe_change(uVar7,uVar6,__ptr,__ptr_00,__ptr_01,__ptr_02);\n        free(__ptr);\n        free(__ptr_00);\n        if (__ptr_01 != *(void **)(param_7 + 6)) {\n          free(__ptr_01);\n        }\n        if (__ptr_02 != *(void **)(param_7 + 8)) {\n          free(__ptr_02);\n        }\n      }\n    }\n    if (*(char *)(param_7 + 1) != '\\x01') {\n      rpl_fts_set(param_1,param_2,4);\n    }\n  }\n  else {\n    cVar2 = streq(uVar7,&DAT_0010193e);\n    if (cVar2 == '\\0') {\n      uVar8 = quotearg_n_style(1,4,&DAT_0010193e);\n      uVar7 = quotearg_n_style(0,4,uVar7);\n      uVar9 = gettext(\"it is dangerous to operate recursively on %s (same as %s)\");\n      error(0,0,uVar9,uVar7,uVar8);\n    }\n    else {\n      uVar7 = quotearg_style(4,uVar7);\n      uVar8 = gettext(\"it is dangerous to operate recursively on %s\");\n      error(0,0,uVar8,uVar7);\n    }\n    uVar7 = gettext(\"use --no-preserve-root to override this failsafe\");\n    error(0,0,uVar7);\n    local_1c4 = false;\n  }\nLAB_00101557:\n  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {\n    return local_1c4;\n  }\n                    /* WARNING: Subroutine does not return */\n  __stack_chk_fail();\n}",
                "globals": [],
                "externs": [
                    "s"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "change_file_owner",
                        "streq",
                        "quotearg_n_style",
                        "gettext",
                        "s",
                        "error",
                        "quotearg_style",
                        "rpl_fts_set",
                        "rpl_fts_read",
                        "cycle_warning_required",
                        "quotearg_n_style_colon",
                        "fstatat",
                        "__errno_location",
                        "restricted_chown",
                        "chownat",
                        "lchownat",
                        "is_ENOTSUP",
                        "uid_to_name",
                        "gid_to_name",
                        "uid_to_str",
                        "gid_to_str",
                        "describe_change",
                        "free",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "change_file_owner",
                        "chown_files"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "chown_files",
                "func_c_signature": "bool chown_files(undefined8 param_1,uint param_2,undefined4 param_3,undefined4 param_4,int param_5,\n                int param_6,int *param_7)",
                "decompiled_code": "bool chown_files(undefined8 param_1,uint param_2,undefined4 param_3,undefined4 param_4,int param_5,\n                int param_6,int *param_7) {\n  byte bVar1;\n  uint uVar2;\n  int iVar3;\n  undefined8 uVar4;\n  long lVar5;\n  int *piVar6;\n  undefined8 uVar7;\n  bool local_4d;\n  \n  local_4d = true;\n  if ((((param_5 == -1) && (param_6 == -1)) && (*(char *)(param_7 + 4) == '\\0')) && (*param_7 == 2))\n  {\n    uVar2 = 8;\n  }\n  else {\n    uVar2 = 0;\n  }\n  uVar4 = xfts_open(param_1,param_2 | uVar2,0);\n  while( true ) {\n    lVar5 = rpl_fts_read(uVar4);\n    if (lVar5 == 0) break;\n    bVar1 = change_file_owner(uVar4,lVar5,param_3,param_4,param_5,param_6,param_7);\n    local_4d = (bVar1 & local_4d) != 0;\n  }\n  piVar6 = __errno_location();\n  if (*piVar6 != 0) {\n    if (*(char *)((long)param_7 + 0x11) != '\\x01') {\n      uVar7 = gettext(\"fts_read failed\");\n      piVar6 = __errno_location();\n      error(0,*piVar6,uVar7);\n    }\n    local_4d = false;\n  }\n  iVar3 = rpl_fts_close(uVar4);\n  if (iVar3 != 0) {\n    uVar4 = gettext(\"fts_close failed\");\n    piVar6 = __errno_location();\n    error(0,*piVar6,uVar4);\n    local_4d = false;\n  }\n  return local_4d;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "chown_files",
                        "xfts_open",
                        "rpl_fts_read",
                        "change_file_owner",
                        "__errno_location",
                        "gettext",
                        "error",
                        "rpl_fts_close"
                    ],
                    "calling_functions": [
                        "chown_files"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            },
            {
                "func_name": "xstrdup",
                "func_c_signature": "void xstrdup(void)",
                "decompiled_code": "void xstrdup(void) {\n                    /* WARNING: Bad instruction - Truncating control flow here */\n  halt_baddata();\n}",
                "globals": [],
                "externs": [
                    "halt_baddata"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "xstrdup",
                        "halt_baddata"
                    ],
                    "calling_functions": [
                        "uid_to_str",
                        "gid_to_str",
                        "gid_to_name",
                        "uid_to_name",
                        "user_group_str",
                        "xstrdup"
                    ],
                    "defined_in_file": "chown-core_decompiled.c"
                }
            }
        ]
    }
}