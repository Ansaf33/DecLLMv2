{
    "file": "CROMU_00030",
    "decompiled_code": {
        "game.c": [
            {
                "func_name": "getNextPieceNum",
                "func_c_signature": "int getNextPieceNum(void)",
                "decompiled_code": "int getNextPieceNum(void) {\n  int iVar1;\n  \n  if (game_stack._1152_4_ == -1) {\n    iVar1 = 0;\n  }\n  else {\n    iVar1 = (char)game_stack[game_stack._1152_4_ * 9] + 1;\n  }\n  return iVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "getNextPieceNum"
                    ],
                    "calling_functions": [
                        "getNextPieceNum",
                        "create_random_piece"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "create_random_piece",
                "func_c_signature": "undefined4 create_random_piece(undefined *param_1)",
                "decompiled_code": "undefined4 create_random_piece(undefined *param_1) {\n  undefined uVar1;\n  undefined4 uVar2;\n  int iVar3;\n  int local_18;\n  int local_14;\n  int local_10;\n  \n  if ((int)game_stack._1152_4_ < 0x80) {\n    iVar3 = isTopPiecePlaced();\n    if ((iVar3 == 0) && (0 < (int)game_stack._1152_4_)) {\n      uVar2 = 0x16;\n    }\n    else {\n      uVar1 = getNextPieceNum();\n      *param_1 = uVar1;\n      if (game_stack._1152_4_ == -1) {\n        iVar3 = random_in_range(1,3);\n        for (local_10 = 0; local_10 < 4; local_10 = local_10 + 1) {\n          if (local_10 == iVar3) {\n            param_1[local_10 * 2 + 1] = 0xfd;\n          }\n          else {\n            param_1[local_10 * 2 + 1] = 0xfc;\n          }\n        }\n      }\n      else {\n        iVar3 = random_in_range(0,3);\n        local_14 = iVar3;\n        while (local_14 == iVar3) {\n          local_14 = random_in_range(0,3);\n        }\n        for (local_18 = 0; local_18 < 4; local_18 = local_18 + 1) {\n          if ((local_18 == iVar3) || (local_18 == local_14)) {\n            param_1[local_18 * 2 + 1] = 0xfd;\n          }\n          else {\n            param_1[local_18 * 2 + 1] = 0xfc;\n          }\n        }\n      }\n      if ((int)game_stack._1152_4_ < 0) {\n        current_max_road_len = current_max_road_len + '\\x01';\n      }\n      push_piece(param_1);\n      uVar2 = 1;\n    }\n  }\n  else {\n    uVar2 = 0x21;\n  }\n  return uVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "create_random_piece",
                        "isTopPiecePlaced",
                        "getNextPieceNum",
                        "random_in_range",
                        "push_piece"
                    ],
                    "calling_functions": [
                        "create_random_piece",
                        "packet_handler"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "discard_piece",
                "func_c_signature": "undefined4 discard_piece(void)",
                "decompiled_code": "undefined4 discard_piece(void) {\n  undefined4 uVar1;\n  int iVar2;\n  \n  if ((int)game_stack._1152_4_ < 0) {\n    uVar1 = 0;\n  }\n  else {\n    iVar2 = isTopPiecePlaced();\n    if (iVar2 == 1) {\n      uVar1 = 0;\n    }\n    else {\n      game_stack._1152_4_ = game_stack._1152_4_ + -1;\n      uVar1 = 1;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "discard_piece",
                        "isTopPiecePlaced"
                    ],
                    "calling_functions": [
                        "discard_piece",
                        "packet_handler"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "connect_pieces",
                "func_c_signature": "undefined4 connect_pieces(undefined *param_1,char param_2,undefined *param_3,char param_4)",
                "decompiled_code": "undefined4 connect_pieces(undefined *param_1,char param_2,undefined *param_3,char param_4) {\n  undefined4 uVar1;\n  undefined local_1a [10];\n  int local_10;\n  \n  if ((param_1[param_2 * 2 + 1] == -3) && (param_3[param_4 * 2 + 1] == -3)) {\n    param_1[param_2 * 2 + 1] = *param_3;\n    param_1[param_2 * 2 + 2] = param_4;\n    param_3[param_4 * 2 + 1] = *param_1;\n    param_3[param_4 * 2 + 2] = param_2;\n    current_max_road_len = current_max_road_len + '\\x01';\n    uVar1 = 1;\n  }\n  else {\n    printf(\"a: @d, b: @d...\",(int)(char)param_1[param_2 * 2 + 1],(int)(char)param_3[param_4 * 2 + 1]\n          );\n    for (local_10 = 0; local_10 < (int)game_stack._1152_4_; local_10 = local_10 + 1) {\n      piece_to_pkt(game_stack + local_10 * 9,local_1a);\n      printf(\"piece @d: @s\",local_10,local_1a);\n    }\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "connect_pieces",
                        "printf",
                        "piece_to_pkt"
                    ],
                    "calling_functions": [
                        "connect_pieces",
                        "packet_handler"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "push_piece",
                "func_c_signature": "void push_piece(undefined *param_1)",
                "decompiled_code": "void push_piece(undefined *param_1) {\n  if ((int)game_stack._1152_4_ < 0x80) {\n    game_stack._1152_4_ = game_stack._1152_4_ + 1;\n    game_stack[game_stack._1152_4_ * 9] = *param_1;\n    game_stack[game_stack._1152_4_ * 9 + 1] = param_1[1];\n    game_stack[game_stack._1152_4_ * 9 + 2] = param_1[2];\n    game_stack[game_stack._1152_4_ * 9 + 3] = param_1[3];\n    game_stack[game_stack._1152_4_ * 9 + 4] = param_1[4];\n    game_stack[game_stack._1152_4_ * 9 + 5] = param_1[5];\n    game_stack[game_stack._1152_4_ * 9 + 6] = param_1[6];\n    game_stack[game_stack._1152_4_ * 9 + 7] = param_1[7];\n    game_stack[game_stack._1152_4_ * 9 + 8] = param_1[8];\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "push_piece"
                    ],
                    "calling_functions": [
                        "create_random_piece",
                        "push_piece"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "get_max_road_len",
                "func_c_signature": "int get_max_road_len(void)",
                "decompiled_code": "int get_max_road_len(void) {\n  return (int)current_max_road_len;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_max_road_len"
                    ],
                    "calling_functions": [
                        "get_max_road_len",
                        "check_win"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "isTopPiecePlaced",
                "func_c_signature": "undefined4 isTopPiecePlaced(void)",
                "decompiled_code": "undefined4 isTopPiecePlaced(void) {\n  undefined4 uVar1;\n  int local_10;\n  \n  if ((int)game_stack._1152_4_ < 0) {\n    uVar1 = 1;\n  }\n  else {\n    for (local_10 = 0; local_10 < 4; local_10 = local_10 + 1) {\n      if ((game_stack[game_stack._1152_4_ * 9 + local_10 * 2 + 1] != -4) &&\n         (game_stack[game_stack._1152_4_ * 9 + local_10 * 2 + 1] != -3)) {\n        return 1;\n      }\n    }\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "isTopPiecePlaced"
                    ],
                    "calling_functions": [
                        "create_random_piece",
                        "discard_piece",
                        "isTopPiecePlaced"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "piece_to_pkt",
                "func_c_signature": "void piece_to_pkt(char *param_1,char *param_2)",
                "decompiled_code": "void piece_to_pkt(char *param_1,char *param_2) {\n  *param_2 = *param_1 + '0';\n  if (param_1[1] == -3) {\n    param_2[1] = '0';\n    param_2[2] = 'y';\n  }\n  else {\n    param_2[1] = '0';\n    param_2[2] = 'n';\n  }\n  if (param_1[3] == -3) {\n    param_2[3] = '1';\n    param_2[4] = 'y';\n  }\n  else {\n    param_2[3] = '1';\n    param_2[4] = 'n';\n  }\n  if (param_1[5] == -3) {\n    param_2[5] = '2';\n    param_2[6] = 'y';\n  }\n  else {\n    param_2[5] = '2';\n    param_2[6] = 'n';\n  }\n  if (param_1[7] == -3) {\n    param_2[7] = '3';\n    param_2[8] = 'y';\n  }\n  else {\n    param_2[7] = '3';\n    param_2[8] = 'n';\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "piece_to_pkt"
                    ],
                    "calling_functions": [
                        "connect_pieces",
                        "piece_to_pkt",
                        "packet_handler"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "get_piece",
                "func_c_signature": "int get_piece(char param_1)",
                "decompiled_code": "int get_piece(char param_1) {\n  int local_c;\n  \n  local_c = 0;\n  while( true ) {\n    if ((int)game_stack._1152_4_ < local_c) {\n      return -1;\n    }\n    if (param_1 == game_stack[local_c * 9]) break;\n    local_c = local_c + 1;\n  }\n  return local_c;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_piece"
                    ],
                    "calling_functions": [
                        "get_piece",
                        "packet_handler"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            }
        ],
        "math_lib.c": [
            {
                "func_name": "seed_prng",
                "func_c_signature": "int seed_prng(void)",
                "decompiled_code": "int seed_prng(void) {\n  uint uVar1;\n  char local_12c [256];\n  int local_2c;\n  int local_28;\n  uint local_24;\n  uint local_20;\n  \n  bzero(local_12c,0x100);\n  printf(\"Enter crypto seed\\n\");\n  local_2c = receive_until(local_12c,10,0xff);\n  if (local_2c < 2) {\n    local_2c = 0;\n  }\n  else {\n    local_24 = 0xffffffff;\n    local_20 = 0xffffffff;\n    for (local_28 = 0; local_28 < local_2c; local_28 = local_28 + 1) {\n      uVar1 = local_24 >> 0x1c;\n      local_24 = (int)local_12c[local_28] ^ (local_24 << 4 | local_20 >> 0x1c);\n      local_20 = (int)local_12c[local_28] >> 0x1f ^ (local_20 << 4 | uVar1);\n    }\n    sprng(local_24,local_20);\n  }\n  return local_2c;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "seed_prng",
                        "bzero",
                        "printf",
                        "receive_until",
                        "sprng"
                    ],
                    "calling_functions": [
                        "seed_prng",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            }
        ],
        "packet.c": [
            {
                "func_name": "populate_packet",
                "func_c_signature": "undefined4 populate_packet(void *param_1,void *param_2,int param_3)",
                "decompiled_code": "undefined4 populate_packet(void *param_1,void *param_2,int param_3) {\n  undefined4 uVar1;\n  int iVar2;\n  \n  if (param_3 == 0x10) {\n    memcpy(param_1,param_2,0x10);\n    iVar2 = *(char *)((int)param_1 + 4) + -0x30;\n    if ((iVar2 < 0xb) && (-1 < iVar2)) {\n      uVar1 = 1;\n    }\n    else {\n      printf(\"length field outside valid range\\n\");\n      uVar1 = 0;\n    }\n  }\n  else {\n    printf(\"not proper packet length: got @d, should be @d\\n\",param_3,0x10);\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "populate_packet",
                        "memcpy",
                        "printf"
                    ],
                    "calling_functions": [
                        "populate_packet",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "validate_packet",
                "func_c_signature": "undefined4 validate_packet(char *param_1)",
                "decompiled_code": "undefined4 validate_packet(char *param_1) {\n  char cVar1;\n  undefined4 local_10;\n  \n  local_10 = 1;\n  if ((*param_1 < 'a') && ('c' < *param_1)) {\n    printf(\"type is out of range (@c)\\n\",(int)*param_1);\n    local_10 = 0;\n  }\n  if (*param_1 == 'c') {\n    if (('z' < param_1[1]) || (param_1[1] < 'v')) {\n      printf(\"data subtype is out of range (@c)\\n\",(int)param_1[1]);\n      local_10 = 0;\n    }\n  }\n  else if (('q' < param_1[1]) || (param_1[1] < 'd')) {\n    printf(\"subtype is out of range (@c)\\n\",(int)param_1[1]);\n    local_10 = 0;\n  }\n  if ((10 < param_1[4] + -0x30) || (param_1[4] + -0x30 < 0)) {\n    printf(\"length is out of range (@c)\\n\",(int)param_1[4]);\n    local_10 = 0;\n  }\n  if ((param_1[1] != 'd') && (param_1[3] + -0x30 != current_connection_number)) {\n    printf(\"connection number not valid: @c vs @c\\n\",(int)param_1[3],\n           current_connection_number + 0x30);\n    local_10 = 0;\n  }\n  cVar1 = get_checksum(param_1);\n  if (cVar1 != param_1[0xf]) {\n    printf(\"checksum does not match @c vs @d\",(int)cVar1,(int)param_1[0xf]);\n    printf(\"@s\\n\",param_1);\n    local_10 = 0;\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [
                    "range"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "validate_packet",
                        "printf",
                        "range",
                        "get_checksum"
                    ],
                    "calling_functions": [
                        "validate_packet",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "packet_handler",
                "func_c_signature": "undefined4 packet_handler(char *param_1)",
                "decompiled_code": "undefined4 packet_handler(char *param_1) {\n  int iVar1;\n  size_t sVar2;\n  undefined local_8a;\n  undefined local_89;\n  undefined auStack_85 [11];\n  undefined local_7a [9];\n  undefined local_71;\n  undefined local_70;\n  char acStack_6c [11];\n  undefined local_61;\n  undefined local_60;\n  char acStack_5c [11];\n  undefined local_51 [9];\n  undefined local_48;\n  undefined local_47;\n  char local_43 [9];\n  undefined local_3a;\n  char *local_38;\n  int local_34;\n  char *local_30;\n  char *local_2c;\n  int local_28;\n  int local_24;\n  char local_1e;\n  char local_1d;\n  \n  if (*param_1 == 'b') {\n    if (param_1[1] == 'd') {\n      send_assoc_response((int)(char)(param_1[5] + -0x30));\n      return 1;\n    }\n    if (param_1[1] == 'e') {\n      return 0;\n    }\n    if (param_1[1] == 'f') {\n      send_auth_response(param_1 + 5);\n      return 1;\n    }\n    if (param_1[1] == 'i') {\n      return 0;\n    }\n    if (param_1[1] == 'h') {\n      handle_auth_challenge_resp(param_1 + 5);\n      return 1;\n    }\n    if (param_1[1] == 'j') {\n      iVar1 = handle_disass_req((int)param_1[5]);\n      if (iVar1 == 0) {\n        printf(\"Failed disass\\n\");\n        return 2;\n      }\n      return 1;\n    }\n    if (param_1[1] == 'k') {\n      printf(\"Dissasociation response received\\n\");\n      return 0;\n    }\n    if (param_1[1] == 'l') {\n      iVar1 = handle_deauth_req((int)param_1[5]);\n      if (iVar1 == 0) {\n        printf(\"failed deauth...leaving\\n\");\n        return 2;\n      }\n      return 1;\n    }\n    if (param_1[1] == 'm') {\n      printf(\"Dissasociation response received\\n\");\n      return 0;\n    }\n  }\n  else if (*param_1 == 'c') {\n    if (param_1[2] + -0x30 != current_packet_count_recvd + 1) {\n      printf(\"packet number incorrect: @c vs @c\\n\",(int)param_1[2],current_packet_count_recvd + 0x31\n            );\n      send_nack((int)param_1[2],1);\n      return 0;\n    }\n    send_ack((int)param_1[2]);\n    if (param_1[1] == 'x') {\n      local_34 = create_random_piece(local_51);\n      if (local_34 == 1) {\n        piece_to_pkt(local_51,local_7a);\n        local_48 = 99;\n        local_47 = 0x78;\n        memcpy(local_43,local_7a,9);\n        local_3a = 0x30;\n        encrypt_data(local_43,10,current_encryption);\n        send_packet_new(&local_48,9);\n        return 1;\n      }\n      if (local_34 == 0x21) {\n        local_38 = \"nfull\";\n        local_48 = 99;\n        local_47 = 0x78;\n        sVar2 = strlen(\"nfull\");\n        strncpy(local_43,local_38,sVar2);\n        sVar2 = strlen(local_38);\n        send_packet_new(&local_48,sVar2);\n        return 1;\n      }\n      if (local_34 == 0x16) {\n        local_61 = 99;\n        local_60 = 0x78;\n        strncpy(acStack_5c,\"nusetop\",7);\n        send_packet_new(&local_61,7);\n        return 1;\n      }\n      local_71 = 99;\n      local_70 = 0x78;\n      strncpy(acStack_6c,\"nconfused\",9);\n      send_packet_new(&local_71,9);\n      return 1;\n    }\n    if (param_1[1] == 'z') {\n      if (current_encryption == 1) {\n        decrypt_packet(param_1 + 5,param_1[4] + -0x30,1);\n      }\n      else {\n        if (current_encryption != 2) {\n          return 0;\n        }\n        decrypt_packet(param_1 + 5,param_1[4] + -0x30,2);\n      }\n      if (param_1[4] != '5') {\n        return 0;\n      }\n      if ((int)game_stack._1152_4_ < 1) {\n        local_30 = \"NO,PCE\";\n        local_48 = 99;\n        local_47 = 0x7a;\n        memcpy(local_43,\"NO,PCE\",6);\n        send_packet_new(&local_48,6);\n        return 1;\n      }\n      local_1d = param_1[6];\n      local_1e = param_1[9];\n      local_24 = get_piece((int)(char)(param_1[5] + -0x30));\n      if (local_24 == -1) {\n        printf(\"Out of bounds piece requested A: @d vs @d...\\n\",param_1[5] + -0x30,\n               game_stack._1152_4_);\n        return 0;\n      }\n      local_28 = get_piece((int)(char)(param_1[8] + -0x30));\n      if (local_28 == -1) {\n        printf(\"Out of bounds piece requested B: @d vs @d...\\n\",param_1[8] + -0x30,\n               game_stack._1152_4_);\n        return 0;\n      }\n      iVar1 = connect_pieces(game_stack + local_24 * 9,(int)(char)(local_1d + -0x30),\n                             game_stack + local_28 * 9,(int)(char)(local_1e + -0x30));\n      if (iVar1 == 0) {\n        local_2c = \"NO,ERROR\";\n        local_8a = 99;\n        local_89 = 0x7a;\n        memcpy(auStack_85,\"NO,ERROR\",8);\n        send_packet_new(&local_8a,8);\n        return 1;\n      }\n      local_48 = 99;\n      local_47 = 0x7a;\n      local_43[0] = current_max_road_len + '0';\n      encrypt_data(local_43,10,current_encryption);\n      send_packet_new(&local_48,1);\n      return 1;\n    }\n    if (param_1[1] == 'w') {\n      local_48 = 99;\n      local_47 = 0x77;\n      local_43[0] = current_max_road_len + '0';\n      encrypt_data(local_43,10,current_encryption);\n      send_packet_new(&local_48,1);\n      return 1;\n    }\n    if (param_1[1] == 'v') {\n      iVar1 = discard_piece();\n      if (iVar1 == 1) {\n        local_48 = 99;\n        local_47 = 0x76;\n        local_43[0] = 'y';\n        send_packet_new(&local_48,1);\n        return 1;\n      }\n      local_48 = 99;\n      local_47 = 0x76;\n      strncpy(local_43,\"nplaced\",7);\n      send_packet_new(&local_48,7);\n      return 1;\n    }\n  }\n  return 1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "packet_handler",
                        "send_assoc_response",
                        "send_auth_response",
                        "handle_auth_challenge_resp",
                        "handle_disass_req",
                        "printf",
                        "handle_deauth_req",
                        "send_nack",
                        "send_ack",
                        "create_random_piece",
                        "piece_to_pkt",
                        "memcpy",
                        "encrypt_data",
                        "send_packet_new",
                        "strlen",
                        "strncpy",
                        "decrypt_packet",
                        "get_piece",
                        "connect_pieces",
                        "discard_piece"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_ack",
                "func_c_signature": "void send_ack(undefined param_1)",
                "decompiled_code": "void send_ack(undefined param_1) {\n  undefined local_1c;\n  undefined local_1b;\n  undefined local_17;\n  \n  local_17 = param_1;\n  local_1c = 0x61;\n  local_1b = 0x70;\n  current_packet_count_recvd = current_packet_count_recvd + 1;\n  send_packet_new(&local_1c,1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_ack",
                        "send_packet_new"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "send_ack"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_nack",
                "func_c_signature": "void send_nack(undefined param_1,char param_2)",
                "decompiled_code": "void send_nack(undefined param_1,char param_2) {\n  undefined local_1c;\n  undefined local_1b;\n  undefined local_17;\n  char local_16;\n  \n  local_17 = param_1;\n  local_1c = 0x61;\n  local_1b = 0x71;\n  local_16 = param_2 + '0';\n  current_packet_count_recvd = current_packet_count_recvd + 1;\n  send_packet_new(&local_1c,2);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_nack",
                        "send_packet_new"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "send_nack"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_assoc_response",
                "func_c_signature": "void send_assoc_response(char param_1)",
                "decompiled_code": "void send_assoc_response(char param_1) {\n  undefined local_2c;\n  undefined local_2b;\n  undefined local_27;\n  undefined local_1c;\n  undefined local_1b;\n  undefined local_17;\n  \n  if ((int)param_1 == last_connection_number + 1) {\n    last_connection_number = last_connection_number + 1;\n    current_packet_count_recvd = 0xffffffff;\n    current_connection_number = (int)param_1;\n    local_1c = 0x62;\n    local_1b = 0x65;\n    local_17 = 0x31;\n    send_packet_new(&local_1c,1);\n    printf(\"SUCCESSFUL association\\n\");\n  }\n  else {\n    local_2c = 0x62;\n    local_2b = 0x65;\n    local_27 = 0x30;\n    send_packet_new(&local_2c,1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_assoc_response",
                        "send_packet_new",
                        "printf"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "send_assoc_response"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_auth_response",
                "func_c_signature": "void send_auth_response(char *param_1)",
                "decompiled_code": "void send_auth_response(char *param_1) {\n  if (*param_1 == 'a') {\n    send_auth_challenge(1);\n  }\n  else if (*param_1 == 'x') {\n    send_auth_challenge(2);\n  }\n  else {\n    printf(\"AUTH RESP sent: fail\\n\");\n    printf(\"requested: @s, next: @c\\n\",param_1);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_auth_response",
                        "send_auth_challenge",
                        "printf"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "send_auth_response"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_auth_challenge",
                "func_c_signature": "void send_auth_challenge(undefined4 param_1)",
                "decompiled_code": "void send_auth_challenge(undefined4 param_1) {\n  undefined uVar1;\n  undefined local_25;\n  undefined local_24;\n  undefined auStack_20 [11];\n  undefined local_15 [5];\n  int local_10;\n  \n  enc_chal = 1;\n  for (local_10 = 0; local_10 < 5; local_10 = local_10 + 1) {\n    uVar1 = random_in_range(0x61,0x70);\n    local_15[local_10] = uVar1;\n  }\n  ram0x000184d1 = param_1;\n  local_25 = 0x62;\n  local_24 = 0x67;\n  memcpy(auStack_20,local_15,5);\n  send_packet_new(&local_25,5);\n  encrypt_data(local_15,5,param_1);\n  memcpy(&DAT_000184cc,local_15,5);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_auth_challenge",
                        "random_in_range",
                        "memcpy",
                        "send_packet_new",
                        "encrypt_data"
                    ],
                    "calling_functions": [
                        "send_auth_response",
                        "send_auth_challenge"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "handle_auth_challenge_resp",
                "func_c_signature": "undefined4 handle_auth_challenge_resp(int param_1)",
                "decompiled_code": "undefined4 handle_auth_challenge_resp(int param_1) {\n  undefined local_5c;\n  undefined local_5b;\n  undefined local_57;\n  undefined local_4c;\n  undefined local_4b;\n  undefined local_47;\n  undefined local_3c;\n  undefined local_3b;\n  undefined local_37;\n  undefined local_2c;\n  undefined local_2b;\n  undefined local_27;\n  int local_1c;\n  char local_15;\n  int local_14;\n  char local_d;\n  \n  if (ram0x000184d1 == 1) {\n    local_15 = '\\x01';\n    for (local_1c = 0; local_1c < 5; local_1c = local_1c + 1) {\n      if (*(char *)(param_1 + local_1c) != *(char *)((int)&DAT_000184cc + local_1c)) {\n        local_15 = '\\0';\n      }\n    }\n    if (local_15 != '\\0') {\n      enc_chal = 0;\n      local_4c = 0x62;\n      local_4b = 0x69;\n      local_47 = 0x31;\n      send_packet_new(&local_4c,1);\n      current_encryption = 1;\n      return 1;\n    }\n    printf(\"failed to match (@s)\",&DAT_000184cc);\n    local_5c = 0x62;\n    local_5b = 0x69;\n    local_57 = 0x30;\n    send_packet_new(&local_5c,1);\n  }\n  else {\n    if (ram0x000184d1 != 2) {\n      return 0;\n    }\n    local_d = '\\x01';\n    for (local_14 = 0; local_14 < 5; local_14 = local_14 + 1) {\n      if (*(char *)(param_1 + local_14) != *(char *)((int)&DAT_000184cc + local_14)) {\n        local_d = '\\0';\n      }\n    }\n    if (local_d != '\\0') {\n      enc_chal = 0;\n      local_2c = 0x62;\n      local_2b = 0x69;\n      local_27 = 0x31;\n      send_packet_new(&local_2c,1);\n      current_encryption = 2;\n      return 1;\n    }\n    printf(\"failed to match (@s)\",&DAT_000184cc);\n    local_3c = 0x62;\n    local_3b = 0x69;\n    local_37 = 0x30;\n    send_packet_new(&local_3c,1);\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [
                    "match"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_auth_challenge_resp",
                        "send_packet_new",
                        "printf",
                        "match"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "handle_auth_challenge_resp"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "handle_disass_req",
                "func_c_signature": "undefined4 handle_disass_req(char param_1)",
                "decompiled_code": "undefined4 handle_disass_req(char param_1) {\n  undefined4 uVar1;\n  undefined local_2c;\n  undefined local_2b;\n  undefined local_27;\n  undefined local_1c;\n  undefined local_1b;\n  undefined local_17;\n  \n  if ((current_encryption == -1) && (encryption_confirmed == 0)) {\n    if (param_1 == '3') {\n      local_2c = 0x62;\n      local_2b = 0x6b;\n      local_27 = 0x31;\n      send_packet_new(&local_2c,1);\n      current_packet_count_recvd = 0xffffffff;\n      current_packet_count_sent = 0xffffffff;\n      last_connection_number = current_connection_number;\n      current_connection_number = 0xffffffff;\n      uVar1 = 1;\n    }\n    else {\n      local_1c = 0x62;\n      local_1b = 0x6b;\n      local_17 = 0x30;\n      send_packet_new(&local_1c,1);\n      uVar1 = 0;\n    }\n  }\n  else {\n    printf(\"FAILED1\\n\");\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_disass_req",
                        "send_packet_new",
                        "printf"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "handle_disass_req"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "handle_deauth_req",
                "func_c_signature": "bool handle_deauth_req(char param_1)",
                "decompiled_code": "bool handle_deauth_req(char param_1) {\n  undefined local_2c;\n  undefined local_2b;\n  undefined local_27;\n  undefined local_1c;\n  undefined local_1b;\n  undefined local_17;\n  \n  if (param_1 == '7') {\n    local_2c = 0x62;\n    local_2b = 0x6d;\n    local_27 = 0x31;\n    send_packet_new(&local_2c,1);\n    current_encryption = 0xffffffff;\n    encryption_confirmed = 0;\n  }\n  else {\n    local_1c = 0x62;\n    local_1b = 0x6d;\n    local_17 = 0x30;\n    send_packet_new(&local_1c,1);\n  }\n  return param_1 == '7';\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "handle_deauth_req",
                        "send_packet_new"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "handle_deauth_req"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_packet",
                "func_c_signature": "void send_packet(int param_1)",
                "decompiled_code": "void send_packet(int param_1) {\n  size_t in_stack_ffffffec;\n  \n  write(param_1,(void *)0x10,in_stack_ffffffec);\n  printf(\"\\n\");\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_packet",
                        "write",
                        "printf"
                    ],
                    "calling_functions": [
                        "send_packet"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "send_packet_new",
                "func_c_signature": "void send_packet_new(char *param_1,int param_2)",
                "decompiled_code": "void send_packet_new(char *param_1,int param_2) {\n  size_t in_stack_ffffffdc;\n  int local_10;\n  \n  if (*param_1 == 'c') {\n    current_packet_count_sent = current_packet_count_sent + 1;\n    param_1[2] = (char)current_packet_count_sent + '0';\n  }\n  else {\n    param_1[2] = '0';\n  }\n  param_1[3] = (char)current_connection_number + '0';\n  for (local_10 = param_2; local_10 < 10; local_10 = local_10 + 1) {\n    param_1[local_10 + 5] = '0';\n  }\n  param_1[4] = (char)param_2 + '0';\n  set_checksum(param_1);\n  write((int)param_1,(void *)0x10,in_stack_ffffffdc);\n  printf(\"\\n\");\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "send_packet_new",
                        "set_checksum",
                        "write",
                        "printf"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "send_ack",
                        "send_nack",
                        "send_assoc_response",
                        "send_auth_challenge",
                        "handle_auth_challenge_resp",
                        "handle_disass_req",
                        "handle_deauth_req",
                        "send_packet_new"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "calculateCS",
                "func_c_signature": "byte calculateCS(int param_1,int param_2)",
                "decompiled_code": "byte calculateCS(int param_1,int param_2) {\n  int local_c;\n  byte local_5;\n  \n  local_5 = 0;\n  for (local_c = 0; local_c < param_2; local_c = local_c + 1) {\n    local_5 = local_5 ^ *(byte *)(param_1 + local_c);\n  }\n  return local_5;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "calculateCS"
                    ],
                    "calling_functions": [
                        "calculateCS",
                        "set_checksum",
                        "get_checksum"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "set_checksum",
                "func_c_signature": "void set_checksum(int param_1)",
                "decompiled_code": "void set_checksum(int param_1) {\n  undefined uVar1;\n  \n  uVar1 = calculateCS(param_1,0xf);\n  *(undefined *)(param_1 + 0xf) = uVar1;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "set_checksum",
                        "calculateCS"
                    ],
                    "calling_functions": [
                        "send_packet_new",
                        "set_checksum"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "get_checksum",
                "func_c_signature": "void get_checksum(undefined4 param_1)",
                "decompiled_code": "void get_checksum(undefined4 param_1) {\n  calculateCS(param_1,0xf);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_checksum",
                        "calculateCS"
                    ],
                    "calling_functions": [
                        "validate_packet",
                        "get_checksum"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "locate_char",
                "func_c_signature": "int locate_char(char param_1)",
                "decompiled_code": "int locate_char(char param_1) {\n  int local_8;\n  \n  local_8 = 0;\n  while( true ) {\n    if (LAST_CHAR_POS <= local_8) {\n      return -1;\n    }\n    if (param_1 == VALID_CHARS[local_8]) break;\n    local_8 = local_8 + 1;\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "locate_char"
                    ],
                    "calling_functions": [
                        "locate_char",
                        "encrypt_data",
                        "decrypt_packet"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "encrypt_data",
                "func_c_signature": "undefined4 encrypt_data(int param_1,int param_2,int param_3)",
                "decompiled_code": "undefined4 encrypt_data(int param_1,int param_2,int param_3) {\n  int iVar1;\n  char local_19;\n  uint local_18;\n  char local_11;\n  uint local_10;\n  \n  if (param_3 == 2) {\n    for (local_10 = 0; (int)local_10 < param_2; local_10 = local_10 + 1) {\n      iVar1 = locate_char((int)*(char *)(param_1 + local_10));\n      if (iVar1 == -1) {\n        return 0;\n      }\n      if ((local_10 & 1) == 0) {\n        *(undefined *)(local_10 + param_1) = VALID_CHARS[(iVar1 + offset) % LAST_CHAR_POS];\n      }\n      else {\n        local_11 = (char)iVar1 - (char)offset;\n        if (local_11 < '\\0') {\n          local_11 = ((char)iVar1 - (char)offset) + (char)LAST_CHAR_POS;\n        }\n        *(undefined *)(param_1 + local_10) = VALID_CHARS[local_11];\n      }\n    }\n  }\n  if (param_3 == 1) {\n    for (local_18 = 0; (int)local_18 < param_2; local_18 = local_18 + 1) {\n      iVar1 = locate_char((int)*(char *)(param_1 + local_18));\n      if (iVar1 == -1) {\n        return 0;\n      }\n      if ((local_18 & 1) == 0) {\n        local_19 = (char)iVar1 - (char)offset;\n        if (local_19 < '\\0') {\n          local_19 = ((char)iVar1 - (char)offset) + (char)LAST_CHAR_POS;\n        }\n        *(undefined *)(param_1 + local_18) = VALID_CHARS[local_19];\n      }\n      else {\n        *(undefined *)(local_18 + param_1) = VALID_CHARS[(iVar1 + offset) % LAST_CHAR_POS];\n      }\n    }\n  }\n  return 1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "encrypt_data",
                        "locate_char"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "send_auth_challenge",
                        "encrypt_data"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "decrypt_packet",
                "func_c_signature": "undefined4 decrypt_packet(int param_1,int param_2,int param_3)",
                "decompiled_code": "undefined4 decrypt_packet(int param_1,int param_2,int param_3) {\n  int iVar1;\n  char local_19;\n  uint local_18;\n  char local_11;\n  uint local_10;\n  \n  if (param_3 == 2) {\n    for (local_10 = 0; (int)local_10 < param_2; local_10 = local_10 + 1) {\n      iVar1 = locate_char((int)*(char *)(param_1 + local_10));\n      if (iVar1 == -1) {\n        return 0;\n      }\n      if ((local_10 & 1) == 0) {\n        local_11 = (char)iVar1 - (char)offset;\n        if (local_11 < '\\0') {\n          local_11 = ((char)iVar1 - (char)offset) + (char)LAST_CHAR_POS;\n        }\n        *(undefined *)(param_1 + local_10) = VALID_CHARS[local_11];\n      }\n      else {\n        *(undefined *)(local_10 + param_1) = VALID_CHARS[(iVar1 + offset) % LAST_CHAR_POS];\n      }\n    }\n  }\n  if (param_3 == 1) {\n    for (local_18 = 0; (int)local_18 < param_2; local_18 = local_18 + 1) {\n      iVar1 = locate_char((int)*(char *)(param_1 + local_18));\n      if (iVar1 == -1) {\n        return 0;\n      }\n      if ((local_18 & 1) == 0) {\n        *(undefined *)(local_18 + param_1) = VALID_CHARS[(iVar1 + offset) % LAST_CHAR_POS];\n      }\n      else {\n        local_19 = (char)iVar1 - (char)offset;\n        if (local_19 < '\\0') {\n          local_19 = ((char)iVar1 - (char)offset) + (char)LAST_CHAR_POS;\n        }\n        *(undefined *)(param_1 + local_18) = VALID_CHARS[local_19];\n      }\n    }\n  }\n  return 1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "decrypt_packet",
                        "locate_char"
                    ],
                    "calling_functions": [
                        "packet_handler",
                        "decrypt_packet"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            },
            {
                "func_name": "check_win",
                "func_c_signature": "bool check_win(int param_1)",
                "decompiled_code": "bool check_win(int param_1) {\n  int iVar1;\n  undefined local_15 [5];\n  int local_10;\n  \n  iVar1 = get_max_road_len();\n  if (param_1 <= iVar1) {\n    printf(\"YOU WIN, what is your name?\\n\");\n    local_10 = receive_until(local_15,10,0x19);\n    local_15[local_10] = 0;\n    printf(\"Well done, @s\\n\",local_15);\n  }\n  return param_1 <= iVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "check_win",
                        "get_max_road_len",
                        "printf",
                        "receive_until"
                    ],
                    "calling_functions": [
                        "check_win",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            }
        ],
        "service.c": [
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  int iVar1;\n  undefined local_13d [29];\n  char local_120 [256];\n  int local_20;\n  int local_1c;\n  int local_18;\n  int local_14;\n  undefined *local_10;\n  \n  local_10 = &stack0x00000004;\n  printf(\"go time\\n\");\n  current_packet_count_recvd = 0xffffffff;\n  current_packet_count_sent = 0xffffffff;\n  last_connection_number = 0xffffffff;\n  current_connection_number = 0xffffffff;\n  current_encryption = 0xffffffff;\n  encryption_confirmed = 0;\n  enc_chal = 0;\n  DAT_000184cc = 0;\n  DAT_000184d0 = 0;\n  DAT_000184d4 = 0;\n  game_stack._1152_4_ = 0xffffffff;\n  local_14 = 0;\n  local_18 = seed_prng();\n  iVar1 = local_18;\n  if (local_18 == 0) {\n    printf(\"didn\\'t succeed in seeding prng()\");\n  }\n  else {\n    do {\n      while( true ) {\n        while( true ) {\n          while( true ) {\n            while( true ) {\n              seed_length = iVar1;\n              printf(\"ready for next packet\\n\");\n              iVar1 = check_win(goal_len);\n              if (iVar1 == 1) {\n                printf(\"Good game\\n\");\n                return 1;\n              }\n              if (2 < local_14) {\n                printf(\"good bye\\n\");\n                return 0;\n              }\n              local_1c = receive_until(local_120,10,0xff);\n              iVar1 = strcmp(local_120,\"1212\");\n              if (iVar1 == 0) {\n                printf(\"good bye\\n\");\n                return 1;\n              }\n              if (local_1c == 0x10) break;\n              printf(\"not proper packet length: got @d, should be @d\\n\",local_1c,0x10);\n              printf(\"I got: @s\\n\",local_120);\n              local_14 = local_14 + 1;\n              iVar1 = seed_length;\n            }\n            iVar1 = populate_packet(local_13d,local_120,0x10);\n            if (iVar1 != 0) break;\n            local_14 = local_14 + 1;\n            iVar1 = seed_length;\n          }\n          local_20 = validate_packet(local_13d);\n          if (local_20 != 0) break;\n          printf(\"skipping packet processing due to malformed packet\\n\");\n          local_14 = local_14 + 1;\n          iVar1 = seed_length;\n        }\n        local_20 = packet_handler(local_13d);\n        iVar1 = seed_length;\n        if (local_20 != 0) break;\n        local_14 = local_14 + 1;\n      }\n    } while (local_20 != 2);\n    printf(\"exiting main loop\\n\");\n  }\n  return 1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "printf",
                        "seed_prng",
                        "prng",
                        "check_win",
                        "receive_until",
                        "strcmp",
                        "populate_packet",
                        "validate_packet",
                        "packet_handler"
                    ],
                    "calling_functions": [
                        "_start",
                        "main"
                    ],
                    "defined_in_file": "CROMU_00030_decompiled.c"
                }
            }
        ]
    }
}