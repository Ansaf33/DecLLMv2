{
    "file": "temp-stream",
    "decompiled_code": {
        "temp-stream.c": [
            {
                "func_name": "record_or_unlink_tempfile",
                "func_c_signature": "void record_or_unlink_tempfile(char *param_1)",
                "decompiled_code": "void record_or_unlink_tempfile(char *param_1) {\n  unlink(param_1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "record_or_unlink_tempfile",
                        "unlink"
                    ],
                    "calling_functions": [
                        "record_or_unlink_tempfile",
                        "temp_stream"
                    ],
                    "defined_in_file": "temp-stream_decompiled.c"
                }
            },
            {
                "func_name": "temp_stream",
                "func_c_signature": "undefined8 temp_stream(FILE **param_1,char **param_2)",
                "decompiled_code": "undefined8 temp_stream(FILE **param_1,char **param_2) {\n  int iVar1;\n  undefined8 uVar2;\n  int *piVar3;\n  undefined8 uVar4;\n  char *local_50;\n  ulong local_48;\n  \n  if (tempfile_1 == (char *)0x0) {\n    local_50 = (char *)0x0;\n    local_48 = 0x80;\n    while (local_50 = (char *)rpl_realloc(local_50,local_48), local_50 != (char *)0x0) {\n      iVar1 = path_search(local_50,local_48,0,\"cutmp\",1);\n      if (iVar1 == 0) {\n        tempfile_1 = local_50;\n        iVar1 = mkstemp_safer(local_50);\n        if (iVar1 < 0) {\n          uVar2 = quotearg_style(4,tempfile_1);\n          uVar4 = gettext(\"failed to create temporary file %s\");\n          piVar3 = __errno_location();\n          error(0,*piVar3,uVar4,uVar2);\n        }\n        else {\n          tmp_fp_0 = fdopen(iVar1,\"w+\");\n          if (tmp_fp_0 != (FILE *)0x0) {\n            record_or_unlink_tempfile(tempfile_1,tmp_fp_0);\n            goto LAB_00100376;\n          }\n          uVar2 = quotearg_style(4,tempfile_1);\n          uVar4 = gettext(\"failed to open %s for writing\");\n          piVar3 = __errno_location();\n          error(0,*piVar3,uVar4,uVar2);\n          close(iVar1);\n          unlink(tempfile_1);\n        }\n        free(tempfile_1);\n        tempfile_1 = (char *)0x0;\n        return 0;\n      }\n      piVar3 = __errno_location();\n      if ((*piVar3 != 0x16) || (0x800 < local_48)) {\n        uVar2 = gettext(\"failed to make temporary file name\");\n        piVar3 = __errno_location();\n        if (*piVar3 == 0x16) {\n          iVar1 = 0x24;\n        }\n        else {\n          piVar3 = __errno_location();\n          iVar1 = *piVar3;\n        }\n        error(0,iVar1,uVar2);\n        return 0;\n      }\n      local_48 = local_48 << 1;\n    }\n    uVar2 = gettext(\"failed to make temporary file name\");\n    piVar3 = __errno_location();\n    error(0,*piVar3,uVar2);\n  }\n  else {\n    clearerr_unlocked(tmp_fp_0);\n    iVar1 = rpl_fseeko(tmp_fp_0,0,0);\n    if (-1 < iVar1) {\n      iVar1 = fileno_unlocked(tmp_fp_0);\n      iVar1 = ftruncate(iVar1,0);\n      if (-1 < iVar1) {\nLAB_00100376:\n        *param_1 = tmp_fp_0;\n        if (param_2 != (char **)0x0) {\n          *param_2 = tempfile_1;\n        }\n        return 1;\n      }\n    }\n    uVar2 = quotearg_style(4,tempfile_1);\n    uVar4 = gettext(\"failed to rewind stream for %s\");\n    piVar3 = __errno_location();\n    error(0,*piVar3,uVar4,uVar2);\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "temp_stream",
                        "rpl_realloc",
                        "path_search",
                        "mkstemp_safer",
                        "quotearg_style",
                        "gettext",
                        "__errno_location",
                        "error",
                        "fdopen",
                        "record_or_unlink_tempfile",
                        "close",
                        "unlink",
                        "free",
                        "clearerr_unlocked",
                        "rpl_fseeko",
                        "fileno_unlocked",
                        "ftruncate"
                    ],
                    "calling_functions": [
                        "temp_stream"
                    ],
                    "defined_in_file": "temp-stream_decompiled.c"
                }
            }
        ]
    }
}