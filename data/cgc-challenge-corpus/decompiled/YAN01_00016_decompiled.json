{
    "file": "YAN01_00016",
    "decompiled_code": {
        "main.c": [
            {
                "func_name": "isValidAddr",
                "func_c_signature": "bool isValidAddr(uint param_1)",
                "decompiled_code": "bool isValidAddr(uint param_1) {\n  int iVar1;\n  bool bVar2;\n  \n  if ((param_1 < 0x1000) || (param_1 < 0x1000)) {\n    bVar2 = false;\n  }\n  else {\n    iVar1 = fdwait(0xffffffff,0,0,param_1,0);\n    bVar2 = iVar1 != 2;\n  }\n  return bVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "isValidAddr",
                        "fdwait"
                    ],
                    "calling_functions": [
                        "isValidAddr",
                        "HASH"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "xorHash",
                "func_c_signature": "undefined4 xorHash(int param_1,uint param_2,int param_3)",
                "decompiled_code": "undefined4 xorHash(int param_1,uint param_2,int param_3) {\n  uint local_c;\n  \n  for (local_c = 0; local_c < 0x80; local_c = local_c + 1) {\n    if (local_c < param_2) {\n      *(byte *)(local_c + param_3) = *(byte *)(local_c + param_3) ^ *(byte *)(local_c + param_1);\n    }\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "xorHash"
                    ],
                    "calling_functions": [
                        "xorHash",
                        "HASH",
                        "EXTEND",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "HASH",
                "func_c_signature": "int HASH(uint param_1,int param_2,int param_3)",
                "decompiled_code": "int HASH(uint param_1,int param_2,int param_3) {\n  int iVar1;\n  undefined4 uVar2;\n  uint local_14;\n  uint local_10;\n  \n  uVar2 = 0x110c0;\n  if ((param_1 == 0) || (param_3 == 0)) {\n    iVar1 = -1;\n  }\n  else {\n    for (local_14 = 0; local_14 < 0x80; local_14 = local_14 + 1) {\n      *(undefined *)(local_14 + param_3) = 0;\n    }\n    local_14 = 0;\n    local_10 = param_1;\n    while (local_10 < param_2 + param_1) {\n      iVar1 = isValidAddr(local_10);\n      if (iVar1 == 0) {\n        local_10 = local_10 + 0x1000 & 0xfffff000;\n      }\n      else {\n        iVar1 = xorHash(local_10,param_2 - local_14,param_3,uVar2);\n        if (iVar1 != 0) {\n          return iVar1;\n        }\n        local_10 = local_10 + 0x80;\n        local_14 = local_14 + 0x80;\n      }\n    }\n    iVar1 = 0;\n  }\n  return iVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "HASH",
                        "isValidAddr",
                        "xorHash"
                    ],
                    "calling_functions": [
                        "HASH",
                        "EXTEND"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "EXTEND",
                "func_c_signature": "undefined4 EXTEND(int param_1,uint param_2,uint param_3)",
                "decompiled_code": "undefined4 EXTEND(int param_1,uint param_2,uint param_3) {\n  undefined4 uVar1;\n  undefined local_90 [128];\n  int local_10;\n  \n  if (param_2 < param_3) {\n    local_10 = param_3 - param_2;\n    HASH(param_2,local_10,local_90);\n    xorHash(local_90,0x80,gPCRs + param_1 * 0x80);\n    uVar1 = 0;\n  }\n  else {\n    uVar1 = 0xffffffff;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "EXTEND",
                        "HASH",
                        "xorHash"
                    ],
                    "calling_functions": [
                        "EXTEND",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "INIT",
                "func_c_signature": "undefined4 INIT(int param_1,undefined param_2)",
                "decompiled_code": "undefined4 INIT(int param_1,undefined param_2) {\n  undefined4 uVar1;\n  uint local_8;\n  \n  if (param_1 == 0) {\n    uVar1 = 0xffffffff;\n  }\n  else {\n    for (local_8 = 0; local_8 < 0x80; local_8 = local_8 + 1) {\n      *(undefined *)(param_1 + local_8) = param_2;\n    }\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "INIT"
                    ],
                    "calling_functions": [
                        "INIT",
                        "ZERO",
                        "RESET",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "ZERO",
                "func_c_signature": "undefined4 ZERO(uint param_1)",
                "decompiled_code": "undefined4 ZERO(uint param_1) {\n  undefined4 uVar1;\n  \n  if (param_1 < 8) {\n    uVar1 = INIT(gPCRs + param_1 * 0x80,0);\n  }\n  else {\n    uVar1 = 0xffffffff;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "ZERO",
                        "INIT"
                    ],
                    "calling_functions": [
                        "ZERO",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "RESET",
                "func_c_signature": "int RESET(void)",
                "decompiled_code": "int RESET(void) {\n  int iVar1;\n  uint local_c;\n  \n  local_c = 0;\n  while( true ) {\n    if (7 < local_c) {\n      return 0;\n    }\n    iVar1 = INIT(gPCRs + local_c * 0x80,(int)(char)local_c);\n    if (iVar1 != 0) break;\n    local_c = local_c + 1;\n  }\n  return iVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "RESET",
                        "INIT"
                    ],
                    "calling_functions": [
                        "RESET",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "hexStrToUint32",
                "func_c_signature": "uint hexStrToUint32(int param_1)",
                "decompiled_code": "uint hexStrToUint32(int param_1) {\n  uint local_10;\n  uint local_c;\n  int local_8;\n  \n  local_c = 0;\n  local_8 = 0;\n  do {\n    if (*(char *)(param_1 + local_8) == '\\0') {\n      return local_c;\n    }\n    if ((*(char *)(param_1 + local_8) < '0') || ('9' < *(char *)(param_1 + local_8))) {\n      if ((*(char *)(param_1 + local_8) < 'A') || ('F' < *(char *)(param_1 + local_8))) {\n        if ((*(char *)(param_1 + local_8) < 'a') || ('f' < *(char *)(param_1 + local_8))) {\n          return 0;\n        }\n        local_10 = (int)*(char *)(param_1 + local_8) - 0x57;\n      }\n      else {\n        local_10 = (int)*(char *)(param_1 + local_8) - 0x37;\n      }\n    }\n    else {\n      local_10 = (int)*(char *)(param_1 + local_8) - 0x30;\n    }\n    local_c = local_c << 4 | local_10 & 0xf;\n    local_8 = local_8 + 1;\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "hexStrToUint32"
                    ],
                    "calling_functions": [
                        "hexStrToUint32",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "hashToHexStr",
                "func_c_signature": "void hashToHexStr(int param_1,int param_2)",
                "decompiled_code": "void hashToHexStr(int param_1,int param_2) {\n  char cVar1;\n  int local_c;\n  \n  for (local_c = 0; local_c < 0x80; local_c = local_c + 1) {\n    cVar1 = *(char *)(param_1 + local_c);\n    *(undefined1 *)(param_2 + local_c * 2) = gNibToHexChar[(int)(cVar1 >> 4) & 0xf];\n    *(undefined1 *)(param_2 + local_c * 2 + 1) = gNibToHexChar[(int)cVar1 & 0xf];\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "hashToHexStr"
                    ],
                    "calling_functions": [
                        "hashToHexStr",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "findChar",
                "func_c_signature": "int findChar(int param_1,char param_2)",
                "decompiled_code": "int findChar(int param_1,char param_2) {\n  int local_8;\n  \n  for (local_8 = 0;\n      (param_2 != *(char *)(local_8 + param_1) && (*(char *)(local_8 + param_1) != '\\0'));\n      local_8 = local_8 + 1) {\n  }\n  if (*(char *)(local_8 + param_1) == '\\0') {\n    local_8 = -1;\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "findChar"
                    ],
                    "calling_functions": [
                        "findChar",
                        "main"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  int iVar1;\n  undefined local_26d [256];\n  undefined local_16d;\n  undefined local_16c [128];\n  undefined local_ec [127];\n  char acStack_6d [64];\n  undefined local_2d;\n  uint local_2c;\n  uint local_28;\n  int local_24;\n  int local_20;\n  uint local_1c;\n  uint local_18;\n  uint local_14;\n  undefined *local_10;\n  \n  local_10 = &stack0x00000004;\n  local_1c = 0;\n  local_20 = 0;\n  local_24 = 0;\n  local_14 = 0;\n  local_18 = 0;\nLAB_00011510:\n  do {\n    do {\n      local_14 = receive_until(0,acStack_6d + 1,0x80,10);\n      local_2d = 0;\n      acStack_6d[local_14] = '\\0';\n      iVar1 = (int)acStack_6d[1];\n    } while (iVar1 == 0);\n    if (iVar1 < 0) {\n      return 0;\n    }\n    if (0x5a < iVar1) {\n      return 0;\n    }\n    if (iVar1 < 0x45) {\n      return 0;\n    }\n    switch(iVar1) {\n    case 0x45:\n      local_20 = findChar(acStack_6d + 1,0x20);\n      if ((local_20 != -1) && (iVar1 = findChar(acStack_6d + local_20 + 2,0x20), iVar1 != -1)) {\n        local_24 = iVar1 + local_20 + 1;\n        acStack_6d[iVar1 + local_20 + 2] = '\\0';\n        local_1c = hexStrToUint32(acStack_6d + local_20 + 2);\n        iVar1 = findChar(acStack_6d + local_24 + 2,0x20);\n        if (iVar1 == -1) {\n          return 0;\n        }\n        local_20 = iVar1 + local_24 + 1;\n        acStack_6d[iVar1 + local_24 + 2] = '\\0';\n        local_28 = hexStrToUint32(acStack_6d + local_24 + 2);\n        iVar1 = hexStrToUint32(acStack_6d + local_20 + 2);\n        local_2c = iVar1 + local_28;\n        if (local_2c <= local_28) {\n          return 0;\n        }\n        EXTEND(local_1c,local_28,local_2c);\n        break;\n      }\n    default:\n      return 0;\n    case 0x48:\n      local_20 = findChar(acStack_6d + 1,0x20);\n      if (local_20 == -1) {\n        return 0;\n      }\n      local_1c = hexStrToUint32(acStack_6d + local_20 + 2);\n      if (local_1c == 0xffffffff) {\n        return 0;\n      }\n      INIT(local_ec,0);\n      for (local_18 = 0; local_18 < local_1c; local_18 = local_18 + local_14) {\n        local_14 = local_1c - local_18;\n        if (local_14 < 0x80) {\n          receive_all(0,local_16c,local_14);\n        }\n        else {\n          local_14 = 0x80;\n          receive_all(0,local_16c,0x80);\n        }\n        xorHash(local_16c,local_14,local_ec);\n      }\n      hashToHexStr(local_ec,local_26d);\n      local_16d = 10;\n      transmit_all(1,local_26d,0x101);\n      break;\n    case 0x50:\n      local_20 = findChar(acStack_6d + 1,0x20);\n      if (local_20 == -1) {\n        return 0;\n      }\n      local_1c = hexStrToUint32(acStack_6d + local_20 + 2);\n      if (7 < local_1c) {\n        return 0;\n      }\n      hashToHexStr(gPCRs + local_1c * 0x80,local_26d);\n      local_16d = 10;\n      transmit_all(1,local_26d,0x101);\n      break;\n    case 0x52:\n      RESET();\n      break;\n    case 0x5a:\n      goto _L58;\n    }\n  } while( true );\n_L58:\n  local_20 = findChar(acStack_6d + 1,0x20);\n  if (local_20 == -1) {\n    return 0;\n  }\n  local_1c = hexStrToUint32(acStack_6d + local_20 + 2);\n  ZERO(local_1c);\n  goto LAB_00011510;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "receive_until",
                        "findChar",
                        "hexStrToUint32",
                        "EXTEND",
                        "INIT",
                        "receive_all",
                        "xorHash",
                        "hashToHexStr",
                        "transmit_all",
                        "RESET",
                        "ZERO"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "YAN01_00016_decompiled.c"
                }
            }
        ]
    }
}