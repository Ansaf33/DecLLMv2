{
    "file": "uname",
    "decompiled_code": {
        "uname.c": [
            {
                "func_name": "usage",
                "func_c_signature": "void usage(int param_1)",
                "decompiled_code": "void usage(int param_1) {\n  FILE *pFVar1;\n  undefined8 uVar2;\n  char *pcVar3;\n  \n  uVar2 = _program_name;\n  if (param_1 == 0) {\n    pcVar3 = (char *)gettext(\"Usage: %s [OPTION]...\\n\");\n    printf(pcVar3,uVar2);\n    pFVar1 = _stdout;\n    if (_uname_mode == 1) {\n      pcVar3 = (char *)gettext(\n                              \"Print certain system information.  With no OPTION, same as -s.\\n\\n  -a, --all                print all information, in the following order,\\n                             except omit -p and -i if unknown:\\n  -s, --kernel-name        print the kernel name\\n  -n, --nodename           print the network node hostname\\n  -r, --kernel-release     print the kernel release\\n\"\n                              );\n      fputs_unlocked(pcVar3,pFVar1);\n      pFVar1 = _stdout;\n      pcVar3 = (char *)gettext(\n                              \"  -v, --kernel-version     print the kernel version\\n  -m, --machine            print the machine hardware name\\n  -p, --processor          print the processor type (non-portable)\\n  -i, --hardware-platform  print the hardware platform (non-portable)\\n  -o, --operating-system   print the operating system\\n\"\n                              );\n      fputs_unlocked(pcVar3,pFVar1);\n    }\n    else {\n      pcVar3 = (char *)gettext(\"Print machine architecture.\\n\\n\");\n      fputs_unlocked(pcVar3,pFVar1);\n    }\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --help        display this help and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --version     output version information and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    if (_uname_mode == 1) {\n      pcVar3 = \"uname\";\n    }\n    else {\n      pcVar3 = \"arch\";\n    }\n    emit_ancillary_info(pcVar3);\n  }\n  else {\n    pcVar3 = (char *)gettext(\"Try \\'%s --help\\' for more information.\\n\");\n    fprintf(_stderr,pcVar3,uVar2);\n  }\n                    /* WARNING: Subroutine does not return */\n  exit(param_1);\n}",
                "globals": [],
                "externs": [
                    "type",
                    "platform"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "usage",
                        "gettext",
                        "printf",
                        "fputs_unlocked",
                        "type",
                        "platform",
                        "emit_ancillary_info",
                        "fprintf",
                        "exit"
                    ],
                    "calling_functions": [
                        "usage",
                        "decode_switches"
                    ],
                    "defined_in_file": "uname_decompiled.c"
                }
            },
            {
                "func_name": "print_element",
                "func_c_signature": "void print_element(char *param_1)",
                "decompiled_code": "void print_element(char *param_1) {\n  if (printed_1 != '\\0') {\n    putchar_unlocked(0x20);\n  }\n  printed_1 = 1;\n  fputs_unlocked(param_1,_stdout);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "print_element",
                        "putchar_unlocked",
                        "fputs_unlocked"
                    ],
                    "calling_functions": [
                        "print_element",
                        "print_element_env",
                        "main"
                    ],
                    "defined_in_file": "uname_decompiled.c"
                }
            },
            {
                "func_name": "print_element_env",
                "func_c_signature": "void print_element_env(undefined8 param_1)",
                "decompiled_code": "void print_element_env(undefined8 param_1) {\n  print_element(param_1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "print_element_env",
                        "print_element"
                    ],
                    "calling_functions": [
                        "print_element_env",
                        "main"
                    ],
                    "defined_in_file": "uname_decompiled.c"
                }
            },
            {
                "func_name": "decode_switches",
                "func_c_signature": "uint decode_switches(int param_1,long param_2)",
                "decompiled_code": "uint decode_switches(int param_1,long param_2) {\n  int iVar1;\n  char *pcVar2;\n  undefined8 uVar3;\n  undefined8 uVar4;\n  uint local_30;\n  \n  local_30 = 0;\n  if (_uname_mode == 2) {\n    while (iVar1 = getopt_long(param_1,param_2,&DAT_00100af4,arch_long_options,0), iVar1 != -1) {\n      if (iVar1 == -0x83) {\nLAB_00100472:\n        if (_uname_mode == 1) {\n          pcVar2 = \"uname\";\n        }\n        else {\n          pcVar2 = \"arch\";\n        }\n        version_etc(_stdout,pcVar2,\"GNU coreutils\",_Version,\"David MacKenzie\",\"Karel Zak\",0);\n                    /* WARNING: Subroutine does not return */\n        exit(0);\n      }\n      if (iVar1 == -0x82) {\n        usage(0);\n        goto LAB_00100472;\n      }\n      usage(1);\n    }\n    local_30 = 0x10;\n  }\n  else {\n    while (iVar1 = getopt_long(param_1,param_2,\"asnrvmpio\",uname_long_options,0), iVar1 != -1) {\n      if (iVar1 < 0x77) {\n        if (iVar1 < 0x61) {\n          if (iVar1 == -0x83) {\nLAB_001005de:\n            uVar3 = proper_name_lite(\"David MacKenzie\",\"David MacKenzie\");\n            if (_uname_mode == 1) {\n              pcVar2 = \"uname\";\n            }\n            else {\n              pcVar2 = \"arch\";\n            }\n            version_etc(_stdout,pcVar2,\"GNU coreutils\",_Version,uVar3,0);\n                    /* WARNING: Subroutine does not return */\n            exit(0);\n          }\n          if (iVar1 == -0x82) {\n            usage(0);\n            goto LAB_001005de;\n          }\n          goto switchD_0010057a_caseD_62;\n        }\n        switch(iVar1) {\n        case 0x61:\n          local_30 = 0xffffffff;\n          break;\n        default:\n          goto switchD_0010057a_caseD_62;\n        case 0x69:\n          local_30 = local_30 | 0x40;\n          break;\n        case 0x6d:\n          local_30 = local_30 | 0x10;\n          break;\n        case 0x6e:\n          local_30 = local_30 | 2;\n          break;\n        case 0x6f:\n          local_30 = local_30 | 0x80;\n          break;\n        case 0x70:\n          local_30 = local_30 | 0x20;\n          break;\n        case 0x72:\n          local_30 = local_30 | 4;\n          break;\n        case 0x73:\n          local_30 = local_30 | 1;\n          break;\n        case 0x76:\n          local_30 = local_30 | 8;\n        }\n      }\n      else {\nswitchD_0010057a_caseD_62:\n        usage(1);\n      }\n    }\n  }\n  if (param_1 != _optind) {\n    uVar3 = quote(*(undefined8 *)(param_2 + (long)_optind * 8));\n    uVar4 = gettext(\"extra operand %s\");\n    error(0,0,uVar4,uVar3);\n    usage(1);\n  }\n  return local_30;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "decode_switches",
                        "getopt_long",
                        "version_etc",
                        "exit",
                        "usage",
                        "proper_name_lite",
                        "quote",
                        "gettext",
                        "error"
                    ],
                    "calling_functions": [
                        "decode_switches",
                        "main"
                    ],
                    "defined_in_file": "uname_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined8 main(undefined4 param_1,undefined8 *param_2)",
                "decompiled_code": "undefined8 main(undefined4 param_1,undefined8 *param_2) {\n  int iVar1;\n  undefined8 uVar2;\n  int *piVar3;\n  long in_FS_OFFSET;\n  uint local_1cc;\n  utsname local_1a8;\n  long local_20;\n  \n  local_20 = *(long *)(in_FS_OFFSET + 0x28);\n  set_program_name(*param_2);\n  setlocale(6,\"\");\n  bindtextdomain(\"coreutils\",\"/usr/local/share/locale\");\n  textdomain(\"coreutils\");\n  atexit((__func *)&close_stdout);\n  local_1cc = decode_switches(param_1,param_2);\n  if (local_1cc == 0) {\n    local_1cc = 1;\n  }\n  if ((local_1cc & 0x1f) != 0) {\n    iVar1 = uname(&local_1a8);\n    if (iVar1 == -1) {\n      uVar2 = gettext(\"cannot get system name\");\n      piVar3 = __errno_location();\n      error(1,*piVar3,uVar2);\n    }\n    if ((local_1cc & 1) != 0) {\n      print_element_env(&local_1a8,\"UNAME_SYSNAME\");\n    }\n    if ((local_1cc & 2) != 0) {\n      print_element_env(local_1a8.nodename,\"UNAME_NODENAME\");\n    }\n    if ((local_1cc & 4) != 0) {\n      print_element_env(local_1a8.release,\"UNAME_RELEASE\");\n    }\n    if ((local_1cc & 8) != 0) {\n      print_element_env(local_1a8.version,\"UNAME_VERSION\");\n    }\n    if ((local_1cc & 0x10) != 0) {\n      print_element_env(local_1a8.machine,\"UNAME_MACHINE\");\n    }\n  }\n  if (((local_1cc & 0x20) != 0) && (local_1cc != 0xffffffff)) {\n    print_element(\"unknown\");\n  }\n  if (((local_1cc & 0x40) != 0) && (local_1cc != 0xffffffff)) {\n    print_element(\"unknown\");\n  }\n  if ((local_1cc & 0x80) != 0) {\n    print_element(\"GNU/Linux\");\n  }\n  putchar_unlocked(10);\n  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "set_program_name",
                        "setlocale",
                        "bindtextdomain",
                        "textdomain",
                        "atexit",
                        "decode_switches",
                        "uname",
                        "gettext",
                        "__errno_location",
                        "error",
                        "print_element_env",
                        "print_element",
                        "putchar_unlocked",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "main"
                    ],
                    "defined_in_file": "uname_decompiled.c"
                }
            }
        ]
    }
}