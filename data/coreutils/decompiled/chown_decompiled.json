{
    "file": "chown",
    "decompiled_code": {
        "chown.c": [
            {
                "func_name": "usage",
                "func_c_signature": "void usage(int param_1)",
                "decompiled_code": "void usage(int param_1) {\n  FILE *pFVar1;\n  undefined8 uVar2;\n  undefined8 uVar3;\n  char *pcVar4;\n  undefined8 uVar5;\n  \n  uVar2 = _program_name;\n  if (param_1 == 0) {\n    if (_chown_mode == 1) {\n      uVar5 = gettext(\"[OWNER][:[GROUP]]\");\n    }\n    else {\n      uVar5 = gettext(\"GROUP\");\n    }\n    uVar3 = _program_name;\n    pcVar4 = (char *)gettext(\n                            \"Usage: %s [OPTION]... %s FILE...\\n  or:  %s [OPTION]... --reference=RFILE FILE...\\n\"\n                            );\n    printf(pcVar4,uVar3,uVar5,uVar2);\n    pFVar1 = _stdout;\n    if (_chown_mode == 1) {\n      pcVar4 = (char *)gettext(\n                              \"Change the owner and/or group of each FILE to OWNER and/or GROUP.\\nWith --reference, change the owner and group of each FILE to those of RFILE.\\n\\n\"\n                              );\n      fputs_unlocked(pcVar4,pFVar1);\n    }\n    else {\n      pcVar4 = (char *)gettext(\n                              \"Change the group of each FILE to GROUP.\\nWith --reference, change the group of each FILE to that of RFILE.\\n\\n\"\n                              );\n      fputs_unlocked(pcVar4,pFVar1);\n    }\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"  -c, --changes          like verbose but report only when a change is made\\n  -f, --silent, --quiet  suppress most error messages\\n  -v, --verbose          output a diagnostic for every file processed\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"      --dereference      affect the referent of each symbolic link (this is\\n                         the default), rather than the symbolic link itself\\n  -h, --no-dereference   affect symbolic links instead of any referenced file\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"                         (useful only on systems that can change the\\n                         ownership of a symlink)\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"      --from=CURRENT_OWNER:CURRENT_GROUP\\n                         change the ownership of each file only if\\n                         its current owner and/or group match those specified\\n                         here. Either may be omitted, in which case a match\\n                         is not required for the omitted attribute\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"      --no-preserve-root  do not treat \\'/\\' specially (the default)\\n      --preserve-root    fail to operate recursively on \\'/\\'\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"      --reference=RFILE  use RFILE\\'s ownership rather than specifying values.\\n                         RFILE is always dereferenced if a symbolic link.\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\n                            \"  -R, --recursive        operate on files and directories recursively\\n\"\n                            );\n    fputs_unlocked(pcVar4,pFVar1);\n    emit_symlink_recurse_options(&DAT_0010193f);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\"      --help        display this help and exit\\n\");\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    pcVar4 = (char *)gettext(\"      --version     output version information and exit\\n\");\n    fputs_unlocked(pcVar4,pFVar1);\n    pFVar1 = _stdout;\n    if (_chown_mode == 1) {\n      pcVar4 = (char *)gettext(\n                              \"\\nOwner is unchanged if missing.  Group is unchanged if missing, but changed\\nto login group if implied by a \\':\\' following a symbolic OWNER.\\nOWNER and GROUP may be numeric as well as symbolic.\\n\"\n                              );\n      fputs_unlocked(pcVar4,pFVar1);\n    }\n    uVar2 = _program_name;\n    if (_chown_mode == 1) {\n      pcVar4 = (char *)gettext(\n                              \"\\nExamples:\\n  %s root /u        Change the owner of /u to \\\"root\\\".\\n  %s root:staff /u  Likewise, but also change its group to \\\"staff\\\".\\n  %s -hR root /u    Change the owner of /u and subfiles to \\\"root\\\".\\n\"\n                              );\n      printf(pcVar4,uVar2,uVar2,uVar2);\n    }\n    else {\n      pcVar4 = (char *)gettext(\n                              \"\\nExamples:\\n  %s staff /u      Change the group of /u to \\\"staff\\\".\\n  %s -hR staff /u  Change the group of /u and subfiles to \\\"staff\\\".\\n\"\n                              );\n      printf(pcVar4,uVar2,uVar2);\n    }\n    if (_chown_mode == 1) {\n      pcVar4 = \"chown\";\n    }\n    else {\n      pcVar4 = \"chgrp\";\n    }\n    emit_ancillary_info(pcVar4);\n  }\n  else {\n    pcVar4 = (char *)gettext(\"Try \\'%s --help\\' for more information.\\n\");\n    fprintf(_stderr,pcVar4,uVar2);\n  }\n                    /* WARNING: Subroutine does not return */\n  exit(param_1);\n}",
                "globals": [],
                "externs": [
                    "link",
                    "specially"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "usage",
                        "gettext",
                        "printf",
                        "fputs_unlocked",
                        "link",
                        "specially",
                        "emit_symlink_recurse_options",
                        "emit_ancillary_info",
                        "fprintf",
                        "exit"
                    ],
                    "calling_functions": [
                        "usage",
                        "main"
                    ],
                    "defined_in_file": "chown_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "void main(int param_1,undefined8 *param_2)",
                "decompiled_code": "void main(int param_1,undefined8 *param_2) {\n  int iVar1;\n  char *pcVar2;\n  undefined8 uVar3;\n  undefined8 uVar4;\n  int *piVar5;\n  size_t sVar6;\n  long in_FS_OFFSET;\n  byte local_197;\n  char local_196;\n  byte local_195;\n  __uid_t local_194;\n  __gid_t local_190;\n  undefined4 local_18c;\n  undefined4 local_188;\n  uint local_184;\n  int local_180;\n  int local_17c;\n  uint local_178;\n  uint local_174;\n  uint local_170;\n  undefined4 local_16c;\n  undefined4 local_168;\n  undefined4 local_164;\n  undefined4 local_160;\n  undefined4 local_15c;\n  undefined4 local_158;\n  undefined4 local_154;\n  undefined4 local_150;\n  int local_14c;\n  uint local_148;\n  undefined4 local_144;\n  undefined4 local_140;\n  int local_13c;\n  undefined2 *local_138;\n  long local_130;\n  long local_128;\n  char *local_120;\n  undefined8 local_118;\n  undefined8 local_110;\n  undefined8 local_108;\n  undefined8 local_100;\n  char *local_f8;\n  undefined8 local_f0;\n  undefined4 local_e8;\n  char local_e4;\n  long local_e0;\n  undefined local_d8;\n  undefined local_d7;\n  long local_d0;\n  long local_c8 [2];\n  stat local_b8;\n  undefined8 local_20;\n  \n  local_20 = *(undefined8 *)(in_FS_OFFSET + 0x28);\n  local_196 = '\\0';\n  local_194 = 0xffffffff;\n  local_190 = 0xffffffff;\n  local_18c = 0xffffffff;\n  local_188 = 0xffffffff;\n  local_184 = 0x10;\n  local_180 = -1;\n  set_program_name(*param_2);\n  setlocale(6,\"\");\n  bindtextdomain(\"coreutils\",\"/usr/local/share/locale\");\n  textdomain(\"coreutils\");\n  atexit((__func *)&close_stdout);\n  chopt_init(&local_e8);\n  do {\n    while( true ) {\n      local_17c = getopt_long(param_1,param_2,\"HLPRcfhv\",long_options,0);\n      if (local_17c == -1) {\n        if (local_e4 == '\\0') {\n          local_184 = 0x10;\n        }\n        else if (local_184 == 0x10) {\n          if (local_180 == 1) {\n            local_118 = gettext(\"-R --dereference requires either -H or -L\");\n            local_168 = 1;\n            local_164 = 0;\n            error(1,0,local_118);\n          }\n          local_180 = 0;\n        }\n        local_d8 = local_180 != 0;\n        if (reference_file == (char *)0x0) {\n          iVar1 = 2;\n        }\n        else {\n          iVar1 = 1;\n        }\n        if (param_1 - _optind < iVar1) {\n          if (_optind < param_1) {\n            uVar3 = quote(param_2[(long)param_1 + -1]);\n            local_108 = gettext(\"missing operand after %s\");\n            local_158 = 0;\n            local_154 = 0;\n            error(0,0,local_108,uVar3);\n          }\n          else {\n            local_110 = gettext(\"missing operand\");\n            local_160 = 0;\n            local_15c = 0;\n            error(0,0,local_110);\n          }\n          usage(1);\n        }\n        if (reference_file == (char *)0x0) {\n          local_138 = (undefined2 *)param_2[_optind];\n          if (_chown_mode == 2) {\n            sVar6 = strlen((char *)param_2[_optind]);\n            local_138 = (undefined2 *)xmalloc(sVar6 + 2);\n            pcVar2 = (char *)param_2[_optind];\n            *local_138 = 0x3a;\n            strcpy((char *)((long)local_138 + 1),pcVar2);\n          }\n          local_130 = parse_user_spec_warn\n                                (local_138,&local_194,&local_190,&local_d0,local_c8,&local_197);\n          if (local_138 != (undefined2 *)param_2[_optind]) {\n            free(local_138);\n          }\n          if (local_130 != 0) {\n            local_178 = (uint)(local_197 ^ 1);\n            uVar3 = quote(param_2[_optind]);\n            local_148 = local_178;\n            local_144 = 0;\n            local_f8 = \"%s: %s\";\n            error(local_178,0,\"%s: %s\",local_130,uVar3);\n          }\n          if (((_chown_mode == 1) && (local_d0 == 0)) && (local_c8[0] != 0)) {\n            local_d0 = xstrdup(&DAT_00101204);\n          }\n          _optind = _optind + 1;\n        }\n        else {\n          iVar1 = stat(reference_file,&local_b8);\n          if (iVar1 != 0) {\n            uVar3 = quotearg_style(4,reference_file);\n            uVar4 = gettext(\"failed to get attributes of %s\");\n            piVar5 = __errno_location();\n            local_14c = *piVar5;\n            local_150 = 1;\n            local_100 = uVar4;\n            error(1,local_14c,uVar4,uVar3);\n          }\n          if (_chown_mode == 1) {\n            local_194 = local_b8.st_uid;\n            local_d0 = uid_to_name(local_b8.st_uid);\n          }\n          local_190 = local_b8.st_gid;\n          local_c8[0] = gid_to_name(local_b8.st_gid);\n        }\n        if (((local_e4 != '\\0') && (local_196 != '\\0')) &&\n           (local_e0 = get_root_dev_ino(dev_ino_buf_0), local_e0 == 0)) {\n          uVar3 = quotearg_style(4,&DAT_00101ca7);\n          uVar4 = gettext(\"failed to get attributes of %s\");\n          piVar5 = __errno_location();\n          local_13c = *piVar5;\n          local_140 = 1;\n          local_f0 = uVar4;\n          error(1,local_13c,uVar4,uVar3);\n        }\n        local_184 = local_184 | 0x400;\n        local_195 = chown_files(param_2 + _optind,local_184,local_194,local_190,local_18c,local_188,\n                                &local_e8);\n                    /* WARNING: Subroutine does not return */\n        exit((uint)(local_195 ^ 1));\n      }\n      if (local_17c < 0x85) break;\nswitchD_00100700_caseD_49:\n      usage(1);\n    }\n    if (local_17c < 0x48) {\n      if (local_17c == -0x83) {\nLAB_0010087f:\n        uVar3 = proper_name_lite(\"Jim Meyering\",\"Jim Meyering\");\n        uVar4 = proper_name_lite(\"David MacKenzie\",\"David MacKenzie\");\n        if (_chown_mode == 1) {\n          pcVar2 = \"chown\";\n        }\n        else {\n          pcVar2 = \"chgrp\";\n        }\n        version_etc(_stdout,pcVar2,\"GNU coreutils\",_Version,uVar4,uVar3,0);\n                    /* WARNING: Subroutine does not return */\n        exit(0);\n      }\n      if (local_17c == -0x82) {\n        usage(0);\n        goto LAB_0010087f;\n      }\n      goto switchD_00100700_caseD_49;\n    }\n    switch(local_17c) {\n    case 0x48:\n      local_184 = 0x11;\n      break;\n    default:\n      goto switchD_00100700_caseD_49;\n    case 0x4c:\n      local_184 = 2;\n      break;\n    case 0x50:\n      local_184 = 0x10;\n      break;\n    case 0x52:\n      local_e4 = '\\x01';\n      break;\n    case 99:\n      local_e8 = 1;\n      break;\n    case 0x66:\n      local_d7 = 1;\n      break;\n    case 0x68:\n      local_180 = 0;\n      break;\n    case 0x76:\n      local_e8 = 0;\n      break;\n    case 0x80:\n      local_180 = 1;\n      break;\n    case 0x81:\n      local_128 = parse_user_spec_warn(_optarg,&local_18c,&local_188,0,0,&local_197);\n      if (local_128 != 0) {\n        local_174 = (uint)(local_197 ^ 1);\n        uVar3 = quote(_optarg);\n        local_170 = local_174;\n        local_16c = 0;\n        local_120 = \"%s: %s\";\n        error(local_174,0,\"%s: %s\",local_128,uVar3);\n      }\n      break;\n    case 0x82:\n      local_196 = '\\0';\n      break;\n    case 0x83:\n      local_196 = '\\x01';\n      break;\n    case 0x84:\n      reference_file = _optarg;\n    }\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "set_program_name",
                        "setlocale",
                        "bindtextdomain",
                        "textdomain",
                        "atexit",
                        "chopt_init",
                        "getopt_long",
                        "gettext",
                        "error",
                        "quote",
                        "usage",
                        "strlen",
                        "xmalloc",
                        "strcpy",
                        "parse_user_spec_warn",
                        "free",
                        "xstrdup",
                        "stat",
                        "quotearg_style",
                        "__errno_location",
                        "uid_to_name",
                        "gid_to_name",
                        "get_root_dev_ino",
                        "chown_files",
                        "exit",
                        "proper_name_lite",
                        "version_etc"
                    ],
                    "calling_functions": [
                        "main"
                    ],
                    "defined_in_file": "chown_decompiled.c"
                }
            }
        ]
    }
}