{
    "file": "sum",
    "decompiled_code": {
        "sum.c": [
            {
                "func_name": "bsd_sum_stream",
                "func_c_signature": "undefined4 bsd_sum_stream(FILE *param_1,uint *param_2,long *param_3)",
                "decompiled_code": "undefined4 bsd_sum_stream(FILE *param_1,uint *param_2,long *param_3) {\n  long lVar1;\n  int iVar2;\n  void *__ptr;\n  size_t sVar3;\n  int *piVar4;\n  long in_FS_OFFSET;\n  uint local_48;\n  undefined4 local_44;\n  ulong local_40;\n  ulong local_38;\n  ulong local_30;\n  ulong local_28;\n  \n  lVar1 = *(long *)(in_FS_OFFSET + 0x28);\n  local_44 = 0xffffffff;\n  local_48 = 0;\n  local_38 = 0;\n  __ptr = malloc(buffer_length_1);\n  if (__ptr != (void *)0x0) {\n    do {\n      local_40 = 0;\nLAB_0010007d:\n      sVar3 = fread_unlocked((void *)((long)__ptr + local_40),1,buffer_length_1 - local_40,param_1);\n      local_40 = local_40 + sVar3;\n      if (local_40 != buffer_length_1) {\n        if (sVar3 != 0) goto LAB_001000e1;\n        iVar2 = ferror_unlocked(param_1);\n        if (iVar2 == 0) goto LAB_0010017a;\n        goto LAB_0010020b;\n      }\n      for (local_30 = 0; local_30 < local_40; local_30 = local_30 + 1) {\n        local_48 = (local_48 & 1) * 0x8000 + ((int)local_48 >> 1) +\n                   (uint)*(byte *)(local_30 + (long)__ptr) & 0xffff;\n      }\n      if (local_40 + local_38 < local_38) goto code_r0x00100159;\n      local_38 = local_38 + local_40;\n    } while( true );\n  }\n  local_44 = 0xffffffff;\n  goto LAB_0010021a;\ncode_r0x00100159:\n  piVar4 = __errno_location();\n  *piVar4 = 0x4b;\n  goto LAB_0010020b;\nLAB_001000e1:\n  iVar2 = feof_unlocked(param_1);\n  if (iVar2 == 0) goto LAB_0010007d;\nLAB_0010017a:\n  for (local_28 = 0; local_28 < local_40; local_28 = local_28 + 1) {\n    local_48 = (local_48 & 1) * 0x8000 + ((int)local_48 >> 1) +\n               (uint)*(byte *)(local_28 + (long)__ptr) & 0xffff;\n  }\n  if (local_40 + local_38 < local_38) {\n    piVar4 = __errno_location();\n    *piVar4 = 0x4b;\n  }\n  else {\n    *param_2 = local_48;\n    *param_3 = local_38 + local_40;\n    local_44 = 0;\n  }\nLAB_0010020b:\n  free(__ptr);\nLAB_0010021a:\n  if (lVar1 == *(long *)(in_FS_OFFSET + 0x28)) {\n    return local_44;\n  }\n                    /* WARNING: Subroutine does not return */\n  __stack_chk_fail();\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "bsd_sum_stream",
                        "malloc",
                        "fread_unlocked",
                        "ferror_unlocked",
                        "__errno_location",
                        "feof_unlocked",
                        "free",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "bsd_sum_stream"
                    ],
                    "defined_in_file": "sum_decompiled.c"
                }
            },
            {
                "func_name": "sysv_sum_stream",
                "func_c_signature": "undefined4 sysv_sum_stream(FILE *param_1,int *param_2,long *param_3)",
                "decompiled_code": "undefined4 sysv_sum_stream(FILE *param_1,int *param_2,long *param_3) {\n  long lVar1;\n  int iVar2;\n  uint uVar3;\n  void *__ptr;\n  size_t sVar4;\n  int *piVar5;\n  long in_FS_OFFSET;\n  undefined4 local_4c;\n  uint local_48;\n  ulong local_40;\n  ulong local_38;\n  ulong local_30;\n  ulong local_28;\n  \n  lVar1 = *(long *)(in_FS_OFFSET + 0x28);\n  local_4c = 0xffffffff;\n  local_38 = 0;\n  __ptr = malloc(buffer_length_0);\n  if (__ptr != (void *)0x0) {\n    local_48 = 0;\n    do {\n      local_40 = 0;\nLAB_00100299:\n      sVar4 = fread_unlocked((void *)((long)__ptr + local_40),1,buffer_length_0 - local_40,param_1);\n      local_40 = local_40 + sVar4;\n      if (local_40 != buffer_length_0) {\n        if (sVar4 != 0) goto LAB_001002f9;\n        iVar2 = ferror_unlocked(param_1);\n        if (iVar2 == 0) goto LAB_0010036b;\n        goto LAB_001003fb;\n      }\n      for (local_30 = 0; local_30 < local_40; local_30 = local_30 + 1) {\n        local_48 = local_48 + *(byte *)(local_30 + (long)__ptr);\n      }\n      if (local_40 + local_38 < local_38) goto code_r0x0010034a;\n      local_38 = local_38 + local_40;\n    } while( true );\n  }\n  local_4c = 0xffffffff;\n  goto LAB_0010040a;\ncode_r0x0010034a:\n  piVar5 = __errno_location();\n  *piVar5 = 0x4b;\n  goto LAB_001003fb;\nLAB_001002f9:\n  iVar2 = feof_unlocked(param_1);\n  if (iVar2 == 0) goto LAB_00100299;\nLAB_0010036b:\n  for (local_28 = 0; local_28 < local_40; local_28 = local_28 + 1) {\n    local_48 = local_48 + *(byte *)(local_28 + (long)__ptr);\n  }\n  if (local_40 + local_38 < local_38) {\n    piVar5 = __errno_location();\n    *piVar5 = 0x4b;\n  }\n  else {\n    uVar3 = (local_48 & 0xffff) + (local_48 >> 0x10);\n    *param_2 = (uVar3 & 0xffff) + ((int)uVar3 >> 0x10);\n    *param_3 = local_38 + local_40;\n    local_4c = 0;\n  }\nLAB_001003fb:\n  free(__ptr);\nLAB_0010040a:\n  if (lVar1 == *(long *)(in_FS_OFFSET + 0x28)) {\n    return local_4c;\n  }\n                    /* WARNING: Subroutine does not return */\n  __stack_chk_fail();\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "sysv_sum_stream",
                        "malloc",
                        "fread_unlocked",
                        "ferror_unlocked",
                        "__errno_location",
                        "feof_unlocked",
                        "free",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "sysv_sum_stream"
                    ],
                    "defined_in_file": "sum_decompiled.c"
                }
            },
            {
                "func_name": "output_bsd",
                "func_c_signature": "void output_bsd(undefined8 param_1,undefined8 param_2,uint *param_3,char param_4,undefined8 param_5,\n               byte param_6,char param_7,undefined8 param_8)",
                "decompiled_code": "void output_bsd(undefined8 param_1,undefined8 param_2,uint *param_3,char param_4,undefined8 param_5,\n               byte param_6,char param_7,undefined8 param_8) {\n  undefined8 uVar1;\n  long in_FS_OFFSET;\n  undefined2 local_2aa;\n  undefined local_2a8 [664];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  if (param_4 == '\\0') {\n    uVar1 = human_readable(param_8,local_2a8,0,1,0x400);\n    printf(\"%05d %5s\",(ulong)*param_3,uVar1);\n    if (param_7 != '\\0') {\n      printf(\" %s\",param_1);\n    }\n    putchar_unlocked((uint)param_6);\n  }\n  else {\n    local_2aa = (undefined2)*param_3;\n    local_2aa = __bswap_16(local_2aa);\n    fwrite_unlocked(&local_2aa,1,2,_stdout);\n  }\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "output_bsd",
                        "human_readable",
                        "printf",
                        "putchar_unlocked",
                        "__bswap_16",
                        "fwrite_unlocked",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "output_bsd"
                    ],
                    "defined_in_file": "sum_decompiled.c"
                }
            },
            {
                "func_name": "output_sysv",
                "func_c_signature": "void output_sysv(undefined8 param_1,undefined8 param_2,uint *param_3,char param_4,undefined8 param_5\n                ,byte param_6,char param_7,undefined8 param_8)",
                "decompiled_code": "void output_sysv(undefined8 param_1,undefined8 param_2,uint *param_3,char param_4,undefined8 param_5\n                ,byte param_6,char param_7,undefined8 param_8) {\n  undefined8 uVar1;\n  long in_FS_OFFSET;\n  undefined2 local_2aa;\n  undefined local_2a8 [664];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  if (param_4 == '\\0') {\n    uVar1 = human_readable(param_8,local_2a8,0,1,0x200);\n    printf(\"%d %s\",(ulong)*param_3,uVar1);\n    if (param_7 != '\\0') {\n      printf(\" %s\",param_1);\n    }\n    putchar_unlocked((uint)param_6);\n  }\n  else {\n    local_2aa = (undefined2)*param_3;\n    local_2aa = __bswap_16(local_2aa);\n    fwrite_unlocked(&local_2aa,1,2,_stdout);\n  }\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "output_sysv",
                        "human_readable",
                        "printf",
                        "putchar_unlocked",
                        "__bswap_16",
                        "fwrite_unlocked",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "output_sysv"
                    ],
                    "defined_in_file": "sum_decompiled.c"
                }
            }
        ]
    }
}