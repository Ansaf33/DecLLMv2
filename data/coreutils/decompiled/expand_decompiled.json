{
    "file": "expand",
    "decompiled_code": {
        "expand.c": [
            {
                "func_name": "usage",
                "func_c_signature": "void usage(int param_1)",
                "decompiled_code": "void usage(int param_1) {\n  FILE *pFVar1;\n  undefined8 uVar2;\n  char *pcVar3;\n  \n  uVar2 = _program_name;\n  if (param_1 == 0) {\n    pcVar3 = (char *)gettext(\"Usage: %s [OPTION]... [FILE]...\\n\");\n    printf(pcVar3,uVar2);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"Convert tabs in each FILE to spaces, writing to standard output.\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    emit_stdin_note();\n    emit_mandatory_arg_note();\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\n                            \"  -i, --initial    do not convert tabs after non blanks\\n  -t, --tabs=N     have tabs N characters apart, not 8\\n\"\n                            );\n    fputs_unlocked(pcVar3,pFVar1);\n    emit_tab_list_info();\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --help        display this help and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --version     output version information and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    emit_ancillary_info(\"expand\");\n  }\n  else {\n    pcVar3 = (char *)gettext(\"Try \\'%s --help\\' for more information.\\n\");\n    fprintf(_stderr,pcVar3,uVar2);\n  }\n                    /* WARNING: Subroutine does not return */\n  exit(param_1);\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "usage",
                        "gettext",
                        "printf",
                        "fputs_unlocked",
                        "emit_stdin_note",
                        "emit_mandatory_arg_note",
                        "emit_tab_list_info",
                        "emit_ancillary_info",
                        "fprintf",
                        "exit"
                    ],
                    "calling_functions": [
                        "usage",
                        "main"
                    ],
                    "defined_in_file": "expand_decompiled.c"
                }
            },
            {
                "func_name": "expand",
                "func_c_signature": "void expand(void)",
                "decompiled_code": "void expand(void) {\n  byte bVar1;\n  byte bVar2;\n  int iVar3;\n  ushort **ppuVar4;\n  long in_FS_OFFSET;\n  bool bVar5;\n  undefined local_56;\n  byte local_55;\n  int local_54;\n  undefined4 local_50;\n  undefined4 local_4c;\n  long local_48;\n  long local_40;\n  FILE *local_38;\n  long local_30;\n  undefined8 local_28;\n  long local_20;\n  \n  local_20 = *(long *)(in_FS_OFFSET + 0x28);\n  local_38 = (FILE *)next_file(0);\n  if (local_38 == (FILE *)0x0) {\nLAB_00100646:\n    if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n      __stack_chk_fail();\n    }\n    return;\n  }\n  do {\n    local_55 = 1;\n    local_48 = 0;\n    local_40 = 0;\nLAB_001004b2:\n    do {\n      local_54 = getc_unlocked(local_38);\n      if (local_54 < 0) {\n        local_38 = (FILE *)next_file(local_38);\n        if (local_38 != (FILE *)0x0) goto LAB_001004b2;\n      }\n      if (local_55 != 0) {\n        if (local_54 == 9) {\n          local_30 = get_next_tab_column(local_48,&local_40,&local_56);\n          while (local_48 = local_48 + 1, local_48 < local_30) {\n            iVar3 = putchar_unlocked(0x20);\n            if (iVar3 < 0) {\n              write_error();\n            }\n          }\n          local_54 = 0x20;\n        }\n        else if (local_54 == 8) {\n          local_48 = local_48 - (ulong)(local_48 != 0);\n          local_40 = local_40 - (ulong)(local_40 != 0);\n        }\n        else {\n          bVar5 = SCARRY8(local_48,1);\n          local_48 = local_48 + 1;\n          if (bVar5) {\n            local_28 = gettext(\"input line is too long\");\n            local_50 = 1;\n            local_4c = 0;\n            error(1,0,local_28);\n          }\n        }\n        bVar1 = local_55;\n        if ((convert_entire_line == '\\0') &&\n           (ppuVar4 = __ctype_b_loc(), ((*ppuVar4)[local_54] & 1) == 0)) {\n          bVar2 = 0;\n        }\n        else {\n          bVar2 = 1;\n        }\n        local_55 = (bVar2 & bVar1) != 0;\n      }\n      if (local_54 < 0) goto LAB_00100646;\n      iVar3 = putchar_unlocked(local_54);\n      if (iVar3 < 0) {\n        write_error();\n      }\n    } while (local_54 != 10);\n  } while( true );\n}",
                "globals": [],
                "externs": [
                    "SCARRY8"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "expand",
                        "next_file",
                        "__stack_chk_fail",
                        "getc_unlocked",
                        "get_next_tab_column",
                        "putchar_unlocked",
                        "write_error",
                        "SCARRY8",
                        "gettext",
                        "error",
                        "__ctype_b_loc"
                    ],
                    "calling_functions": [
                        "expand",
                        "main"
                    ],
                    "defined_in_file": "expand_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(int param_1,undefined8 *param_2)",
                "decompiled_code": "undefined4 main(int param_1,undefined8 *param_2) {\n  int iVar1;\n  undefined8 uVar2;\n  long in_FS_OFFSET;\n  undefined local_12;\n  undefined local_11;\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  set_program_name(*param_2);\n  setlocale(6,\"\");\n  bindtextdomain(\"coreutils\",\"/usr/local/share/locale\");\n  textdomain(\"coreutils\");\n  atexit((__func *)&close_stdout);\n  convert_entire_line = 1;\nLAB_001007fa:\n  while( true ) {\n    iVar1 = getopt_long(param_1,param_2,shortopts,longopts,0);\n    if (iVar1 == -1) {\n      finalize_tab_stops();\n      if (_optind < param_1) {\n        param_2 = param_2 + _optind;\n      }\n      else {\n        param_2 = (undefined8 *)0x0;\n      }\n      set_file_list(param_2);\n      expand();\n      cleanup_file_list_stdin();\n      if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {\n        return _exit_status;\n      }\n                    /* WARNING: Subroutine does not return */\n      __stack_chk_fail();\n    }\n    if (iVar1 != 0x74) break;\n    parse_tab_stops(_optarg);\n  }\n  if (iVar1 < 0x75) {\n    if (iVar1 == 0x69) {\n      convert_entire_line = 0;\n      goto LAB_001007fa;\n    }\n    if ((iVar1 < 0x6a) && (iVar1 < 0x3a)) {\n      if (iVar1 < 0x30) {\n        if (iVar1 == -0x83) {\nLAB_00100795:\n          uVar2 = proper_name_lite(\"David MacKenzie\",\"David MacKenzie\");\n          version_etc(_stdout,\"expand\",\"GNU coreutils\",_Version,uVar2,0);\n                    /* WARNING: Subroutine does not return */\n          exit(0);\n        }\n        if (iVar1 == -0x82) {\n          usage(0);\n          goto LAB_00100795;\n        }\n        goto LAB_001007f0;\n      }\n      if (_optarg == 0) {\n        local_12 = (undefined)iVar1;\n        local_11 = 0;\n        parse_tab_stops(&local_12);\n      }\n      else {\n        parse_tab_stops(_optarg + -1);\n      }\n      goto LAB_001007fa;\n    }\n  }\nLAB_001007f0:\n  usage(1);\n  goto LAB_001007fa;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "set_program_name",
                        "setlocale",
                        "bindtextdomain",
                        "textdomain",
                        "atexit",
                        "getopt_long",
                        "finalize_tab_stops",
                        "set_file_list",
                        "expand",
                        "cleanup_file_list_stdin",
                        "__stack_chk_fail",
                        "parse_tab_stops",
                        "proper_name_lite",
                        "version_etc",
                        "exit",
                        "usage"
                    ],
                    "calling_functions": [
                        "main"
                    ],
                    "defined_in_file": "expand_decompiled.c"
                }
            }
        ]
    }
}