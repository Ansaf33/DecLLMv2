{
    "file": "cksum",
    "decompiled_code": {
        "cksum.c": [
            {
                "func_name": "pclmul_supported",
                "func_c_signature": "undefined * pclmul_supported(void)",
                "decompiled_code": "undefined * pclmul_supported(void) {\n  char cVar1;\n  bool bVar2;\n  undefined8 uVar3;\n  undefined *puVar4;\n  \n  uVar3 = gcc_feature_to_glibc_hwcap(&DAT_00100c10);\n  cVar1 = hwcap_allowed(uVar3);\n  if ((cVar1 != '\\0') && ((_DAT_0010101c & 0x200) != 0)) {\n    uVar3 = gcc_feature_to_glibc_hwcap(\"pclmul\");\n    cVar1 = hwcap_allowed(uVar3);\n    if ((cVar1 != '\\0') && ((_DAT_0010101c & 0x80000) != 0)) {\n      bVar2 = true;\n      goto LAB_001001b4;\n    }\n  }\n  bVar2 = false;\nLAB_001001b4:\n  if (cksum_debug != '\\0') {\n    if (bVar2) {\n      uVar3 = gettext(\"using pclmul hardware support\");\n    }\n    else {\n      uVar3 = gettext(\"pclmul support not detected\");\n    }\n    error(0,0,&DAT_00100cb8,uVar3);\n  }\n  if (bVar2) {\n    puVar4 = &cksum_pclmul;\n  }\n  else {\n    puVar4 = (undefined *)0x0;\n  }\n  return puVar4;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "pclmul_supported",
                        "gcc_feature_to_glibc_hwcap",
                        "hwcap_allowed",
                        "gettext",
                        "error"
                    ],
                    "calling_functions": [
                        "pclmul_supported",
                        "crc_sum_stream",
                        "crc32b_sum_stream"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "avx2_supported",
                "func_c_signature": "undefined * avx2_supported(void)",
                "decompiled_code": "undefined * avx2_supported(void) {\n  char cVar1;\n  bool bVar2;\n  undefined8 uVar3;\n  undefined *puVar4;\n  \n  uVar3 = gcc_feature_to_glibc_hwcap(&DAT_00100c19);\n  cVar1 = hwcap_allowed(uVar3);\n  if ((cVar1 != '\\0') && ((_DAT_0010101c & 0x400) != 0)) {\n    uVar3 = gcc_feature_to_glibc_hwcap(\"vpclmulqdq\");\n    cVar1 = hwcap_allowed(uVar3);\n    if ((cVar1 != '\\0') && ((___cpu_features2 & 2) != 0)) {\n      bVar2 = true;\n      goto LAB_001002a4;\n    }\n  }\n  bVar2 = false;\nLAB_001002a4:\n  if (cksum_debug != '\\0') {\n    if (bVar2) {\n      uVar3 = gettext(\"using avx2 hardware support\");\n    }\n    else {\n      uVar3 = gettext(\"avx2 support not detected\");\n    }\n    error(0,0,&DAT_00100cb8,uVar3);\n  }\n  if (bVar2) {\n    puVar4 = &cksum_avx2;\n  }\n  else {\n    puVar4 = (undefined *)0x0;\n  }\n  return puVar4;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "avx2_supported",
                        "gcc_feature_to_glibc_hwcap",
                        "hwcap_allowed",
                        "gettext",
                        "error"
                    ],
                    "calling_functions": [
                        "avx2_supported",
                        "crc_sum_stream"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "avx512_supported",
                "func_c_signature": "undefined * avx512_supported(void)",
                "decompiled_code": "undefined * avx512_supported(void) {\n  char cVar1;\n  bool bVar2;\n  undefined8 uVar3;\n  undefined *puVar4;\n  \n  uVar3 = gcc_feature_to_glibc_hwcap(\"avx512f\");\n  cVar1 = hwcap_allowed(uVar3);\n  if ((cVar1 != '\\0') && ((_DAT_0010101c & 0x8000) != 0)) {\n    uVar3 = gcc_feature_to_glibc_hwcap(\"avx512bw\");\n    cVar1 = hwcap_allowed(uVar3);\n    if ((cVar1 != '\\0') && ((_DAT_0010101c & 0x200000) != 0)) {\n      uVar3 = gcc_feature_to_glibc_hwcap(\"vpclmulqdq\");\n      cVar1 = hwcap_allowed(uVar3);\n      if ((cVar1 != '\\0') && ((___cpu_features2 & 2) != 0)) {\n        bVar2 = true;\n        goto LAB_001003c2;\n      }\n    }\n  }\n  bVar2 = false;\nLAB_001003c2:\n  if (cksum_debug != '\\0') {\n    if (bVar2) {\n      uVar3 = gettext(\"using avx512 hardware support\");\n    }\n    else {\n      uVar3 = gettext(\"avx512 support not detected\");\n    }\n    error(0,0,&DAT_00100cb8,uVar3);\n  }\n  if (bVar2) {\n    puVar4 = &cksum_avx512;\n  }\n  else {\n    puVar4 = (undefined *)0x0;\n  }\n  return puVar4;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "avx512_supported",
                        "gcc_feature_to_glibc_hwcap",
                        "hwcap_allowed",
                        "gettext",
                        "error"
                    ],
                    "calling_functions": [
                        "avx512_supported",
                        "crc_sum_stream"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "vmull_supported",
                "func_c_signature": "undefined8 vmull_supported(void)",
                "decompiled_code": "undefined8 vmull_supported(void) {\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "vmull_supported"
                    ],
                    "calling_functions": [
                        "vmull_supported",
                        "crc_sum_stream"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "cksum_slice8",
                "func_c_signature": "undefined8 cksum_slice8(FILE *param_1,ulong *param_2,ulong *param_3)",
                "decompiled_code": "undefined8 cksum_slice8(FILE *param_1,ulong *param_2,ulong *param_3) {\n  undefined4 *puVar1;\n  undefined4 uVar2;\n  undefined4 uVar3;\n  undefined *puVar4;\n  uint uVar5;\n  int iVar6;\n  undefined8 uVar7;\n  int *piVar8;\n  undefined4 extraout_var;\n  undefined *puVar9;\n  long in_FS_OFFSET;\n  bool bVar10;\n  ulong uStack_10040;\n  ulong uStack_10038;\n  ulong uStack_10030;\n  undefined4 *puStack_10028;\n  undefined4 *puStack_10020;\n  undefined4 auStack_10018 [4];\n  undefined auStack_10008 [65528];\n  long local_10;\n  \n  puVar4 = &stack0xfffffffffffffff8;\n  do {\n    puVar9 = puVar4;\n    *(undefined8 *)(puVar9 + -0x1000) = *(undefined8 *)(puVar9 + -0x1000);\n    puVar4 = puVar9 + -0x1000;\n  } while (puVar9 + -0x1000 != auStack_10008);\n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  uStack_10038 = 0;\n  uStack_10040 = 0;\n  if (((param_1 == (FILE *)0x0) || (param_2 == (ulong *)0x0)) || (param_3 == (ulong *)0x0)) {\n    uVar7 = 0;\n  }\n  else {\n    do {\n      *(undefined8 *)(puVar9 + -0x1068) = 0x10079f;\n      uStack_10030 = fread_unlocked(auStack_10018,1,0x10000,param_1);\n      if (uStack_10030 == 0) break;\n      bVar10 = CARRY8(uStack_10040,uStack_10030);\n      uStack_10040 = uStack_10040 + uStack_10030;\n      if (bVar10) {\n        *(undefined8 *)(puVar9 + -0x1068) = 0x10050e;\n        piVar8 = __errno_location();\n        *piVar8 = 0x4b;\n        uVar7 = 0;\n        goto LAB_001007ed;\n      }\n      puStack_10028 = auStack_10018;\n      for (; 7 < uStack_10030; uStack_10030 = uStack_10030 - 8) {\n        puVar1 = puStack_10028 + 1;\n        uVar2 = *puStack_10028;\n        puStack_10028 = puStack_10028 + 2;\n        uVar3 = *puVar1;\n        *(undefined8 *)(puVar9 + -0x1068) = 0x100572;\n        uVar5 = __bswap_32(uVar2);\n        uStack_10038 = uStack_10038 ^ uVar5;\n        *(undefined8 *)(puVar9 + -0x1068) = 0x100588;\n        uVar5 = __bswap_32(uVar3);\n        uStack_10038 = *(ulong *)(&crctab + (ulong)(uVar5 & 0xff) * 8) ^\n                       *(ulong *)(&crctab + ((uStack_10038 >> 0x18 & 0xff) + 0x700) * 8) ^\n                       *(ulong *)(&crctab + ((uStack_10038 >> 0x10 & 0xff) + 0x600) * 8) ^\n                       *(ulong *)(&crctab + ((uStack_10038 >> 8 & 0xff) + 0x500) * 8) ^\n                       *(ulong *)(&crctab + ((uStack_10038 & 0xff) + 0x400) * 8) ^\n                       *(ulong *)(&crctab + ((ulong)(uVar5 >> 0x18) + 0x300) * 8) ^\n                       *(ulong *)(&crctab + ((ulong)(uVar5 >> 0x10 & 0xff) + 0x200) * 8) ^\n                       *(ulong *)(&crctab + ((ulong)(uVar5 >> 8 & 0xff) + 0x100) * 8);\n      }\n      puStack_10020 = puStack_10028;\n      while (uStack_10030 != 0) {\n        uStack_10038 = *(ulong *)(&crctab +\n                                 (ulong)(byte)(*(byte *)puStack_10020 ^ (byte)(uStack_10038 >> 0x18)\n                                              ) * 8) ^ uStack_10038 << 8;\n        uStack_10030 = uStack_10030 - 1;\n        puStack_10020 = (undefined4 *)((long)puStack_10020 + 1);\n      }\n      *(undefined8 *)(puVar9 + -0x1068) = 0x100778;\n      iVar6 = feof_unlocked(param_1);\n    } while (iVar6 == 0);\n    *param_2 = uStack_10038;\n    *param_3 = uStack_10040;\n    *(undefined8 *)(puVar9 + -0x1068) = 0x1007e8;\n    iVar6 = ferror_unlocked(param_1);\n    uVar7 = CONCAT71((int7)(CONCAT44(extraout_var,iVar6) >> 8),iVar6 == 0);\n  }\nLAB_001007ed:\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    *(undefined8 *)(puVar9 + -0x1068) = 0x100801;\n    __stack_chk_fail();\n  }\n  return uVar7;\n}",
                "globals": [],
                "externs": [
                    "CARRY8",
                    "CONCAT71",
                    "CONCAT44"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "cksum_slice8",
                        "fread_unlocked",
                        "CARRY8",
                        "__errno_location",
                        "__bswap_32",
                        "feof_unlocked",
                        "ferror_unlocked",
                        "CONCAT71",
                        "CONCAT44",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "cksum_slice8"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "crc_sum_stream",
                "func_c_signature": "undefined8 crc_sum_stream(undefined8 param_1,uint *param_2,ulong *param_3)",
                "decompiled_code": "undefined8 crc_sum_stream(undefined8 param_1,uint *param_2,ulong *param_3) {\n  uint uVar1;\n  char cVar2;\n  undefined8 uVar3;\n  long in_FS_OFFSET;\n  ulong local_20;\n  ulong local_18;\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  local_20 = 0;\n  local_18 = 0;\n  if (cksum_fp_0 == (code *)0x0) {\n    cksum_fp_0 = (code *)avx512_supported();\n  }\n  if (cksum_fp_0 == (code *)0x0) {\n    cksum_fp_0 = (code *)avx2_supported();\n  }\n  if (cksum_fp_0 == (code *)0x0) {\n    cksum_fp_0 = (code *)pclmul_supported();\n  }\n  if (cksum_fp_0 == (code *)0x0) {\n    cksum_fp_0 = (code *)vmull_supported();\n  }\n  if (cksum_fp_0 == (code *)0x0) {\n    cksum_fp_0 = cksum_slice8;\n  }\n  cVar2 = (*cksum_fp_0)(param_1,&local_18,&local_20);\n  if (cVar2 == '\\x01') {\n    *param_3 = local_20;\n    for (; local_20 != 0; local_20 = local_20 >> 8) {\n      local_18 = *(ulong *)(&crctab + (ulong)(byte)((byte)local_20 ^ (byte)(local_18 >> 0x18)) * 8)\n                 ^ local_18 << 8;\n    }\n    uVar1 = (uint)local_18;\n    local_18 = (ulong)~uVar1;\n    *param_2 = ~uVar1;\n    uVar3 = 0;\n  }\n  else {\n    uVar3 = 0xffffffff;\n  }\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return uVar3;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "crc_sum_stream",
                        "avx512_supported",
                        "avx2_supported",
                        "pclmul_supported",
                        "vmull_supported",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "crc_sum_stream"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "crc32b_sum_stream",
                "func_c_signature": "undefined8 crc32b_sum_stream(FILE *param_1,undefined4 *param_2,ulong *param_3)",
                "decompiled_code": "undefined8 crc32b_sum_stream(FILE *param_1,undefined4 *param_2,ulong *param_3) {\n  undefined *puVar1;\n  int iVar2;\n  undefined8 uVar3;\n  int *piVar4;\n  size_t sVar5;\n  undefined *puVar6;\n  long in_FS_OFFSET;\n  bool bVar7;\n  undefined4 uStack_1002c;\n  ulong uStack_10028;\n  undefined auStack_10018 [16];\n  undefined auStack_10008 [65528];\n  long local_10;\n  \n  puVar1 = &stack0xfffffffffffffff8;\n  do {\n    puVar6 = puVar1;\n    *(undefined8 *)(puVar6 + -0x1000) = *(undefined8 *)(puVar6 + -0x1000);\n    puVar1 = puVar6 + -0x1000;\n  } while (puVar6 + -0x1000 != auStack_10008);\n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  uStack_1002c = 0;\n  uStack_10028 = 0;\n  if (((param_1 == (FILE *)0x0) || (param_2 == (undefined4 *)0x0)) || (param_3 == (ulong *)0x0)) {\n    uVar3 = 0xffffffff;\n  }\n  else {\n    if (cksum_debug != '\\0') {\n      *(undefined8 *)(puVar6 + -0x1058) = 0x100a0c;\n      pclmul_supported();\n    }\n    do {\n      *(undefined8 *)(puVar6 + -0x1058) = 0x100aab;\n      sVar5 = fread_unlocked(auStack_10018,1,0x10000,param_1);\n      if (sVar5 == 0) break;\n      bVar7 = CARRY8(uStack_10028,sVar5);\n      uStack_10028 = uStack_10028 + sVar5;\n      if (bVar7) {\n        *(undefined8 *)(puVar6 + -0x1058) = 0x100a41;\n        piVar4 = __errno_location();\n        *piVar4 = 0x4b;\n        uVar3 = 0xffffffff;\n        goto LAB_00100b0e;\n      }\n      *(undefined8 *)(puVar6 + -0x1058) = 0x100a6f;\n      uStack_1002c = crc32_update(uStack_1002c,auStack_10018,sVar5);\n      *(undefined8 *)(puVar6 + -0x1058) = 0x100a84;\n      iVar2 = feof_unlocked(param_1);\n    } while (iVar2 == 0);\n    *param_2 = uStack_1002c;\n    *param_3 = uStack_10028;\n    *(undefined8 *)(puVar6 + -0x1058) = 0x100afe;\n    iVar2 = ferror_unlocked(param_1);\n    if (iVar2 == 0) {\n      uVar3 = 0;\n    }\n    else {\n      uVar3 = 0xffffffff;\n    }\n  }\nLAB_00100b0e:\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    *(undefined8 *)(puVar6 + -0x1058) = 0x100b22;\n    __stack_chk_fail();\n  }\n  return uVar3;\n}",
                "globals": [],
                "externs": [
                    "CARRY8"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "crc32b_sum_stream",
                        "pclmul_supported",
                        "fread_unlocked",
                        "CARRY8",
                        "__errno_location",
                        "crc32_update",
                        "feof_unlocked",
                        "ferror_unlocked",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "crc32b_sum_stream"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            },
            {
                "func_name": "output_crc",
                "func_c_signature": "void output_crc(undefined8 param_1,undefined8 param_2,uint *param_3,char param_4,undefined8 param_5,\n               byte param_6,char param_7,undefined8 param_8)",
                "decompiled_code": "void output_crc(undefined8 param_1,undefined8 param_2,uint *param_3,char param_4,undefined8 param_5,\n               byte param_6,char param_7,undefined8 param_8) {\n  long in_FS_OFFSET;\n  undefined4 local_14;\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  if (param_4 == '\\0') {\n    printf(\"%u %ju\",(ulong)*param_3,param_8);\n    if (param_7 != '\\0') {\n      printf(\" %s\",param_1);\n    }\n    putchar_unlocked((uint)param_6);\n  }\n  else {\n    local_14 = __bswap_32(*param_3);\n    fwrite_unlocked(&local_14,1,4,_stdout);\n  }\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "output_crc",
                        "printf",
                        "putchar_unlocked",
                        "__bswap_32",
                        "fwrite_unlocked",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "output_crc"
                    ],
                    "defined_in_file": "cksum_decompiled.c"
                }
            }
        ]
    }
}