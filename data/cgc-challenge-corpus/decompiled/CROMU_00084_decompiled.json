{
    "file": "CROMU_00084",
    "decompiled_code": {
        "service.c": [
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  ui_main();\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "ui_main"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "init_state",
                "func_c_signature": "undefined4 * init_state(void)",
                "decompiled_code": "undefined4 * init_state(void) {\n  undefined4 *__s;\n  \n  __s = (undefined4 *)malloc(0x67c);\n  bzero(__s,0x67c);\n  *(undefined8 *)(__s + 0x192) = DAT_00019000;\n  __s[0x195] = 0;\n  __s[0x194] = 0xaf;\n  __s[1] = 0;\n  __s[0x198] = 0;\n  *(undefined2 *)(__s + 0x19a) = 0xffff;\n  *__s = 0;\n  __s[0x199] = 0x4b;\n  bzero(__s + 2,800);\n  __s[0x19c] = 0;\n  *(undefined *)(__s + 0x19d) = 0;\n  __s[0x19b] = 0;\n  return __s;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "init_state",
                        "malloc",
                        "bzero"
                    ],
                    "calling_functions": [
                        "init_state",
                        "ui_main"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "new_state",
                "func_c_signature": "void new_state(undefined4 *param_1)",
                "decompiled_code": "void new_state(undefined4 *param_1) {\n  free_program(param_1);\n  *(undefined8 *)(param_1 + 0x192) = DAT_00019000;\n  param_1[0x194] = 0xaf;\n  param_1[1] = 0;\n  param_1[0x198] = 0;\n  *(undefined2 *)(param_1 + 0x19a) = 0xffff;\n  *param_1 = 0;\n  param_1[0x199] = 0x4b;\n  param_1[0x19c] = 0;\n  *(undefined *)(param_1 + 0x19d) = 0;\n  param_1[0x19b] = 0;\n  reset_sensors(param_1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "new_state",
                        "free_program",
                        "reset_sensors"
                    ],
                    "calling_functions": [
                        "new_state",
                        "power_off",
                        "add_steps",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "power_on",
                "func_c_signature": "bool power_on(int param_1)",
                "decompiled_code": "bool power_on(int param_1) {\n  if (param_1 != 0) {\n    *(undefined4 *)(param_1 + 4) = 1;\n  }\n  return param_1 == 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "power_on"
                    ],
                    "calling_functions": [
                        "power_on",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "power_off",
                "func_c_signature": "bool power_off(int param_1)",
                "decompiled_code": "bool power_off(int param_1) {\n  if (param_1 != 0) {\n    new_state(param_1);\n  }\n  return param_1 == 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "power_off",
                        "new_state"
                    ],
                    "calling_functions": [
                        "power_off",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "smoke_on",
                "func_c_signature": "undefined4 smoke_on(int *param_1)",
                "decompiled_code": "undefined4 smoke_on(int *param_1) {\n  undefined4 uVar1;\n  \n  if (param_1 == (int *)0x0) {\n    uVar1 = 1;\n  }\n  else if (*param_1 == 1) {\n    uVar1 = 2;\n  }\n  else {\n    *param_1 = 1;\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "smoke_on"
                    ],
                    "calling_functions": [
                        "smoke_on",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "smoke_off",
                "func_c_signature": "undefined4 smoke_off(int *param_1)",
                "decompiled_code": "undefined4 smoke_off(int *param_1) {\n  undefined4 uVar1;\n  \n  if (param_1 == (int *)0x0) {\n    uVar1 = 1;\n  }\n  else if (*param_1 == 0) {\n    uVar1 = 2;\n  }\n  else {\n    *param_1 = 0;\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "smoke_off"
                    ],
                    "calling_functions": [
                        "smoke_off",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "set_ambient_temp",
                "func_c_signature": "undefined4 set_ambient_temp(int param_1,int param_2)",
                "decompiled_code": "undefined4 set_ambient_temp(int param_1,int param_2) {\n  undefined4 uVar1;\n  \n  if (param_1 == 0) {\n    uVar1 = 1;\n  }\n  else if (param_2 < 0xb0) {\n    *(int *)(param_1 + 0x664) = param_2;\n    uVar1 = 0;\n  }\n  else {\n    uVar1 = 2;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "set_ambient_temp"
                    ],
                    "calling_functions": [
                        "set_ambient_temp",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "set_temp",
                "func_c_signature": "undefined4 set_temp(int param_1,ushort param_2)",
                "decompiled_code": "undefined4 set_temp(int param_1,ushort param_2) {\n  undefined4 uVar1;\n  \n  if (param_1 == 0) {\n    uVar1 = 1;\n  }\n  else if ((param_2 < 0xaf) || (0x15e < param_2)) {\n    uVar1 = 2;\n  }\n  else {\n    *(uint *)(param_1 + 0x650) = (uint)param_2;\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "set_temp"
                    ],
                    "calling_functions": [
                        "set_temp",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "add_sensor",
                "func_c_signature": "undefined4 add_sensor(int param_1,undefined2 param_2,undefined4 param_3,undefined4 param_4)",
                "decompiled_code": "undefined4 add_sensor(int param_1,undefined2 param_2,undefined4 param_3,undefined4 param_4) {\n  undefined4 uVar1;\n  int iVar2;\n  void *pvVar3;\n  undefined4 *local_14;\n  int local_10;\n  \n  if (param_1 == 0) {\n    uVar1 = 1;\n  }\n  else {\n    iVar2 = find_sensor(param_1,param_2);\n    if (iVar2 == 0) {\n      if (*(uint *)(param_1 + 0x654) < 10) {\n        local_10 = *(int *)(param_1 + 0x658);\n        local_14 = *(undefined4 **)(param_1 + 0x658);\n        if (local_10 == 0) {\n          local_14 = (undefined4 *)malloc(0x1c);\n          *(undefined4 **)(param_1 + 0x658) = local_14;\n          *local_14 = 0;\n        }\n        else {\n          for (; local_10 != 0; local_10 = *(int *)(local_10 + 4)) {\n            local_14 = (undefined4 *)local_10;\n          }\n          pvVar3 = malloc(0x1c);\n          *(void **)((int)local_14 + 4) = pvVar3;\n          **(int **)((int)local_14 + 4) = (int)local_14;\n          local_14 = *(undefined4 **)((int)local_14 + 4);\n        }\n        local_14[1] = 0;\n        *(double *)(local_14 + 5) = (double)(ulonglong)*(uint *)(param_1 + 0x664);\n        *(undefined2 *)(local_14 + 2) = param_2;\n        local_14[3] = param_3;\n        local_14[4] = param_4;\n        *(int *)(param_1 + 0x654) = *(int *)(param_1 + 0x654) + 1;\n        uVar1 = 0;\n      }\n      else {\n        uVar1 = 3;\n      }\n    }\n    else {\n      uVar1 = 2;\n    }\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_sensor",
                        "find_sensor",
                        "malloc"
                    ],
                    "calling_functions": [
                        "add_sensor",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "find_sensor",
                "func_c_signature": "int find_sensor(int param_1,short param_2)",
                "decompiled_code": "int find_sensor(int param_1,short param_2) {\n  int local_c;\n  int local_8;\n  \n  if (param_1 == 0) {\n    local_c = 0;\n  }\n  else if (*(int *)(param_1 + 0x658) == 0) {\n    local_c = 0;\n  }\n  else {\n    local_8 = *(int *)(param_1 + 0x658);\n    local_c = *(int *)(param_1 + 0x658);\n    while ((local_8 != 0 && (param_2 != *(short *)(local_c + 8)))) {\n      local_c = local_8;\n      local_8 = *(int *)(local_8 + 4);\n    }\n    if (param_2 != *(short *)(local_c + 8)) {\n      local_c = 0;\n    }\n  }\n  return local_c;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "find_sensor"
                    ],
                    "calling_functions": [
                        "add_sensor",
                        "find_sensor",
                        "remove_sensor",
                        "check_program"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "remove_sensor",
                "func_c_signature": "undefined4 remove_sensor(int param_1,undefined2 param_2)",
                "decompiled_code": "undefined4 remove_sensor(int param_1,undefined2 param_2) {\n  int *__ptr;\n  undefined4 uVar1;\n  \n  __ptr = (int *)find_sensor(param_1,param_2);\n  if (__ptr == (int *)0x0) {\n    uVar1 = 1;\n  }\n  else {\n    if (*__ptr == 0) {\n      *(int *)(param_1 + 0x658) = __ptr[1];\n    }\n    if (__ptr[1] != 0) {\n      *(int *)__ptr[1] = *__ptr;\n    }\n    if (*__ptr != 0) {\n      *(int *)(*__ptr + 4) = __ptr[1];\n    }\n    *(int *)(param_1 + 0x654) = *(int *)(param_1 + 0x654) + -1;\n    free(__ptr);\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "remove_sensor",
                        "find_sensor",
                        "free"
                    ],
                    "calling_functions": [
                        "remove_sensor",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "free_program",
                "func_c_signature": "void free_program(int param_1)",
                "decompiled_code": "void free_program(int param_1) {\n  void *pvVar1;\n  void *local_10;\n  \n  if (*(int *)(param_1 + 0x678) != 0) {\n    local_10 = *(void **)(param_1 + 0x678);\n    while (local_10 != (void *)0x0) {\n      pvVar1 = *(void **)((int)local_10 + 4);\n      free(local_10);\n      local_10 = pvVar1;\n    }\n    *(undefined4 *)(param_1 + 0x678) = 0;\n    *(undefined2 *)(param_1 + 0x65c) = 0;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "free_program",
                        "free"
                    ],
                    "calling_functions": [
                        "new_state",
                        "free_program"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "add_steps",
                "func_c_signature": "undefined4 add_steps(int param_1,uint param_2,int param_3)",
                "decompiled_code": "undefined4 add_steps(int param_1,uint param_2,int param_3) {\n  uint uVar1;\n  uint uVar2;\n  short sVar3;\n  undefined4 uVar4;\n  uint local_14;\n  uint local_10;\n  \n  if (param_2 < 0xb) {\n    for (local_10 = 0; local_10 < param_2; local_10 = local_10 + 1) {\n      sVar3 = (short)*(undefined4 *)(param_3 + local_10 * 0xc);\n      uVar1 = *(uint *)(param_3 + local_10 * 0xc + 4);\n      uVar2 = *(uint *)(param_3 + local_10 * 0xc + 8);\n      if (sVar3 == 0) {\n        if (0xc < *(uint *)(param_3 + local_10 * 0xc + 4)) {\n          return 3;\n        }\n        if ((uVar2 < 0xaf) || (0x15e < uVar2)) {\n          return 1;\n        }\n      }\n      if (sVar3 == 1) {\n        if ((uVar1 < 0x708) || (0x3840 < uVar1)) {\n          return 2;\n        }\n        if ((uVar2 < 0xaf) || (0x15e < uVar2)) {\n          return 1;\n        }\n      }\n      if (1 < sVar3) {\n        return 4;\n      }\n    }\n    new_state(param_1);\n    for (local_14 = 0; local_14 < param_2; local_14 = local_14 + 1) {\n      add_step(param_1,*(undefined4 *)(param_3 + local_14 * 0xc),\n               *(undefined4 *)(param_3 + local_14 * 0xc + 4),\n               *(undefined4 *)(param_3 + local_14 * 0xc + 8));\n    }\n    *(undefined2 *)(param_1 + 0x668) = 0;\n    *(short *)(param_1 + 0x65c) = (short)param_2;\n    uVar4 = 0;\n  }\n  else {\n    uVar4 = 5;\n  }\n  return uVar4;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_steps",
                        "new_state",
                        "add_step"
                    ],
                    "calling_functions": [
                        "add_steps",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "add_step",
                "func_c_signature": "undefined4 add_step(int param_1,int param_2,undefined4 param_3,undefined4 param_4)",
                "decompiled_code": "undefined4 add_step(int param_1,int param_2,undefined4 param_3,undefined4 param_4) {\n  void *pvVar1;\n  int local_14;\n  undefined4 *local_10;\n  \n  local_14 = *(int *)(param_1 + 0x678);\n  local_10 = (undefined4 *)local_14;\n  if (local_14 == 0) {\n    local_10 = (undefined4 *)malloc(0x14);\n    bzero(local_10,0x14);\n    *local_10 = 0;\n    *(undefined4 **)(param_1 + 0x678) = local_10;\n  }\n  else {\n    for (; local_14 != 0; local_14 = *(int *)(local_14 + 4)) {\n      local_10 = (undefined4 *)local_14;\n    }\n    pvVar1 = malloc(0x14);\n    *(void **)((int)local_10 + 4) = pvVar1;\n    bzero(*(void **)((int)local_10 + 4),0x14);\n    local_10 = *(undefined4 **)((int)local_10 + 4);\n  }\n  local_10[1] = 0;\n  local_10[2] = param_2;\n  if (param_2 == 0) {\n    local_10[3] = param_3;\n  }\n  else {\n    local_10[3] = param_3;\n  }\n  local_10[4] = param_4;\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_step",
                        "malloc",
                        "bzero"
                    ],
                    "calling_functions": [
                        "add_steps",
                        "add_step"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_program",
                "func_c_signature": "undefined4 get_program(int param_1,int *param_2,int param_3)",
                "decompiled_code": "undefined4 get_program(int param_1,int *param_2,int param_3) {\n  undefined4 uVar1;\n  int local_c;\n  int local_8;\n  \n  if (param_1 == 0) {\n    uVar1 = 1;\n  }\n  else if (*(int *)(param_1 + 0x678) == 0) {\n    uVar1 = 1;\n  }\n  else {\n    local_8 = *(int *)(param_1 + 0x678);\n    local_c = 0;\n    for (; local_8 != 0; local_8 = *(int *)(local_8 + 4)) {\n      *(undefined4 *)(local_c * 0xc + param_3) = *(undefined4 *)(local_8 + 8);\n      *(undefined4 *)(local_c * 0xc + 4 + param_3) = *(undefined4 *)(local_8 + 0xc);\n      *(undefined4 *)(local_c * 0xc + 8 + param_3) = *(undefined4 *)(local_8 + 0x10);\n      local_c = local_c + 1;\n    }\n    *param_2 = local_c;\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_program"
                    ],
                    "calling_functions": [
                        "get_program",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_status",
                "func_c_signature": "bool get_status(undefined4 *param_1,undefined4 *param_2)",
                "decompiled_code": "bool get_status(undefined4 *param_1,undefined4 *param_2) {\n  undefined4 local_14;\n  \n  if (param_1 != (undefined4 *)0x0) {\n    *param_2 = 0x10a;\n    param_2[1] = param_1[0x194];\n    local_14 = (undefined4)(longlong)ROUND(*(double *)(param_1 + 0x192));\n    param_2[2] = local_14;\n    param_2[3] = param_1[1];\n    param_2[4] = param_1[0x198];\n    param_2[5] = *param_1;\n  }\n  return param_1 == (undefined4 *)0x0;\n}",
                "globals": [],
                "externs": [
                    "ROUND"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_status",
                        "ROUND"
                    ],
                    "calling_functions": [
                        "get_status",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_sensors",
                "func_c_signature": "void get_sensors(int param_1,void *param_2)",
                "decompiled_code": "void get_sensors(int param_1,void *param_2) {\n  uint local_2ac;\n  uint local_298 [160];\n  undefined4 local_18;\n  int local_14;\n  int local_10;\n  \n  local_10 = *(int *)(param_1 + 0x658);\n  local_18 = *(undefined4 *)(param_1 + 0x654);\n  local_14 = 0;\n  for (; local_10 != 0; local_10 = *(int *)(local_10 + 4)) {\n    local_298[local_14 * 4] = (uint)*(ushort *)(local_10 + 8);\n    local_298[local_14 * 4 + 1] = *(uint *)(local_10 + 0xc);\n    local_298[local_14 * 4 + 2] = *(uint *)(local_10 + 0x10);\n    local_2ac = (uint)(longlong)ROUND(*(double *)(local_10 + 0x14));\n    local_298[local_14 * 4 + 3] = local_2ac;\n    local_14 = local_14 + 1;\n  }\n  memcpy(param_2,local_298,local_14 << 4);\n  return;\n}",
                "globals": [],
                "externs": [
                    "ROUND"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_sensors",
                        "ROUND",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "get_sensors",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "update_sensors",
                "func_c_signature": "void update_sensors(int param_1)",
                "decompiled_code": "void update_sensors(int param_1) {\n  int local_8;\n  \n  for (local_8 = *(int *)(param_1 + 0x658); local_8 != 0; local_8 = *(int *)(local_8 + 4)) {\n    *(double *)(local_8 + 0x14) =\n         *(double *)(local_8 + 0x14) +\n         (*(double *)(param_1 + 0x648) - *(double *)(local_8 + 0x14)) *\n         (DAT_00019010 + (double)(ulonglong)*(uint *)(local_8 + 0x10) / DAT_00019008);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "update_sensors"
                    ],
                    "calling_functions": [
                        "update_sensors",
                        "simulate_seconds"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "reset_sensors",
                "func_c_signature": "void reset_sensors(int param_1)",
                "decompiled_code": "void reset_sensors(int param_1) {\n  int local_8;\n  \n  for (local_8 = *(int *)(param_1 + 0x658); local_8 != 0; local_8 = *(int *)(local_8 + 4)) {\n    *(double *)(local_8 + 0x14) = (double)(ulonglong)*(uint *)(param_1 + 0x664);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "reset_sensors"
                    ],
                    "calling_functions": [
                        "new_state",
                        "reset_sensors"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_step",
                "func_c_signature": "int get_step(int param_1,int param_2)",
                "decompiled_code": "int get_step(int param_1,int param_2) {\n  int local_c;\n  int local_8;\n  \n  local_8 = *(int *)(param_1 + 0x678);\n  local_c = 0;\n  for (; (local_c < param_2 && (local_8 != 0)); local_8 = *(int *)(local_8 + 4)) {\n    local_c = local_c + 1;\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_step"
                    ],
                    "calling_functions": [
                        "get_step",
                        "check_program"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "check_program",
                "func_c_signature": "void check_program(int param_1)",
                "decompiled_code": "void check_program(int param_1) {\n  int iVar1;\n  int iVar2;\n  int local_24;\n  \n  iVar1 = get_step(param_1,(int)*(short *)(param_1 + 0x668));\n  if (iVar1 == 0) {\n    *(undefined *)(param_1 + 0x674) = 1;\n  }\n  else if (*(int *)(iVar1 + 8) == 0) {\n    iVar2 = find_sensor(param_1,*(uint *)(iVar1 + 0xc) & 0xffff);\n    if (iVar2 == 0) {\n      *(short *)(param_1 + 0x668) = *(short *)(param_1 + 0x668) + 1;\n    }\n    else {\n      local_24 = (int)(longlong)ROUND(*(double *)(iVar2 + 0x14));\n      if (*(uint *)(param_1 + 0x650) < local_24 + 5U) {\n        *(undefined4 *)(param_1 + 0x650) = *(undefined4 *)(iVar1 + 0x10);\n        *(short *)(param_1 + 0x668) = *(short *)(param_1 + 0x668) + 1;\n      }\n    }\n  }\n  else if (*(uint *)(iVar1 + 0xc) < *(uint *)(param_1 + 0x66c)) {\n    *(undefined4 *)(param_1 + 0x650) = *(undefined4 *)(iVar1 + 0x10);\n    *(short *)(param_1 + 0x668) = *(short *)(param_1 + 0x668) + 1;\n  }\n  return;\n}",
                "globals": [],
                "externs": [
                    "ROUND"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "check_program",
                        "get_step",
                        "find_sensor",
                        "ROUND"
                    ],
                    "calling_functions": [
                        "check_program",
                        "simulate_seconds"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "add_history",
                "func_c_signature": "void add_history(int param_1)",
                "decompiled_code": "void add_history(int param_1) {\n  undefined4 local_14;\n  \n  local_14 = (undefined4)(longlong)ROUND(*(double *)(param_1 + 0x648));\n  *(undefined4 *)(param_1 + 8 + *(int *)(param_1 + 0x670) * 4) = local_14;\n  *(int *)(param_1 + 0x670) = *(int *)(param_1 + 0x670) + 1;\n  return;\n}",
                "globals": [],
                "externs": [
                    "ROUND"
                ],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "add_history",
                        "ROUND"
                    ],
                    "calling_functions": [
                        "add_history",
                        "simulate_seconds"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "simulate_seconds",
                "func_c_signature": "undefined4 simulate_seconds(int param_1,int param_2)",
                "decompiled_code": "undefined4 simulate_seconds(int param_1,int param_2) {\n  undefined4 uVar1;\n  int local_10;\n  \n  if (param_1 == 0) {\n    uVar1 = 1;\n  }\n  else if ((param_2 < 10) || (8000 < param_2)) {\n    uVar1 = 1;\n  }\n  else {\n    for (local_10 = 0; local_10 < param_2; local_10 = local_10 + 1) {\n      if (*(int *)(param_1 + 4) == 1) {\n        if (*(int *)(param_1 + 0x660) == 1) {\n          *(double *)(param_1 + 0x648) = *(double *)(param_1 + 0x648) + 1.0;\n          if (DAT_00019018 + (double)(ulonglong)*(uint *)(param_1 + 0x650) <\n              *(double *)(param_1 + 0x648)) {\n            *(undefined4 *)(param_1 + 0x660) = 0;\n          }\n        }\n        else {\n          if ((double)(ulonglong)*(uint *)(param_1 + 0x664) < *(double *)(param_1 + 0x648)) {\n            *(double *)(param_1 + 0x648) = *(double *)(param_1 + 0x648) - DAT_00019020;\n          }\n          if (*(double *)(param_1 + 0x648) <\n              (double)(ulonglong)*(uint *)(param_1 + 0x650) - DAT_00019018) {\n            *(undefined4 *)(param_1 + 0x660) = 1;\n          }\n        }\n      }\n      else if ((double)(ulonglong)*(uint *)(param_1 + 0x664) < *(double *)(param_1 + 0x648)) {\n        *(double *)(param_1 + 0x648) = *(double *)(param_1 + 0x648) - DAT_00019020;\n      }\n      update_sensors(param_1);\n      if ((-1 < *(short *)(param_1 + 0x668)) &&\n         (check_program(param_1), *(char *)(param_1 + 0x674) != '\\0')) {\n        return 2;\n      }\n      if (*(uint *)(param_1 + 0x66c) == (*(uint *)(param_1 + 0x66c) / 0x3c) * 0x3c) {\n        add_history(param_1);\n      }\n      *(int *)(param_1 + 0x66c) = *(int *)(param_1 + 0x66c) + 1;\n    }\n    uVar1 = 0;\n  }\n  return uVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "simulate_seconds",
                        "update_sensors",
                        "check_program",
                        "add_history"
                    ],
                    "calling_functions": [
                        "simulate_seconds",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "validate_fw",
                "func_c_signature": "int validate_fw(int param_1)",
                "decompiled_code": "int validate_fw(int param_1) {\n  ushort local_a;\n  int local_8;\n  \n  if (param_1 == 0) {\n    local_8 = 1;\n  }\n  else {\n    local_8 = 0;\n    for (local_a = 0; local_a < 0x1000; local_a = local_a + 1) {\n      local_8 = local_8 + (uint)*(byte *)(local_a + 0x4347c000) * (local_a + 1);\n    }\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "validate_fw"
                    ],
                    "calling_functions": [
                        "validate_fw",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "check_val",
                "func_c_signature": "int check_val(int param_1,ushort param_2)",
                "decompiled_code": "int check_val(int param_1,ushort param_2) {\n  ushort local_a;\n  int local_8;\n  \n  local_8 = 0;\n  for (local_a = 0; local_a < param_2; local_a = local_a + 1) {\n    local_8 = local_8 + (uint)*(byte *)(param_1 + (uint)local_a) * (local_a + 1);\n  }\n  return local_8;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "check_val"
                    ],
                    "calling_functions": [
                        "check_val",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "exit_normal",
                "func_c_signature": "undefined4 exit_normal(void)",
                "decompiled_code": "undefined4 exit_normal(void) {\n  _terminate();\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "exit_normal",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "exit_normal",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            }
        ],
        "ui.c": [
            {
                "func_name": "ui_main",
                "func_c_signature": "void ui_main(void)",
                "decompiled_code": "void ui_main(void) {\n  undefined4 uVar1;\n  \n  uVar1 = init_state();\n  do {\n    get_command(uVar1);\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "ui_main",
                        "init_state",
                        "get_command"
                    ],
                    "calling_functions": [
                        "main",
                        "ui_main"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_bytes",
                "func_c_signature": "void get_bytes(undefined4 param_1,undefined4 param_2)",
                "decompiled_code": "void get_bytes(undefined4 param_1,undefined4 param_2) {\n  int iVar1;\n  \n  iVar1 = receive_bytes(param_1,param_2);\n  if (iVar1 == -1) {\n    _terminate(0xffffffff);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_bytes",
                        "receive_bytes",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "get_bytes",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "prime_buf",
                "func_c_signature": "void prime_buf(void *param_1)",
                "decompiled_code": "void prime_buf(void *param_1) {\n  undefined4 local_18;\n  undefined4 local_14;\n  undefined4 local_10;\n  \n  bzero(param_1,0x108);\n  local_18 = 0x10a5aa5;\n  local_14 = 0;\n  local_10 = 0;\n  memcpy(param_1,&local_18,0xc);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "prime_buf",
                        "bzero",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "prime_buf",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_short",
                "func_c_signature": "undefined2 get_short(undefined2 *param_1)",
                "decompiled_code": "undefined2 get_short(undefined2 *param_1) {\n  return *param_1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_short"
                    ],
                    "calling_functions": [
                        "get_short",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_int",
                "func_c_signature": "undefined4 get_int(undefined4 *param_1)",
                "decompiled_code": "undefined4 get_int(undefined4 *param_1) {\n  return *param_1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_int"
                    ],
                    "calling_functions": [
                        "get_int",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_signed_int",
                "func_c_signature": "undefined4 get_signed_int(undefined4 *param_1)",
                "decompiled_code": "undefined4 get_signed_int(undefined4 *param_1) {\n  return *param_1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_signed_int"
                    ],
                    "calling_functions": [
                        "get_signed_int",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            },
            {
                "func_name": "get_command",
                "func_c_signature": "undefined4 get_command(int param_1)",
                "decompiled_code": "undefined4 get_command(int param_1) {\n  int iVar1;\n  size_t in_stack_fffffbdc;\n  undefined *puVar2;\n  size_t sVar3;\n  int __flags;\n  undefined local_414 [640];\n  size_t local_194;\n  undefined4 local_190;\n  undefined4 local_18c;\n  int local_188;\n  undefined4 local_184;\n  undefined4 local_180;\n  undefined4 local_17c;\n  undefined local_178 [24];\n  size_t local_160;\n  undefined local_15c [4];\n  undefined local_158 [4];\n  undefined local_154 [4];\n  undefined auStack_150 [4];\n  undefined auStack_14c [248];\n  undefined4 local_54;\n  void *local_50;\n  size_t local_4c;\n  undefined4 local_48;\n  undefined4 local_44;\n  int local_40;\n  undefined *local_3c;\n  undefined2 local_36;\n  undefined4 local_34;\n  undefined2 local_30;\n  undefined2 local_2e;\n  undefined4 local_2c;\n  undefined4 local_28;\n  undefined2 local_22;\n  short local_20;\n  ushort local_1e;\n  ushort local_1c;\n  short local_1a;\n  int local_18;\n  int local_14;\n  void *local_10;\n  \n  __flags = 0x124d0;\n  local_14 = 0;\n  local_18 = 0;\n  local_1a = 0;\n  local_1c = 0;\n  local_1e = 0xaa;\n  local_20 = 0xffff;\n  local_22 = 0xffff;\n  local_28 = 0xffff;\n  local_2c = 0xffff;\n  local_2e = 0xffff;\n  local_30 = 0xffff;\n  local_34 = 0;\n  local_36 = 0;\n  local_3c = (undefined *)0x0;\n  local_40 = 0xffffffff;\n  local_44 = 0;\n  bzero(local_15c,0x108);\n  get_bytes(local_15c,2);\n  local_1a = get_short(local_15c);\n  if (local_1a != 0x5aa5) {\n    prime_buf(local_15c);\n    send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n    return 1;\n  }\n  get_bytes(local_15c + 2,2);\n  local_1c = get_short(local_15c + 2);\n  if (0x100 < local_1c) {\n    prime_buf(local_15c);\n    send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n    return 1;\n  }\n  get_bytes(local_158,local_1c);\n  local_14 = get_int(local_15c + local_1c);\n  local_18 = check_val(local_15c,local_1c);\n  if (local_14 != local_18) {\n    prime_buf(local_15c);\n    send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n    return 1;\n  }\n  local_1e = get_short(local_158);\n  if (local_1e < 0xd) {\n    switch(local_1e) {\n    case 1:\n      local_20 = get_short(local_158 + 2);\n      prime_buf(local_15c);\n      if (local_20 == 0) {\n        power_off(param_1);\n      }\n      if (local_20 == 1) {\n        power_on(param_1);\n      }\n      send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n      break;\n    case 2:\n      local_2e = get_short(local_158 + 2);\n      prime_buf(local_15c);\n      iVar1 = set_temp(param_1,local_2e);\n      if (iVar1 == 2) {\n        local_158[2] = 1;\n      }\n      send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n      break;\n    case 3:\n      local_22 = get_short(local_158 + 2);\n      local_28 = get_int(local_154);\n      local_2c = get_int(auStack_150);\n      local_54 = get_int(auStack_14c);\n      local_40 = add_sensor(param_1,local_22,local_28,local_2c,local_54);\n      prime_buf(local_15c);\n      if (local_40 == 2) {\n        local_158[2] = 7;\n      }\n      if (local_40 == 3) {\n        local_158[2] = 8;\n      }\n      send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n      break;\n    case 4:\n      local_22 = get_short(local_158 + 2);\n      local_40 = remove_sensor(param_1,local_22);\n      prime_buf(local_15c);\n      if (local_40 == 1) {\n        local_158[2] = 6;\n      }\n      send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n      break;\n    case 5:\n      local_20 = get_short(local_158 + 2);\n      prime_buf(local_15c);\n      if (local_20 == 0) {\n        smoke_off(param_1);\n      }\n      if (local_20 == 1) {\n        smoke_on(param_1);\n      }\n      send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n      break;\n    case 6:\n      local_30 = get_short(local_158 + 2);\n      puVar2 = local_154;\n      local_3c = puVar2;\n      local_40 = add_steps(param_1,local_30);\n      prime_buf(local_15c);\n      if (local_40 == 3) {\n        local_158[2] = 3;\n      }\n      if (local_40 == 2) {\n        local_158[2] = 2;\n      }\n      if (local_40 == 1) {\n        local_158[2] = 1;\n      }\n      send((int)local_15c,(void *)0xc,(size_t)puVar2,__flags);\n      break;\n    case 7:\n      prime_buf(local_15c);\n      local_160 = 0;\n      bzero(local_414,0x78);\n      local_158[0] = 1;\n      local_158[2] = 7;\n      get_program(param_1,&local_160,local_414);\n      local_160 = local_160 * 0xc;\n      memcpy(local_154,&local_160,4);\n      sVar3 = local_160;\n      memcpy(auStack_150,local_414,local_160);\n      send((int)local_15c,(void *)(local_160 + 0xc),sVar3,__flags);\n      break;\n    case 8:\n      prime_buf(local_15c);\n      local_158[0] = 1;\n      local_158[2] = 8;\n      local_17c = 0x18;\n      local_40 = get_status(param_1,local_178);\n      memcpy(local_154,&local_17c,4);\n      sVar3 = 0x18;\n      memcpy(auStack_150,local_178,0x18);\n      send((int)local_15c,(void *)0x24,sVar3,__flags);\n      break;\n    case 9:\n      local_36 = get_short(local_158 + 2);\n      prime_buf(local_15c);\n      local_10 = (void *)0xc;\n      local_4c = 0;\n      local_40 = simulate_seconds(param_1,local_36);\n      local_180 = *(undefined4 *)(param_1 + 0x66c);\n      local_184 = *(undefined4 *)(param_1 + 0x650);\n      if (local_40 == 0) {\n        local_158[2] = 9;\n        sVar3 = 4;\n        memcpy(local_154,&local_180,4);\n        send((int)local_15c,(void *)0xc,sVar3,__flags);\n      }\n      if (local_40 == 2) {\n        local_158[0] = 1;\n        local_158[2] = 0xc;\n        local_4c = *(int *)(param_1 + 0x670) << 2;\n        local_50 = (void *)(param_1 + 8);\n        local_188 = *(int *)(param_1 + 0x670);\n        local_18c = *(undefined4 *)(param_1 + 0x664);\n        new_state(param_1);\n        if (local_188 != 0) {\n          memcpy(local_154,&local_188,4);\n          memcpy(auStack_150,local_50,local_4c);\n          local_10 = (void *)(local_4c + 0xc);\n        }\n        memcpy(local_15c + (int)local_10,&local_18c,4);\n        puVar2 = local_158 + (int)local_10;\n        sVar3 = 4;\n        local_10 = (void *)((int)local_10 + 4);\n        memcpy(puVar2,&local_184,4);\n        local_10 = (void *)((int)local_10 + 4);\n        send((int)local_15c,local_10,sVar3,__flags);\n      }\n      break;\n    case 10:\n      local_190 = validate_fw(param_1);\n      prime_buf(local_15c);\n      local_158[0] = 1;\n      local_158[2] = 10;\n      local_154[0] = 4;\n      sVar3 = 4;\n      memcpy(auStack_150,&local_190,4);\n      send((int)local_15c,(void *)0x10,sVar3,__flags);\n      break;\n    case 0xb:\n      prime_buf(local_15c);\n      local_158[0] = 1;\n      local_158[2] = 0xb;\n      local_194 = *(int *)(param_1 + 0x654) << 4;\n      get_sensors(param_1,local_414);\n      memcpy(local_154,&local_194,4);\n      sVar3 = local_194;\n      memcpy(auStack_150,local_414,local_194);\n      send((int)local_15c,(void *)(local_194 + 0xc),sVar3,__flags);\n      break;\n    case 0xc:\n      local_48 = get_signed_int(local_158 + 2);\n      prime_buf(local_15c);\n      iVar1 = set_ambient_temp(param_1,local_48);\n      if (iVar1 == 2) {\n        local_158[2] = 1;\n      }\n      send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n      break;\n    default:\n      goto _L21;\n    }\n  }\n  else {\n    if (local_1e == 0xff) {\n      exit_normal();\n      return 0;\n    }\n_L21:\n    prime_buf(local_15c);\n    local_158[2] = 5;\n    send((int)local_15c,(void *)0xc,in_stack_fffffbdc,__flags);\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "get_command",
                        "bzero",
                        "get_bytes",
                        "get_short",
                        "prime_buf",
                        "send",
                        "get_int",
                        "check_val",
                        "power_off",
                        "power_on",
                        "set_temp",
                        "add_sensor",
                        "remove_sensor",
                        "smoke_off",
                        "smoke_on",
                        "add_steps",
                        "get_program",
                        "memcpy",
                        "get_status",
                        "simulate_seconds",
                        "new_state",
                        "validate_fw",
                        "get_sensors",
                        "get_signed_int",
                        "set_ambient_temp",
                        "exit_normal"
                    ],
                    "calling_functions": [
                        "ui_main",
                        "get_command"
                    ],
                    "defined_in_file": "CROMU_00084_decompiled.c"
                }
            }
        ]
    }
}