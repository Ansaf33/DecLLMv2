{
    "file": "NRFIN_00039",
    "decompiled_code": {
        "service.c": [
            {
                "func_name": "newReport",
                "func_c_signature": "void newReport(int param_1)",
                "decompiled_code": "void newReport(int param_1) {\n  undefined4 *puVar1;\n  int __flags;\n  char local_1d;\n  undefined4 *local_1c;\n  undefined4 local_18;\n  short local_12;\n  short local_10;\n  short local_e;\n  \n  __flags = 0x1100c;\n  local_1d = '\\0';\n  local_18 = 0;\n  local_e = 0;\n  local_10 = 0;\n  local_12 = 0;\n  local_1c = (undefined4 *)0x0;\n  while (local_1d != ';') {\n    if (local_1d == ':') {\n      local_1c = (undefined4 *)malloc(8);\n      *(short *)(local_1c + 1) = local_10 - local_12;\n      *(short *)((int)local_1c + 6) = (local_e - local_10) + -1;\n      *local_1c = *(undefined4 *)(param_1 + 4);\n      *(undefined4 **)(param_1 + 4) = local_1c;\n      local_10 = local_e;\n      local_12 = local_12 + 1;\n    }\n    recv(0,&local_1d,1,__flags);\n    local_e = local_e + 1;\n  }\n  puVar1 = (undefined4 *)malloc(8);\n  *(short *)(puVar1 + 1) = local_10 - local_12;\n  *(short *)((int)puVar1 + 6) = (local_e - local_10) + -1;\n  *puVar1 = *(undefined4 *)(param_1 + 4);\n  *(undefined4 **)(param_1 + 4) = puVar1;\n  *(short *)(param_1 + 8) = local_e - (local_12 + 1);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "newReport",
                        "malloc",
                        "recv"
                    ],
                    "calling_functions": [
                        "newReport",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "sendReport",
                "func_c_signature": "void sendReport(undefined4 *param_1)",
                "decompiled_code": "void sendReport(undefined4 *param_1) {\n  undefined4 uVar1;\n  int iVar2;\n  undefined *puVar3;\n  undefined *puVar4;\n  int aiStack_30 [5];\n  undefined auStack_1c [8];\n  undefined4 local_14;\n  undefined4 *local_10;\n  \n  local_14 = 0;\n  puVar4 = auStack_1c;\n  for (local_10 = (undefined4 *)*param_1; local_10 != (undefined4 *)0x0;\n      local_10 = (undefined4 *)*local_10) {\n    uVar1 = local_10[1];\n    *(int *)(puVar4 + -8) = (int)*(short *)(param_1 + 2);\n    *(undefined4 *)(puVar4 + -0xc) = uVar1;\n    *(undefined4 *)(puVar4 + -0x10) = 1;\n    *(undefined4 *)(puVar4 + -0x14) = 0x11184;\n    iVar2 = transmit_all();\n    puVar3 = puVar4;\n    if (iVar2 != 0) {\n      puVar3 = puVar4 + -0x10;\n      *(undefined4 *)(puVar4 + -0x10) = 1;\n      *(undefined4 *)(puVar4 + -0x14) = 0x11195;\n      _terminate();\n    }\n    puVar4 = puVar3;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "sendReport",
                        "transmit_all",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "sendReport",
                        "newRecord"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "splitReport",
                "func_c_signature": "void splitReport(int **param_1,int **param_2,int **param_3)",
                "decompiled_code": "void splitReport(int **param_1,int **param_2,int **param_3) {\n  int **local_c;\n  int **local_8;\n  \n  if ((param_1 == (int **)0x0) || (*param_1 == (int *)0x0)) {\n    *param_2 = (int *)param_1;\n    *param_3 = (int *)0x0;\n  }\n  else {\n    local_c = param_1;\n    local_8 = (int **)*param_1;\n    while (local_8 != (int **)0x0) {\n      local_8 = (int **)*local_8;\n      if (local_8 != (int **)0x0) {\n        local_c = (int **)*local_c;\n        local_8 = (int **)*local_8;\n      }\n    }\n    *param_2 = (int *)param_1;\n    *param_3 = *local_c;\n    *local_c = (int *)0x0;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "splitReport"
                    ],
                    "calling_functions": [
                        "splitReport",
                        "sortReport"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "mergeReport",
                "func_c_signature": "undefined4 * mergeReport(undefined4 *param_1,undefined4 *param_2,int param_3)",
                "decompiled_code": "undefined4 * mergeReport(undefined4 *param_1,undefined4 *param_2,int param_3) {\n  int iVar1;\n  undefined4 *puVar2;\n  undefined4 uVar3;\n  \n  uVar3 = 0x1123c;\n  puVar2 = param_2;\n  if ((param_1 != (undefined4 *)0x0) && (puVar2 = param_1, param_2 != (undefined4 *)0x0)) {\n    iVar1 = strncmp((char *)((int)*(short *)(param_3 + 4) + param_1[1]),\n                    (char *)(param_2[1] + (int)*(short *)(param_3 + 4)),(int)*(short *)(param_3 + 6)\n                   );\n    if (iVar1 < 1) {\n      uVar3 = mergeReport(*param_1,param_2,param_3,uVar3);\n      *param_1 = uVar3;\n    }\n    else {\n      uVar3 = mergeReport(param_1,*param_2,param_3,uVar3);\n      *param_2 = uVar3;\n      puVar2 = param_2;\n    }\n  }\n  return puVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "mergeReport",
                        "strncmp"
                    ],
                    "calling_functions": [
                        "mergeReport",
                        "sortReport"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "sortReport",
                "func_c_signature": "void sortReport(int **param_1,undefined4 param_2)",
                "decompiled_code": "void sortReport(int **param_1,undefined4 param_2) {\n  int *piVar1;\n  undefined4 local_18;\n  undefined4 local_14;\n  int *local_10;\n  \n  local_10 = *param_1;\n  local_14 = 0;\n  local_18 = 0;\n  if ((local_10 != (int *)0x0) && (*local_10 != 0)) {\n    splitReport(local_10,&local_14,&local_18);\n    sortReport(&local_14,param_2);\n    sortReport(&local_18,param_2);\n    piVar1 = (int *)mergeReport(local_14,local_18,param_2);\n    *param_1 = piVar1;\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "sortReport",
                        "splitReport",
                        "mergeReport"
                    ],
                    "calling_functions": [
                        "sortReport",
                        "newRecord"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "filterReport",
                "func_c_signature": "void filterReport(undefined4 *param_1,undefined4 *param_2,int param_3)",
                "decompiled_code": "void filterReport(undefined4 *param_1,undefined4 *param_2,int param_3) {\n  int iVar1;\n  undefined4 *puVar2;\n  int **local_14;\n  undefined4 *local_10;\n  \n  local_10 = (undefined4 *)*param_1;\n  do {\n    if (local_10 == (undefined4 *)0x0) {\n      return;\n    }\n    for (local_14 = (int **)param_1[1]; *local_14 != (int *)0x0; local_14 = (int **)*local_14) {\n      iVar1 = strncmp((char *)((int)*(short *)(local_14 + 1) + local_10[1]),\n                      (char *)(*(short *)(local_14 + 1) + param_3),\n                      (int)*(short *)((int)local_14 + 6));\n      if (iVar1 == 0) {\n        puVar2 = (undefined4 *)malloc(8);\n        *puVar2 = *param_2;\n        puVar2[1] = local_10[1];\n        *param_2 = puVar2;\n        break;\n      }\n    }\n    local_10 = (undefined4 *)*local_10;\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "filterReport",
                        "strncmp",
                        "malloc"
                    ],
                    "calling_functions": [
                        "filterReport",
                        "newRecord"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "newRecord",
                "func_c_signature": "undefined4 newRecord(undefined4 *param_1)",
                "decompiled_code": "undefined4 newRecord(undefined4 *param_1) {\n  void *pvVar1;\n  undefined4 uVar2;\n  int iVar3;\n  undefined4 local_34;\n  undefined4 local_30;\n  undefined2 local_2c;\n  void *local_28;\n  char *local_24;\n  undefined2 local_1e;\n  undefined4 *local_1c;\n  undefined4 *local_18;\n  short local_14;\n  short local_12;\n  undefined4 *local_10;\n  \n  iVar3 = 0x11473;\n  local_1c = (undefined4 *)0x0;\n  local_1e = 0;\n  local_24 = (char *)0x0;\n  local_10 = (undefined4 *)0x0;\n  local_12 = 0;\n  local_1c = (undefined4 *)malloc(8);\n  *local_1c = 0;\n  pvVar1 = malloc(*(short *)(param_1 + 2) * 2);\n  local_1c[1] = pvVar1;\n  local_24 = (char *)malloc(*(short *)(param_1 + 2) * 2);\n  memset((void *)local_1c[1],0,(int)*(short *)(param_1 + 2));\n  for (local_10 = (undefined4 *)param_1[1]; local_10 != (undefined4 *)0x0;\n      local_10 = (undefined4 *)*local_10) {\n    memset(local_24,0,(int)*(short *)(param_1 + 2));\n    recv(0,local_24,(int)*(short *)((int)local_10 + 6),iVar3);\n    strcpy((char *)((int)local_12 + local_1c[1]),local_24);\n    local_12 = local_12 + *(short *)((int)local_10 + 6);\n  }\n  free(local_24);\n  iVar3 = startswith(local_1c[1],&DAT_00013000);\n  if (iVar3 == 0) {\n    iVar3 = startswith(local_1c[1],\"REPORT\");\n    if (iVar3 == 0) {\n      iVar3 = startswith(local_1c[1],&DAT_0001300b);\n      if (iVar3 == 0) {\n        iVar3 = startswith(local_1c[1],\"FREPORT\");\n        if (iVar3 == 0) {\n          local_28 = (void *)((int)*(short *)(param_1[1] + 4) + local_1c[1]);\n          iVar3 = startswith(local_28,\"ERROR\");\n          if (iVar3 == 0) {\n            *local_1c = *param_1;\n            *param_1 = local_1c;\n            uVar2 = 1;\n          }\n          else {\n            free(local_28);\n            free(local_1c);\n            uVar2 = 1;\n          }\n        }\n        else {\n          local_34 = 0;\n          local_30 = 0;\n          local_2c = *(undefined2 *)(param_1 + 2);\n          filterReport(param_1,&local_34,local_1c[1]);\n          sendReport(&local_34);\n          free((void *)local_1c[1]);\n          free(local_1c);\n          uVar2 = 1;\n        }\n      }\n      else {\n        local_18 = (undefined4 *)param_1[1];\n        for (local_14 = (short)*(char *)(local_1c[1] + 4);\n            (local_18 != (undefined4 *)0x0 && (local_14 != 0)); local_14 = local_14 + -1) {\n          local_18 = (undefined4 *)*local_18;\n        }\n        if (local_18 != (undefined4 *)0x0) {\n          sortReport(param_1,local_18);\n        }\n        free((void *)local_1c[1]);\n        free(local_1c);\n        uVar2 = 1;\n      }\n    }\n    else {\n      sendReport(param_1);\n      free((void *)local_1c[1]);\n      free(local_1c);\n      uVar2 = 1;\n    }\n  }\n  else {\n    free((void *)local_1c[1]);\n    free(local_1c);\n    uVar2 = 0;\n  }\n  return uVar2;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "newRecord",
                        "malloc",
                        "memset",
                        "recv",
                        "strcpy",
                        "free",
                        "startswith",
                        "filterReport",
                        "sendReport",
                        "sortReport"
                    ],
                    "calling_functions": [
                        "newRecord",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  int iVar1;\n  undefined4 local_20;\n  undefined4 local_1c;\n  undefined2 local_18;\n  undefined4 local_14;\n  undefined *local_c;\n  \n  local_c = &stack0x00000004;\n  local_20 = 0;\n  local_1c = 0;\n  local_18 = 0;\n  local_14 = 0;\n  newReport(&local_20);\n  do {\n    iVar1 = newRecord(&local_20);\n  } while (iVar1 != 0);\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "newReport",
                        "newRecord"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "NRFIN_00039_decompiled.c"
                }
            }
        ]
    }
}