{
    "file": "NRFIN_00040",
    "decompiled_code": {
        "service.c": [
            {
                "func_name": "object_find",
                "func_c_signature": "undefined4 object_find(char param_1)",
                "decompiled_code": "undefined4 object_find(char param_1) {\n  uint local_8;\n  \n  local_8 = 0;\n  while( true ) {\n    if (0xff < local_8) {\n      return 0;\n    }\n    if ((*(int *)(ns + local_8 * 4) != 0) && (param_1 == **(char **)(ns + local_8 * 4))) break;\n    local_8 = local_8 + 1;\n  }\n  return *(undefined4 *)(ns + local_8 * 4);\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "object_find"
                    ],
                    "calling_functions": [
                        "object_find",
                        "object_new",
                        "op_set"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "parse_id",
                "func_c_signature": "int parse_id(int *param_1,short *param_2,undefined *param_3)",
                "decompiled_code": "int parse_id(int *param_1,short *param_2,undefined *param_3) {\n  undefined4 local_1c;\n  ushort local_16;\n  int local_14;\n  int local_10;\n  \n  local_10 = 0;\n  local_14 = 0;\n  local_16 = 0;\n  local_14 = strnchr(*param_1,0x20,*param_2,0x11078);\n  if (local_14 == 0) {\n    local_10 = 0x24;\n  }\n  else {\n    local_16 = (short)local_14 - (short)*param_1;\n    local_1c = 0;\n    local_10 = str2unt32n(*param_1,local_16,0xff,0,&local_1c);\n    if (local_10 == 0) {\n      *param_3 = (char)local_1c;\n      *param_1 = local_16 + 1 + *param_1;\n      *param_2 = (*param_2 - local_16) + -1;\n    }\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "parse_id",
                        "strnchr",
                        "str2unt32n"
                    ],
                    "calling_functions": [
                        "parse_id",
                        "op_del",
                        "op_set",
                        "op_new"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "parse_type",
                "func_c_signature": "undefined4 parse_type(void **param_1,short *param_2,undefined4 *param_3)",
                "decompiled_code": "undefined4 parse_type(void **param_1,short *param_2,undefined4 *param_3) {\n  int iVar1;\n  ushort uVar2;\n  undefined4 local_10;\n  \n  local_10 = 0;\n  iVar1 = strnchr(*param_1,0x20,*param_2);\n  if (iVar1 == 0) {\n    local_10 = 0x24;\n  }\n  else {\n    uVar2 = (short)iVar1 - (short)*param_1;\n    iVar1 = memcmp(\"NUMBER\",*param_1,6);\n    if (iVar1 == 0) {\n      *param_3 = 1;\n    }\n    else {\n      iVar1 = memcmp(\"STRING\",*param_1,6);\n      if (iVar1 != 0) {\n        return 0x24;\n      }\n      *param_3 = 2;\n    }\n    *param_1 = (void *)(uVar2 + 1 + (int)*param_1);\n    *param_2 = (*param_2 - uVar2) + -1;\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "parse_type",
                        "strnchr",
                        "memcmp"
                    ],
                    "calling_functions": [
                        "parse_type",
                        "op_new"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "parse_number",
                "func_c_signature": "undefined4 parse_number(int *param_1,short *param_2,undefined4 param_3)",
                "decompiled_code": "undefined4 parse_number(int *param_1,short *param_2,undefined4 param_3) {\n  int iVar1;\n  ushort uVar2;\n  undefined4 local_10;\n  \n  iVar1 = strnchr(*param_1,0x20,*param_2,0x11236);\n  if (iVar1 == 0) {\n    local_10 = 0x24;\n  }\n  else {\n    uVar2 = (short)iVar1 - (short)*param_1;\n    local_10 = str2unt32n(*param_1,uVar2,0xffffffff,0,param_3);\n    *param_1 = uVar2 + 1 + *param_1;\n    *param_2 = (*param_2 - uVar2) + -1;\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "parse_number",
                        "strnchr",
                        "str2unt32n"
                    ],
                    "calling_functions": [
                        "parse_number",
                        "op_set",
                        "op_new"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "parse_string",
                "func_c_signature": "undefined4 parse_string(char **param_1,ushort *param_2,char *param_3)",
                "decompiled_code": "undefined4 parse_string(char **param_1,ushort *param_2,char *param_3) {\n  int iVar1;\n  size_t __n;\n  ushort uVar2;\n  undefined4 local_10;\n  \n  local_10 = 0;\n  iVar1 = strnchr(*param_1,0x20,*param_2,0x112e7);\n  if (iVar1 == 0) {\n    local_10 = 0x24;\n  }\n  else {\n    uVar2 = (short)iVar1 - (short)*param_1;\n    __n = *param_2 - 1;\n    if (0xeb < (int)(*param_2 - 1)) {\n      __n = 0xec;\n    }\n    strncpy(param_3,*param_1,__n);\n    *param_1 = *param_1 + uVar2 + 1;\n    *param_2 = (*param_2 - uVar2) - 1;\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "parse_string",
                        "strnchr",
                        "strncpy"
                    ],
                    "calling_functions": [
                        "parse_string",
                        "op_set",
                        "op_new"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "object_new",
                "func_c_signature": "int object_new(byte param_1,int param_2,undefined4 param_3,char *param_4)",
                "decompiled_code": "int object_new(byte param_1,int param_2,undefined4 param_3,char *param_4) {\n  int iVar1;\n  byte *local_14;\n  int local_10;\n  \n  local_10 = 0;\n  local_14 = (byte *)0x0;\n  local_10 = allocate(0x1000,0,&local_14);\n  if ((local_10 == 0) && (iVar1 = object_find(param_1), iVar1 == 0)) {\n    *local_14 = param_1;\n    *(undefined4 *)(local_14 + 4) = 0;\n    *(undefined4 *)(local_14 + 8) = 0;\n    *(undefined4 *)(local_14 + 0xc) = 0;\n    if (param_2 == 1) {\n      *(undefined4 *)(local_14 + 4) = 1;\n      *(byte **)(local_14 + 8) = local_14 + 0x40;\n      **(undefined4 **)(local_14 + 8) = param_3;\n    }\n    else {\n      if (param_2 != 2) {\n        return 0x24;\n      }\n      *(undefined4 *)(local_14 + 4) = 2;\n      *(byte **)(local_14 + 0xc) = local_14 + 0x80;\n      if (param_4 != (char *)0x0) {\n        strncpy(*(char **)(local_14 + 0xc),param_4,0xec);\n      }\n    }\n    *(byte **)(ns + (uint)param_1 * 4) = local_14;\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "object_new",
                        "allocate",
                        "object_find",
                        "strncpy"
                    ],
                    "calling_functions": [
                        "object_new",
                        "op_new"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "op_del",
                "func_c_signature": "int op_del(undefined4 param_1,undefined4 param_2)",
                "decompiled_code": "int op_del(undefined4 param_1,undefined4 param_2) {\n  int iVar1;\n  char local_15;\n  uint local_14;\n  int local_10;\n  \n  local_10 = 0;\n  local_15 = '\\0';\n  local_14 = 0;\n  local_10 = parse_id(param_1,param_2,&local_15);\n  if (local_10 == 0) {\n    for (local_14 = 0; local_14 < 0x100; local_14 = local_14 + 1) {\n      if ((*(int *)(ns + local_14 * 4) != 0) && (**(char **)(ns + local_14 * 4) == local_15)) {\n        iVar1 = deallocate(*(undefined4 *)(ns + local_14 * 4),0x1000);\n        *(undefined4 *)(ns + local_14 * 4) = 0;\n        return iVar1;\n      }\n    }\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "op_del",
                        "parse_id",
                        "deallocate"
                    ],
                    "calling_functions": [
                        "op_del",
                        "parse_json"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "op_set",
                "func_c_signature": "int op_set(int *param_1,ushort *param_2)",
                "decompiled_code": "int op_set(int *param_1,ushort *param_2) {\n  undefined local_1b;\n  ushort local_1a;\n  int local_18;\n  int local_14;\n  int local_10;\n  \n  local_10 = 0;\n  local_1b = 0;\n  local_14 = 0;\n  local_18 = 0;\n  local_1a = 0;\n  local_10 = parse_id(param_1,param_2,&local_1b,0x11581);\n  if (local_10 == 0) {\n    local_14 = object_find(local_1b);\n    if (local_14 == 0) {\n      *param_1 = *param_1 + (*param_2 - 1);\n      *param_2 = 0;\n    }\n    else if (*(int *)(local_14 + 4) == 1) {\n      local_18 = *param_1;\n      local_1a = *param_2;\n      local_10 = parse_number(param_1,param_2,*(undefined4 *)(local_14 + 8));\n      if ((local_10 != 0) && (local_10 == 0x25)) {\n        local_10 = 0;\n        *(undefined4 *)(local_14 + 8) = 0;\n        *param_1 = local_18;\n        *param_2 = local_1a;\n        local_10 = parse_string(param_1,param_2,*(undefined4 *)(local_14 + 0xc));\n      }\n    }\n    else if (*(int *)(local_14 + 4) == 2) {\n      local_10 = parse_string(param_1,param_2,*(undefined4 *)(local_14 + 0xc));\n    }\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "op_set",
                        "parse_id",
                        "object_find",
                        "parse_number",
                        "parse_string"
                    ],
                    "calling_functions": [
                        "op_set",
                        "parse_json"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "op_new",
                "func_c_signature": "int op_new(undefined4 *param_1,undefined2 *param_2)",
                "decompiled_code": "int op_new(undefined4 *param_1,undefined2 *param_2) {\n  int iVar1;\n  undefined4 *puVar2;\n  byte bVar3;\n  undefined4 local_114 [59];\n  undefined4 local_28;\n  undefined2 local_22;\n  undefined4 local_20;\n  int local_1c;\n  undefined local_15;\n  int local_14;\n  int local_10;\n  \n  bVar3 = 0;\n  local_10 = 0;\n  local_14 = 0;\n  local_15 = 0;\n  local_10 = parse_id(param_1,param_2,&local_15,0x116d8);\n  if (local_10 == 0) {\n    local_1c = 0;\n    local_10 = parse_type(param_1,param_2,&local_1c);\n    if (local_10 == 0) {\n      local_14 = strnchr(*param_1,0x20,*param_2);\n      if (local_14 == 0) {\n        local_10 = object_new(local_15,local_1c,0,0);\n      }\n      else if (local_1c == 1) {\n        local_20 = *param_1;\n        local_22 = *param_2;\n        local_10 = parse_number(param_1,param_2,&local_28);\n        if (local_10 == 0) {\n          local_10 = object_new(local_15,1,local_28,0);\n        }\n        else if (local_10 == 0x25) {\n          local_10 = 0x25;\n          puVar2 = local_114;\n          for (iVar1 = 0x3b; iVar1 != 0; iVar1 = iVar1 + -1) {\n            *puVar2 = 0;\n            puVar2 = puVar2 + (uint)bVar3 * -2 + 1;\n          }\n          local_10 = parse_string(&local_20,&local_22,local_114);\n          if (local_10 == 0) {\n            local_10 = object_new(local_15,2,0,local_114);\n          }\n        }\n        else {\n          local_10 = 0x24;\n        }\n      }\n      else if (local_1c == 2) {\n        puVar2 = local_114;\n        for (iVar1 = 0x3b; iVar1 != 0; iVar1 = iVar1 + -1) {\n          *puVar2 = 0;\n          puVar2 = puVar2 + (uint)bVar3 * -2 + 1;\n        }\n        local_10 = parse_string(param_1,param_2,local_114);\n        if (local_10 == 0) {\n          local_10 = object_new(local_15,2,0,local_114);\n        }\n      }\n      else {\n        local_10 = 0x24;\n      }\n    }\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "op_new",
                        "parse_id",
                        "parse_type",
                        "strnchr",
                        "object_new",
                        "parse_number",
                        "parse_string"
                    ],
                    "calling_functions": [
                        "op_new",
                        "parse_json"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "parse_json",
                "func_c_signature": "int parse_json(short param_1)",
                "decompiled_code": "int parse_json(short param_1) {\n  undefined1 *__s2;\n  int iVar1;\n  short local_2e;\n  undefined1 *local_2c;\n  short local_26;\n  int local_24;\n  int local_20;\n  undefined1 *local_1c;\n  undefined1 *local_18;\n  short local_12;\n  int local_10;\n  \n  local_12 = param_1;\n  local_10 = 0;\n  local_2c = json;\n  local_18 = (undefined1 *)0x0;\n  local_1c = (undefined1 *)0x0;\n  local_20 = 0;\n  local_24 = 0;\n  local_2e = 0;\n  local_26 = 0;\n  if (param_1 != 0) {\n    do {\n      while( true ) {\n        iVar1 = strnchr(local_2c,10,local_12);\n        if (iVar1 == 0) {\n          return local_10;\n        }\n        local_1c = (undefined1 *)(iVar1 + 1);\n        local_12 = local_12 + -1;\n        if (local_12 == 0) {\n          return local_10;\n        }\n        local_20 = strnchr(local_1c,10,local_12);\n        if (local_20 == 0) {\n          return 0x24;\n        }\n        local_2e = (short)local_20 - (short)local_1c;\n        local_2c = local_1c;\n        local_12 = local_12 - local_2e;\n        local_24 = strnchr(local_1c,0x20,local_2e);\n        __s2 = local_2c;\n        if (local_24 == 0) {\n          return 0x24;\n        }\n        local_26 = (short)local_24 - (short)local_2c;\n        local_2e = local_2e - local_26;\n        if (local_26 != 3) {\n          return 0x24;\n        }\n        local_18 = local_2c;\n        local_2c = local_2c + 4;\n        iVar1 = memcmp(&DAT_0001300e,__s2,3);\n        if (iVar1 != 0) break;\n        local_10 = op_new(&local_2c,&local_2e);\njoined_r0x00011a6b:\n        if (local_10 != 0) {\n          return local_10;\n        }\n      }\n      iVar1 = memcmp(&DAT_00013012,local_18,3);\n      if (iVar1 == 0) {\n        local_10 = op_set(&local_2c,&local_2e);\n        goto joined_r0x00011a6b;\n      }\n      iVar1 = memcmp(&DAT_00013016,local_18,3);\n      if (iVar1 != 0) {\n        return 0x24;\n      }\n      local_10 = op_del(&local_2c,&local_2e);\n    } while (local_10 == 0);\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "parse_json",
                        "strnchr",
                        "memcmp",
                        "op_new",
                        "op_set",
                        "op_del"
                    ],
                    "calling_functions": [
                        "parse_json",
                        "deserialize"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "deserialize",
                "func_c_signature": "undefined4 deserialize(void)",
                "decompiled_code": "undefined4 deserialize(void) {\n  ushort local_16;\n  uint local_14;\n  int local_10;\n  \n  local_10 = 0;\n  local_16 = 0;\n  local_14 = 0;\n  local_10 = receive_all(0,&local_16,2,&local_14);\n  if ((local_10 == 0) && (local_14 == 2)) {\n    local_14 = 0;\n    local_10 = receive_all(0,json,local_16,&local_14);\n    if ((local_10 == 0) && (local_16 == local_14)) {\n      local_10 = parse_json(local_16);\n    }\n    else {\n      local_10 = 0x20;\n    }\n  }\n  else {\n    local_10 = 0x20;\n  }\n  return local_10;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "deserialize",
                        "receive_all",
                        "parse_json"
                    ],
                    "calling_functions": [
                        "deserialize",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "serialize",
                "func_c_signature": "int serialize(void)",
                "decompiled_code": "int serialize(void) {\n  char *pcVar1;\n  int iVar2;\n  undefined4 *puVar3;\n  undefined4 local_12c [64];\n  undefined *local_2c;\n  uint local_28;\n  char *local_24;\n  int local_20;\n  \n  local_20 = 0;\n  puVar3 = local_12c;\n  for (iVar2 = 0x40; iVar2 != 0; iVar2 = iVar2 + -1) {\n    *puVar3 = 0;\n    puVar3 = puVar3 + 1;\n  }\n  local_28 = 0;\n  do {\n    if (0xff < local_28) {\n      return local_20;\n    }\n    local_12c[0]._0_1_ = 0;\n    local_24 = (char *)0x0;\n    local_2c = *(undefined **)(ns + local_28 * 4);\n    if (local_2c != (undefined *)0x0) {\n      iVar2 = uint2str32(local_12c,0xff,*local_2c);\n      local_24 = (char *)((int)local_24 + iVar2);\n      if (*(int *)(local_2c + 4) == 1) {\n        pcVar1 = strncpy(local_24 + (int)local_12c,\" NUMBER \",0xff - (int)local_24);\n        local_24 = local_24 + (int)pcVar1;\n        iVar2 = uint2str32(local_24 + (int)local_12c,0xff - (int)local_24,\n                           **(undefined4 **)(local_2c + 8));\n        local_24 = local_24 + iVar2;\n      }\n      else if (*(int *)(local_2c + 4) == 2) {\n        pcVar1 = strncpy(local_24 + (int)local_12c,\" STRING \",0xff - (int)local_24);\n        local_24 = local_24 + (int)pcVar1;\n        pcVar1 = strncpy(local_24 + (int)local_12c,*(char **)(local_2c + 0xc),0xff - (int)local_24);\n        local_24 = local_24 + (int)pcVar1;\n      }\n      local_24[(int)local_12c] = '\\n';\n      local_20 = transmit_all(1,local_12c,local_24 + 1,0);\n      if (local_20 != 0) {\n        return 0x21;\n      }\n    }\n    local_28 = local_28 + 1;\n  } while( true );\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "serialize",
                        "uint2str32",
                        "strncpy",
                        "transmit_all"
                    ],
                    "calling_functions": [
                        "serialize",
                        "main"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "int main(void)",
                "decompiled_code": "int main(void) {\n  int iVar1;\n  char local_21;\n  int local_20;\n  undefined4 local_1c;\n  int local_18;\n  int local_14;\n  undefined *local_10;\n  \n  local_10 = &stack0x00000004;\n  local_14 = 0;\n  local_20 = 0;\n  local_1c = 0;\n  memset(ns,0,0x400);\n  do {\n    while( true ) {\n      while( true ) {\n        local_18 = 0;\n        local_21 = '\\0';\n        while (local_18 == 0) {\n          iVar1 = receive_all(0,&local_21,1,&local_20);\n          if (iVar1 != 0) {\n            return 0x20;\n          }\n          local_14 = 0;\n          if (local_20 != 0) {\n            local_18 = 1;\n          }\n        }\n        if (local_21 != '\\x01') break;\n        local_14 = deserialize();\n        if (local_14 != 0) {\n          return local_14;\n        }\n      }\n      if (local_21 == '\\x02') break;\n      if (local_21 == '\\x03') {\n        return local_14;\n      }\n    }\n    local_14 = serialize();\n  } while (local_14 == 0);\n  return local_14;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "memset",
                        "receive_all",
                        "deserialize",
                        "serialize"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "NRFIN_00040_decompiled.c"
                }
            }
        ]
    }
}