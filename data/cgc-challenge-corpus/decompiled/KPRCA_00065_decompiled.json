{
    "file": "KPRCA_00065",
    "decompiled_code": {
        "main.c": [
            {
                "func_name": "main",
                "func_c_signature": "undefined4 main(void)",
                "decompiled_code": "undefined4 main(void) {\n  int iVar1;\n  undefined *puVar2;\n  size_t sStackY_34;\n  FILE *pFStack_24;\n  undefined auStack_20 [8];\n  int local_18;\n  undefined4 local_14;\n  undefined *local_10;\n  \n  local_10 = &stack0x00000004;\n  puVar2 = auStack_20;\n  local_14 = 0;\n  local_18 = 0;\n  fbuffered(stdout,1);\n  while( true ) {\n    *(undefined4 *)(puVar2 + -8) = 4;\n    *(int **)(puVar2 + -0xc) = &local_18;\n    *(undefined4 *)(puVar2 + -0x10) = 0;\n    *(undefined4 *)(puVar2 + -0x14) = 0x11051;\n    iVar1 = read_n();\n    if (iVar1 != 4) break;\n    if (local_18 == 0x4b414853) {\n      *(undefined4 **)(puVar2 + -0x10) = &local_14;\n      *(undefined4 *)(puVar2 + -0x14) = 0x11079;\n      otp_handshake();\n    }\n    else if (local_18 == 0x4f4e4547) {\n      *(undefined4 *)(puVar2 + -0x10) = local_14;\n      *(undefined4 *)(puVar2 + -0x14) = 0x11094;\n      otp_generate_otp();\n    }\n    else if (local_18 == 0x444e5458) {\n      *(undefined4 *)(puVar2 + -0x10) = local_14;\n      *(undefined4 *)(puVar2 + -0x14) = 0x110af;\n      otp_extend_session();\n    }\n    else if (local_18 == 0x44454553) {\n      *(undefined4 *)(puVar2 + -0x10) = local_14;\n      *(undefined4 *)(puVar2 + -0x14) = 0x110ca;\n      otp_set_seeds();\n    }\n    else if (local_18 == 0x49524556) {\n      *(undefined4 *)(puVar2 + -0x10) = local_14;\n      *(undefined4 *)(puVar2 + -0x14) = 0x110e8;\n      otp_verify_otp();\n    }\n    else {\n      if (local_18 == 0x54495551) {\n        *(undefined **)(puVar2 + -8) = stdout;\n        *(undefined4 *)(puVar2 + -0xc) = 1;\n        *(undefined **)(puVar2 + -0x10) = &DAT_00015000;\n        *(undefined4 *)(puVar2 + -0x14) = 0x11114;\n        fwrite(*(void **)(puVar2 + -0x10),*(size_t *)(puVar2 + -0xc),*(size_t *)(puVar2 + -8),\n               *(FILE **)(puVar2 + -4));\n        *(undefined **)(puVar2 + -0x10) = stdout;\n        *(undefined4 *)(puVar2 + -0x14) = 0x11128;\n        fflush(*(FILE **)(puVar2 + -0x10));\n        *(undefined4 *)(puVar2 + -0x10) = 0;\n        *(undefined4 *)(puVar2 + -0x14) = 0x11135;\n        _terminate();\n        puVar2 = puVar2 + -0x10;\n      }\n      *(undefined **)(puVar2 + -8) = stdout;\n      *(undefined4 *)(puVar2 + -0xc) = 1;\n      *(undefined **)(puVar2 + -0x10) = &DAT_00015002;\n      *(undefined4 *)(puVar2 + -0x14) = 0x1114f;\n      fwrite(*(void **)(puVar2 + -0x10),*(size_t *)(puVar2 + -0xc),*(size_t *)(puVar2 + -8),\n             *(FILE **)(puVar2 + -4));\n    }\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "fbuffered",
                        "read_n",
                        "otp_handshake",
                        "otp_generate_otp",
                        "otp_extend_session",
                        "otp_set_seeds",
                        "otp_verify_otp",
                        "fwrite",
                        "fflush",
                        "_terminate"
                    ],
                    "calling_functions": [
                        "main",
                        "_start"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            }
        ],
        "otp.c": [
            {
                "func_name": "_otp_populate",
                "func_c_signature": "void _otp_populate(uint *param_1)",
                "decompiled_code": "void _otp_populate(uint *param_1) {\n  byte local_1014 [4096];\n  uint local_14;\n  uint local_10;\n  \n  local_14 = param_1[0x22] & 0xfff;\n  memcpy(local_1014,(void *)(local_14 + (int)secret),0x1000 - local_14);\n  if (local_14 != 0) {\n    memcpy((void *)((int)&local_14 - local_14),secret,local_14);\n  }\n  local_14 = *param_1;\n  for (local_10 = local_14; local_10 < 0x80; local_10 = local_10 + 1) {\n    *(byte *)((int)param_1 + local_10 + 4) =\n         *(byte *)((int)param_1 + (local_10 & 3) + 0x84) ^ local_1014[local_14 & 0xfff];\n    local_14 = local_14 + 2;\n  }\n  param_1[0x22] = local_14;\n  *param_1 = 0x80;\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "_otp_populate",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "_otp_populate",
                        "otp_generate_otp",
                        "otp_set_seeds",
                        "otp_verify_otp"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "_otp_consume",
                "func_c_signature": "undefined ** _otp_consume(undefined **param_1,undefined *param_2)",
                "decompiled_code": "undefined ** _otp_consume(undefined **param_1,undefined *param_2) {\n  undefined **ppuVar1;\n  \n  ppuVar1 = &_GLOBAL_OFFSET_TABLE_;\n  if (param_2 <= *param_1) {\n    memcpy(param_1 + 1,(undefined *)((int)param_1 + (int)(param_2 + 4)),(int)*param_1 - (int)param_2\n          );\n    *param_1 = *param_1 + -(int)param_2;\n    ppuVar1 = param_1;\n  }\n  return ppuVar1;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "_otp_consume",
                        "memcpy"
                    ],
                    "calling_functions": [
                        "_otp_consume",
                        "otp_generate_otp"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "otp_handshake",
                "func_c_signature": "void otp_handshake(void **param_1)",
                "decompiled_code": "void otp_handshake(void **param_1) {\n  void *pvVar1;\n  int iVar2;\n  FILE *__s;\n  undefined4 local_30;\n  undefined local_2c [8];\n  byte local_24 [8];\n  void *local_1c;\n  void *local_18;\n  byte *local_14;\n  uint local_10;\n  \n  __s = (FILE *)0x115d4;\n  if (*param_1 != (void *)0x0) {\n    free(*param_1);\n    *param_1 = (void *)0x0;\n  }\n  random();\n  fwrite(local_24,8,(size_t)stdout,__s);\n  local_14 = local_24;\n  for (local_10 = 0; local_10 < 8; local_10 = local_10 + 1) {\n    *local_14 = *local_14 >> 4 | *local_14 << 4;\n    local_14 = local_14 + 1;\n  }\n  iVar2 = read_n(0,local_2c,8);\n  if (iVar2 == 8) {\n    local_30 = 0;\n    iVar2 = read_n(0,&local_30,4);\n    if ((iVar2 == 4) &&\n       ((iVar2 = memcmp(local_24,local_2c,8), iVar2 == 0 ||\n        (iVar2 = memcmp(secret,local_2c,8), iVar2 == 0)))) {\n      local_18 = malloc(0x90);\n      memset(local_18,0,0x90);\n      *(undefined4 *)((int)local_18 + 0x84) = local_30;\n      pvVar1 = secret;\n      local_1c = secret;\n      for (local_10 = 0; (int)local_10 < 0x400; local_10 = local_10 + 1) {\n        *(int *)((int)local_18 + 0x88) =\n             *(int *)((int)local_18 + 0x88) + *(int *)((int)pvVar1 + local_10 * 4);\n      }\n      *(uint *)((int)local_18 + 0x88) = *(uint *)((int)local_18 + 0x88) & 0xfff;\n      fwrite((void *)((int)local_18 + 0x88),4,(size_t)stdout,__s);\n      fwrite(&DAT_00015004,1,(size_t)stdout,__s);\n      *(undefined *)((int)local_18 + 0x8c) = 3;\n      *param_1 = local_18;\n      return;\n    }\n  }\n  *param_1 = (void *)0x0;\n  fwrite(&DAT_00015006,1,(size_t)stdout,__s);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "otp_handshake",
                        "free",
                        "random",
                        "fwrite",
                        "read_n",
                        "memcmp",
                        "malloc",
                        "memset"
                    ],
                    "calling_functions": [
                        "main",
                        "otp_handshake"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "otp_generate_otp",
                "func_c_signature": "void otp_generate_otp(uint *param_1)",
                "decompiled_code": "void otp_generate_otp(uint *param_1) {\n  int iVar1;\n  FILE *__s;\n  uint local_14;\n  uint local_10;\n  \n  __s = (FILE *)0x117fe;\n  local_14 = 0;\n  iVar1 = read_n(0,&local_14,4);\n  if ((((iVar1 == 4) && (param_1 != (uint *)0x0)) && (*(char *)(param_1 + 0x23) != '\\0')) &&\n     ((local_14 < 0x81 && (local_14 != 0)))) {\n    if (*param_1 < local_14) {\n      _otp_populate(param_1);\n    }\n    for (local_10 = 0; local_10 < local_14; local_10 = local_10 + 1) {\n      printf(\"%02X\",(uint)*(byte *)((int)param_1 + local_10 + 4));\n    }\n    _otp_consume(param_1,local_14);\n    fwrite(&DAT_00015004,1,(size_t)stdout,__s);\n    *(char *)(param_1 + 0x23) = *(char *)(param_1 + 0x23) + -1;\n  }\n  else {\n    fwrite(&DAT_00015006,1,(size_t)stdout,__s);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "otp_generate_otp",
                        "read_n",
                        "_otp_populate",
                        "printf",
                        "_otp_consume",
                        "fwrite"
                    ],
                    "calling_functions": [
                        "main",
                        "otp_generate_otp"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "otp_extend_session",
                "func_c_signature": "void otp_extend_session(int param_1)",
                "decompiled_code": "void otp_extend_session(int param_1) {\n  int iVar1;\n  FILE *__s;\n  undefined local_2016 [8192];\n  ushort local_16;\n  undefined *local_14;\n  int local_10;\n  \n  __s = (FILE *)0x11944;\n  local_10 = 0;\n  local_16 = 0;\n  local_14 = (undefined *)0x0;\n  iVar1 = read_n(0,&local_16,2);\n  if (iVar1 == 2) {\n    __s = (FILE *)0x0;\n    local_10 = read_until(0,local_2016,0x2000);\n    if (((local_10 != 0) && (param_1 != 0)) && (local_16 != 0)) {\n      local_14 = (undefined *)malloc(local_16 + 1);\n      *local_14 = 0;\n      memcpy(local_14 + 1,local_2016,(uint)local_16);\n      *(undefined *)(param_1 + 0x8c) = 3;\n      fwrite(local_14,local_16 + 1,(size_t)stdout,__s);\n      free(local_14);\n      return;\n    }\n  }\n  fwrite(&DAT_00015006,1,(size_t)stdout,__s);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "otp_extend_session",
                        "read_n",
                        "read_until",
                        "malloc",
                        "memcpy",
                        "fwrite",
                        "free"
                    ],
                    "calling_functions": [
                        "main",
                        "otp_extend_session"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "otp_set_seeds",
                "func_c_signature": "void otp_set_seeds(undefined4 *param_1)",
                "decompiled_code": "void otp_set_seeds(undefined4 *param_1) {\n  int iVar1;\n  FILE *__s;\n  undefined4 local_14;\n  undefined4 local_10 [2];\n  \n  __s = (FILE *)0x11a6a;\n  local_10[0] = 0;\n  local_14 = 0;\n  iVar1 = read_n(0,local_10,4);\n  if (((iVar1 == 4) && (iVar1 = read_n(0,&local_14,4), iVar1 == 4)) &&\n     (param_1 != (undefined4 *)0x0)) {\n    param_1[0x21] = local_10[0];\n    param_1[0x22] = local_14;\n    *param_1 = 0;\n    memset(param_1 + 1,0,0x80);\n    _otp_populate(param_1);\n    fwrite(&DAT_00015004,1,(size_t)stdout,__s);\n  }\n  else {\n    fwrite(&DAT_00015006,1,(size_t)stdout,__s);\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "otp_set_seeds",
                        "read_n",
                        "memset",
                        "_otp_populate",
                        "fwrite"
                    ],
                    "calling_functions": [
                        "main",
                        "otp_set_seeds"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "otp_verify_otp",
                "func_c_signature": "void otp_verify_otp(void)",
                "decompiled_code": "void otp_verify_otp(void) {\n  int iVar1;\n  uint uVar2;\n  FILE *__s;\n  undefined local_128 [4];\n  undefined auStack_124 [128];\n  undefined4 local_a4;\n  undefined4 local_a0;\n  uint local_98;\n  undefined4 local_94;\n  undefined4 local_90;\n  undefined local_8c [132];\n  \n  __s = (FILE *)0x11b57;\n  local_90 = 0;\n  local_94 = 0;\n  local_98 = 0;\n  iVar1 = read_n(0,&local_94,4);\n  if ((((iVar1 == 4) && (iVar1 = read_n(0,&local_90,4), iVar1 == 4)) &&\n      (iVar1 = read_n(0,&local_98,4), iVar1 == 4)) &&\n     (((uVar2 = read_n(0,local_8c,local_98), uVar2 == local_98 && (local_98 < 0x81)) &&\n      (local_98 != 0)))) {\n    memset(local_128,0,0x90);\n    local_a4 = local_90;\n    local_a0 = local_94;\n    _otp_populate(local_128);\n    iVar1 = memcmp(auStack_124,local_8c,local_98);\n    if (iVar1 == 0) {\n      fwrite(&DAT_00015004,1,(size_t)stdout,__s);\n      return;\n    }\n  }\n  fwrite(&DAT_00015006,1,(size_t)stdout,__s);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "otp_verify_otp",
                        "read_n",
                        "memset",
                        "_otp_populate",
                        "memcmp",
                        "fwrite"
                    ],
                    "calling_functions": [
                        "main",
                        "otp_verify_otp"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            }
        ],
        "readuntil.c": [
            {
                "func_name": "read_until",
                "func_c_signature": "void read_until(undefined4 param_1,undefined4 param_2,undefined4 param_3,char param_4)",
                "decompiled_code": "void read_until(undefined4 param_1,undefined4 param_2,undefined4 param_3,char param_4) {\n  fflush((FILE *)stdout);\n  freaduntil(param_2,param_3,(int)param_4,stdin);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "read_until",
                        "fflush",
                        "freaduntil"
                    ],
                    "calling_functions": [
                        "otp_extend_session",
                        "read_until"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            },
            {
                "func_name": "read_n",
                "func_c_signature": "void read_n(undefined4 param_1,void *param_2,size_t param_3)",
                "decompiled_code": "void read_n(undefined4 param_1,void *param_2,size_t param_3) {\n  FILE *__stream;\n  \n  __stream = (FILE *)0x11d38;\n  fflush((FILE *)stdout);\n  fread(param_2,param_3,(size_t)stdin,__stream);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "read_n",
                        "fflush",
                        "fread"
                    ],
                    "calling_functions": [
                        "main",
                        "otp_handshake",
                        "otp_generate_otp",
                        "otp_extend_session",
                        "otp_set_seeds",
                        "otp_verify_otp",
                        "read_n"
                    ],
                    "defined_in_file": "KPRCA_00065_decompiled.c"
                }
            }
        ]
    }
}