{
    "file": "users",
    "decompiled_code": {
        "users.c": [
            {
                "func_name": "userid_compare",
                "func_c_signature": "void userid_compare(char **param_1,char **param_2)",
                "decompiled_code": "void userid_compare(char **param_1,char **param_2) {\n  strcmp(*param_1,*param_2);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "userid_compare",
                        "strcmp"
                    ],
                    "calling_functions": [
                        "userid_compare"
                    ],
                    "defined_in_file": "users_decompiled.c"
                }
            },
            {
                "func_name": "list_entries_users",
                "func_c_signature": "void list_entries_users(long param_1,char **param_2)",
                "decompiled_code": "void list_entries_users(long param_1,char **param_2) {\n  char cVar1;\n  void *__base;\n  undefined8 uVar2;\n  char **local_48;\n  long local_40;\n  long local_28;\n  size_t local_20;\n  \n  __base = (void *)xinmalloc(param_1,8);\n  local_20 = 0;\n  local_48 = param_2;\n  local_40 = param_1;\n  while( true ) {\n    if (local_40 == 0) break;\n    if ((**local_48 != '\\0') && (*(short *)(local_48 + 7) == 7)) {\n      uVar2 = extract_trimmed_name(local_48);\n      *(undefined8 *)(local_20 * 8 + (long)__base) = uVar2;\n      local_20 = local_20 + 1;\n    }\n    local_48 = local_48 + 9;\n    local_40 = local_40 + -1;\n  }\n  qsort(__base,local_20,8,userid_compare);\n  for (local_28 = 0; local_28 < (long)local_20; local_28 = local_28 + 1) {\n    if (local_28 < (long)(local_20 - 1)) {\n      cVar1 = ' ';\n    }\n    else {\n      cVar1 = '\\n';\n    }\n    fputs_unlocked(*(char **)((long)__base + local_28 * 8),_stdout);\n    putchar_unlocked((int)cVar1);\n  }\n  for (local_28 = 0; local_28 < (long)local_20; local_28 = local_28 + 1) {\n    free(*(void **)((long)__base + local_28 * 8));\n  }\n  free(__base);\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "list_entries_users",
                        "xinmalloc",
                        "extract_trimmed_name",
                        "qsort",
                        "fputs_unlocked",
                        "putchar_unlocked",
                        "free"
                    ],
                    "calling_functions": [
                        "list_entries_users",
                        "users"
                    ],
                    "defined_in_file": "users_decompiled.c"
                }
            },
            {
                "func_name": "users",
                "func_c_signature": "void users(undefined8 param_1,uint param_2)",
                "decompiled_code": "void users(undefined8 param_1,uint param_2) {\n  int iVar1;\n  undefined8 uVar2;\n  int *piVar3;\n  long in_FS_OFFSET;\n  undefined8 local_38;\n  void *local_30;\n  undefined *local_28;\n  long local_20;\n  \n  local_20 = *(long *)(in_FS_OFFSET + 0x28);\n  iVar1 = read_utmp(param_1,&local_38,&local_30,param_2 | 2);\n  if (iVar1 != 0) {\n    uVar2 = quotearg_n_style_colon(0,3,param_1);\n    piVar3 = __errno_location();\n    local_28 = &DAT_001008db;\n    error(1,*piVar3,&DAT_001008db,uVar2);\n  }\n  list_entries_users(local_38,local_30);\n  free(local_30);\n  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "users",
                        "read_utmp",
                        "quotearg_n_style_colon",
                        "__errno_location",
                        "error",
                        "list_entries_users",
                        "free",
                        "__stack_chk_fail"
                    ],
                    "calling_functions": [
                        "users",
                        "main"
                    ],
                    "defined_in_file": "users_decompiled.c"
                }
            },
            {
                "func_name": "usage",
                "func_c_signature": "void usage(int param_1)",
                "decompiled_code": "void usage(int param_1) {\n  FILE *pFVar1;\n  undefined8 uVar2;\n  char *pcVar3;\n  \n  uVar2 = _program_name;\n  if (param_1 == 0) {\n    pcVar3 = (char *)gettext(\"Usage: %s [OPTION]... [FILE]\\n\");\n    printf(pcVar3,uVar2);\n    pcVar3 = (char *)gettext(\n                            \"Output who is currently logged in according to FILE.\\nIf FILE is not specified, use %s.  %s as FILE is common.\\n\\n\"\n                            );\n    printf(pcVar3,\"/var/run/utmp\",\"/var/log/wtmp\");\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --help        display this help and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    pFVar1 = _stdout;\n    pcVar3 = (char *)gettext(\"      --version     output version information and exit\\n\");\n    fputs_unlocked(pcVar3,pFVar1);\n    emit_ancillary_info(\"users\");\n  }\n  else {\n    pcVar3 = (char *)gettext(\"Try \\'%s --help\\' for more information.\\n\");\n    fprintf(_stderr,pcVar3,uVar2);\n  }\n                    /* WARNING: Subroutine does not return */\n  exit(param_1);\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "usage",
                        "gettext",
                        "printf",
                        "fputs_unlocked",
                        "emit_ancillary_info",
                        "fprintf",
                        "exit"
                    ],
                    "calling_functions": [
                        "usage",
                        "main"
                    ],
                    "defined_in_file": "users_decompiled.c"
                }
            },
            {
                "func_name": "main",
                "func_c_signature": "undefined8 main(int param_1,undefined8 *param_2)",
                "decompiled_code": "undefined8 main(int param_1,undefined8 *param_2) {\n  undefined8 uVar1;\n  undefined8 uVar2;\n  \n  set_program_name(*param_2);\n  setlocale(6,\"\");\n  bindtextdomain(\"coreutils\",\"/usr/local/share/locale\");\n  textdomain(\"coreutils\");\n  atexit((__func *)&close_stdout);\n  uVar1 = proper_name_lite(\"David MacKenzie\",\"David MacKenzie\");\n  uVar2 = proper_name_lite(\"Joseph Arceneaux\",\"Joseph Arceneaux\");\n  parse_gnu_standard_options_only\n            (param_1,param_2,\"users\",\"GNU coreutils\",_Version,1,usage,uVar2,uVar1,0);\n  if (param_1 == _optind) {\n    users(\"/var/run/utmp\",1);\n  }\n  else if (param_1 - _optind == 1) {\n    users(param_2[_optind],0);\n  }\n  else {\n    uVar1 = quote(param_2[(long)_optind + 1]);\n    uVar2 = gettext(\"extra operand %s\");\n    error(0,0,uVar2,uVar1);\n    usage(1);\n  }\n  return 0;\n}",
                "globals": [],
                "externs": [],
                "types": [],
                "includes": [],
                "dependencies": {
                    "called_functions": [
                        "main",
                        "set_program_name",
                        "setlocale",
                        "bindtextdomain",
                        "textdomain",
                        "atexit",
                        "proper_name_lite",
                        "parse_gnu_standard_options_only",
                        "users",
                        "quote",
                        "gettext",
                        "error",
                        "usage"
                    ],
                    "calling_functions": [
                        "main"
                    ],
                    "defined_in_file": "users_decompiled.c"
                }
            }
        ]
    }
}